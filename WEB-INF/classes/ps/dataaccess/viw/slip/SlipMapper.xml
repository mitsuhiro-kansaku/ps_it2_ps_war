<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="ps.dataaccess.viw.slip.SlipMapper">

    <sql id="extItem">
                    V_SLIP_REQ.ORD_EXT_TXT_1,
                    V_SLIP_REQ.ORD_EXT_TXT_2,
                    V_SLIP_REQ.ORD_EXT_TXT_3,
                    V_SLIP_REQ.ORD_EXT_TXT_4,
                    V_SLIP_REQ.ORD_EXT_TXT_5,
                    V_SLIP_REQ.ORD_EXT_TXT_6,
                    V_SLIP_REQ.ORD_EXT_TXT_7,
                    V_SLIP_REQ.ORD_EXT_TXT_8,
                    V_SLIP_REQ.ORD_EXT_TXT_9,
                    V_SLIP_REQ.ORD_EXT_TXT_10,
                    V_SLIP_REQ.ORD_EXT_AREA_1,
                    V_SLIP_REQ.ORD_EXT_AREA_2,
                    V_SLIP_REQ.ORD_EXT_AREA_3,
                    V_SLIP_REQ.ORD_EXT_AREA_4,
                    V_SLIP_REQ.ORD_EXT_AREA_5,
                    V_SLIP_REQ.ORD_EXT_DATE_1,
                    V_SLIP_REQ.ORD_EXT_DATE_2,
                    V_SLIP_REQ.ORD_EXT_DATE_3,
                    V_SLIP_REQ.ORD_EXT_DATE_4,
                    V_SLIP_REQ.ORD_EXT_DATE_5,
                    V_SLIP_REQ.ORD_EXT_INT_1,
                    V_SLIP_REQ.ORD_EXT_INT_2,
                    V_SLIP_REQ.ORD_EXT_INT_3,
                    V_SLIP_REQ.ORD_EXT_INT_4,
                    V_SLIP_REQ.ORD_EXT_INT_5,
                    V_SLIP_REQ.ORD_EXT_INT_6,
                    V_SLIP_REQ.ORD_EXT_INT_7,
                    V_SLIP_REQ.ORD_EXT_INT_8,
                    V_SLIP_REQ.ORD_EXT_INT_9,
                    V_SLIP_REQ.ORD_EXT_INT_10,
                    V_SLIP_REQ.ORD_EXT_DEC_1,
                    V_SLIP_REQ.ORD_EXT_DEC_2,
                    V_SLIP_REQ.ORD_EXT_DEC_3,
                    V_SLIP_REQ.ORD_EXT_DEC_4,
                    V_SLIP_REQ.ORD_EXT_DEC_5,
                    V_SLIP_REQ.ORD_EXT_SEL_1,
                    V_SLIP_REQ.ORD_EXT_SEL_2,
                    V_SLIP_REQ.ORD_EXT_SEL_3,
                    V_SLIP_REQ.ORD_EXT_SEL_4,
                    V_SLIP_REQ.ORD_EXT_SEL_5,
                    V_SLIP_REQ.ORD_EXT_SEL_6,
                    V_SLIP_REQ.ORD_EXT_SEL_7,
                    V_SLIP_REQ.ORD_EXT_SEL_8,
                    V_SLIP_REQ.ORD_EXT_SEL_9,
                    V_SLIP_REQ.ORD_EXT_SEL_10,
                    V_SLIP_REQ.ORD_EXT_CHK_1,
                    V_SLIP_REQ.ORD_EXT_CHK_2,
                    V_SLIP_REQ.ORD_EXT_CHK_3,
                    V_SLIP_REQ.ORD_EXT_CHK_4,
                    V_SLIP_REQ.ORD_EXT_CHK_5,
                    V_SLIP_REQ.ORD_EXT_FILE_1,
                    V_SLIP_REQ.ORD_EXT_FILE_2,
                    V_SLIP_REQ.ORD_EXT_FILE_3,
                    V_SLIP_REQ.ORD_EXT_MST_1,
                    V_SLIP_REQ.ORD_EXT_MST_2,
                    V_SLIP_REQ.ORD_EXT_MST_3,
                    V_SLIP_REQ.ORD_EXT_MST_4,
                    V_SLIP_REQ.ORD_EXT_MST_5,
                    V_SLIP_REQ.ORD_EXT_MST_6,
                    V_SLIP_REQ.ORD_EXT_MST_7,
                    V_SLIP_REQ.ORD_EXT_MST_8,
                    V_SLIP_REQ.ORD_EXT_MST_NAME_1,
                    V_SLIP_REQ.ORD_EXT_MST_NAME_2,
                    V_SLIP_REQ.ORD_EXT_MST_NAME_3,
                    V_SLIP_REQ.ORD_EXT_MST_NAME_4,
                    V_SLIP_REQ.ORD_EXT_MST_NAME_5,
                    V_SLIP_REQ.ORD_EXT_MST_NAME_6,
                    V_SLIP_REQ.ORD_EXT_MST_NAME_7,
                    V_SLIP_REQ.ORD_EXT_MST_NAME_8,
                    V_SLIP_REQ.APL_EXT_TXT_1,
                    V_SLIP_REQ.APL_EXT_TXT_2,
                    V_SLIP_REQ.APL_EXT_TXT_3,
                    V_SLIP_REQ.APL_EXT_TXT_4,
                    V_SLIP_REQ.APL_EXT_TXT_5,
                    V_SLIP_REQ.APL_EXT_TXT_6,
                    V_SLIP_REQ.APL_EXT_TXT_7,
                    V_SLIP_REQ.APL_EXT_TXT_8,
                    V_SLIP_REQ.APL_EXT_TXT_9,
                    V_SLIP_REQ.APL_EXT_TXT_10,
                    V_SLIP_REQ.APL_EXT_AREA_1,
                    V_SLIP_REQ.APL_EXT_AREA_2,
                    V_SLIP_REQ.APL_EXT_AREA_3,
                    V_SLIP_REQ.APL_EXT_AREA_4,
                    V_SLIP_REQ.APL_EXT_AREA_5,
                    V_SLIP_REQ.APL_EXT_DATE_1,
                    V_SLIP_REQ.APL_EXT_DATE_2,
                    V_SLIP_REQ.APL_EXT_DATE_3,
                    V_SLIP_REQ.APL_EXT_DATE_4,
                    V_SLIP_REQ.APL_EXT_DATE_5,
                    V_SLIP_REQ.APL_EXT_INT_1,
                    V_SLIP_REQ.APL_EXT_INT_2,
                    V_SLIP_REQ.APL_EXT_INT_3,
                    V_SLIP_REQ.APL_EXT_INT_4,
                    V_SLIP_REQ.APL_EXT_INT_5,
                    V_SLIP_REQ.APL_EXT_INT_6,
                    V_SLIP_REQ.APL_EXT_INT_7,
                    V_SLIP_REQ.APL_EXT_INT_8,
                    V_SLIP_REQ.APL_EXT_INT_9,
                    V_SLIP_REQ.APL_EXT_INT_10,
                    V_SLIP_REQ.APL_EXT_DEC_1,
                    V_SLIP_REQ.APL_EXT_DEC_2,
                    V_SLIP_REQ.APL_EXT_DEC_3,
                    V_SLIP_REQ.APL_EXT_DEC_4,
                    V_SLIP_REQ.APL_EXT_DEC_5,
                    V_SLIP_REQ.APL_EXT_SEL_1,
                    V_SLIP_REQ.APL_EXT_SEL_2,
                    V_SLIP_REQ.APL_EXT_SEL_3,
                    V_SLIP_REQ.APL_EXT_SEL_4,
                    V_SLIP_REQ.APL_EXT_SEL_5,
                    V_SLIP_REQ.APL_EXT_SEL_6,
                    V_SLIP_REQ.APL_EXT_SEL_7,
                    V_SLIP_REQ.APL_EXT_SEL_8,
                    V_SLIP_REQ.APL_EXT_SEL_9,
                    V_SLIP_REQ.APL_EXT_SEL_10,
                    V_SLIP_REQ.APL_EXT_CHK_1,
                    V_SLIP_REQ.APL_EXT_CHK_2,
                    V_SLIP_REQ.APL_EXT_CHK_3,
                    V_SLIP_REQ.APL_EXT_CHK_4,
                    V_SLIP_REQ.APL_EXT_CHK_5,
                    V_SLIP_REQ.APL_EXT_FILE_1,
                    V_SLIP_REQ.APL_EXT_FILE_2,
                    V_SLIP_REQ.APL_EXT_FILE_3,
                    V_SLIP_REQ.APL_EXT_MST_1,
                    V_SLIP_REQ.APL_EXT_MST_2,
                    V_SLIP_REQ.APL_EXT_MST_3,
                    V_SLIP_REQ.APL_EXT_MST_4,
                    V_SLIP_REQ.APL_EXT_MST_5,
                    V_SLIP_REQ.APL_EXT_MST_6,
                    V_SLIP_REQ.APL_EXT_MST_7,
                    V_SLIP_REQ.APL_EXT_MST_8,
                    V_SLIP_REQ.APL_EXT_MST_NAME_1,
                    V_SLIP_REQ.APL_EXT_MST_NAME_2,
                    V_SLIP_REQ.APL_EXT_MST_NAME_3,
                    V_SLIP_REQ.APL_EXT_MST_NAME_4,
                    V_SLIP_REQ.APL_EXT_MST_NAME_5,
                    V_SLIP_REQ.APL_EXT_MST_NAME_6,
                    V_SLIP_REQ.APL_EXT_MST_NAME_7,
                    V_SLIP_REQ.APL_EXT_MST_NAME_8,
                    V_SLIP_REQ.REQ_EXT_TXT_1,
                    V_SLIP_REQ.REQ_EXT_TXT_2,
                    V_SLIP_REQ.REQ_EXT_TXT_3,
                    V_SLIP_REQ.REQ_EXT_TXT_4,
                    V_SLIP_REQ.REQ_EXT_TXT_5,
                    V_SLIP_REQ.REQ_EXT_TXT_6,
                    V_SLIP_REQ.REQ_EXT_TXT_7,
                    V_SLIP_REQ.REQ_EXT_TXT_8,
                    V_SLIP_REQ.REQ_EXT_TXT_9,
                    V_SLIP_REQ.REQ_EXT_TXT_10,
                    V_SLIP_REQ.REQ_EXT_AREA_1,
                    V_SLIP_REQ.REQ_EXT_AREA_2,
                    V_SLIP_REQ.REQ_EXT_AREA_3,
                    V_SLIP_REQ.REQ_EXT_AREA_4,
                    V_SLIP_REQ.REQ_EXT_AREA_5,
                    V_SLIP_REQ.REQ_EXT_DATE_1,
                    V_SLIP_REQ.REQ_EXT_DATE_2,
                    V_SLIP_REQ.REQ_EXT_DATE_3,
                    V_SLIP_REQ.REQ_EXT_DATE_4,
                    V_SLIP_REQ.REQ_EXT_DATE_5,
                    V_SLIP_REQ.REQ_EXT_INT_1,
                    V_SLIP_REQ.REQ_EXT_INT_2,
                    V_SLIP_REQ.REQ_EXT_INT_3,
                    V_SLIP_REQ.REQ_EXT_INT_4,
                    V_SLIP_REQ.REQ_EXT_INT_5,
                    V_SLIP_REQ.REQ_EXT_INT_6,
                    V_SLIP_REQ.REQ_EXT_INT_7,
                    V_SLIP_REQ.REQ_EXT_INT_8,
                    V_SLIP_REQ.REQ_EXT_INT_9,
                    V_SLIP_REQ.REQ_EXT_INT_10,
                    V_SLIP_REQ.REQ_EXT_DEC_1,
                    V_SLIP_REQ.REQ_EXT_DEC_2,
                    V_SLIP_REQ.REQ_EXT_DEC_3,
                    V_SLIP_REQ.REQ_EXT_DEC_4,
                    V_SLIP_REQ.REQ_EXT_DEC_5,
                    V_SLIP_REQ.REQ_EXT_SEL_1,
                    V_SLIP_REQ.REQ_EXT_SEL_2,
                    V_SLIP_REQ.REQ_EXT_SEL_3,
                    V_SLIP_REQ.REQ_EXT_SEL_4,
                    V_SLIP_REQ.REQ_EXT_SEL_5,
                    V_SLIP_REQ.REQ_EXT_SEL_6,
                    V_SLIP_REQ.REQ_EXT_SEL_7,
                    V_SLIP_REQ.REQ_EXT_SEL_8,
                    V_SLIP_REQ.REQ_EXT_SEL_9,
                    V_SLIP_REQ.REQ_EXT_SEL_10,
                    V_SLIP_REQ.REQ_EXT_CHK_1,
                    V_SLIP_REQ.REQ_EXT_CHK_2,
                    V_SLIP_REQ.REQ_EXT_CHK_3,
                    V_SLIP_REQ.REQ_EXT_CHK_4,
                    V_SLIP_REQ.REQ_EXT_CHK_5,
                    V_SLIP_REQ.REQ_EXT_FILE_1,
                    V_SLIP_REQ.REQ_EXT_FILE_2,
                    V_SLIP_REQ.REQ_EXT_FILE_3,
                    V_SLIP_REQ.REQ_EXT_MST_1,
                    V_SLIP_REQ.REQ_EXT_MST_2,
                    V_SLIP_REQ.REQ_EXT_MST_3,
                    V_SLIP_REQ.REQ_EXT_MST_4,
                    V_SLIP_REQ.REQ_EXT_MST_5,
                    V_SLIP_REQ.REQ_EXT_MST_6,
                    V_SLIP_REQ.REQ_EXT_MST_7,
                    V_SLIP_REQ.REQ_EXT_MST_8,
                    V_SLIP_REQ.REQ_EXT_MST_NAME_1,
                    V_SLIP_REQ.REQ_EXT_MST_NAME_2,
                    V_SLIP_REQ.REQ_EXT_MST_NAME_3,
                    V_SLIP_REQ.REQ_EXT_MST_NAME_4,
                    V_SLIP_REQ.REQ_EXT_MST_NAME_5,
                    V_SLIP_REQ.REQ_EXT_MST_NAME_6,
                    V_SLIP_REQ.REQ_EXT_MST_NAME_7,
                    V_SLIP_REQ.REQ_EXT_MST_NAME_8
    </sql>

       <sql id="listKeyIdentityWhereCondition">
            AND  V_SLIP_REQ.REQ_COMPANY_CD = '${@fw.security.SecurityUtil@getCompanyCdByEscapeSql()}'
            AND (V_SLIP_REQ.SLIP_STATUS NOT IN
                   ('0504', '0505', '0101', '0102', '0103', '0104', '0105', '0106',
                    '0107', '0211', '0212', '0213', '0301', '0302', '0303', '0304',
                    '0305', '0306', '0307', '0411', '0412', '0413', '0421', '0422') OR
                   (V_SLIP_REQ.QUOT_ACQ_REQ_EXIST_FLG = '0' AND
                   V_SLIP_REQ.SLIP_STATUS IN ('0301', '0302', '0303', '0304', '0305', '0306',
                    '0307', '0411', '0412', '0413', '0421', '0422')))
            <!-- 購入依頼部門コード -->
            <if test="!@org.apache.commons.lang.StringUtils@isNotBlank(slipSearchReqAllGrantFlg)">
            AND V_SLIP_REQ.REQ_SECTION_CD IN (
                                                <if test="@org.apache.commons.lang.StringUtils@isNotBlank(@fw.common.util.AppUtil@getSectionViewRegion())">
                                                    ${@fw.common.util.AppUtil@getSectionViewRegion()}
                                                </if>
                                                <if test="!@org.apache.commons.lang.StringUtils@isNotBlank(@fw.common.util.AppUtil@getSectionViewRegion())">
                                                    '${@fw.common.util.AppUtil@getSectionViewRegion()}'
                                                </if>)
            </if>
            <if test="@org.apache.commons.lang.StringUtils@isNotBlank(slipSearchReqAllGrantFlg)">
                <if test="@org.apache.commons.lang.StringUtils@isNotBlank(reqSectionCd)">
                AND V_SLIP_REQ.REQ_SECTION_CD = #{reqSectionCd}
                </if>
            </if>
                 <!-- 購入申請番号 -->
                 <if test="@org.apache.commons.lang.StringUtils@isNotBlank(purAplNo)">
                  AND V_SLIP_REQ.PUR_APL_NO ${@fw.common.util.SearchModeUtil@getSearchSQL("fw.domain.slip.businesscommon.slipsearch.SlipSearchCondition","purAplNo")}
                 </if>
                 <!-- 購入依頼番号 -->
                 <if test="@org.apache.commons.lang.StringUtils@isNotBlank(purReqNo)">
                  AND V_SLIP_REQ.PUR_REQ_NO ${@fw.common.util.SearchModeUtil@getSearchSQL("fw.domain.slip.businesscommon.slipsearch.SlipSearchCondition","purReqNo")}
                 </if>
                 <!-- 件名 -->
                 <if test="@org.apache.commons.lang.StringUtils@isNotBlank(titleName)">
                  AND V_SLIP_REQ.TITLE_NAME ${@fw.common.util.SearchModeUtil@getSearchSQL("fw.domain.slip.businesscommon.slipsearch.SlipSearchCondition","titleName")}
                 </if>
                 <!-- 品種大分類コード -->
                 <if test="@org.apache.commons.lang.StringUtils@isNotBlank(itemClassL)">
                  AND V_SLIP_REQ.ITEM_CLASS_L = #{itemClassL}
                 </if>
                 <!-- 品種中分類コード -->
                 <if test="@org.apache.commons.lang.StringUtils@isNotBlank(itemClassM)">
                  AND V_SLIP_REQ.ITEM_CLASS_M = #{itemClassM}
                 </if>
                 <!-- 品種小分類コード -->
                  <if test="@org.apache.commons.lang.StringUtils@isNotBlank(itemClassS)">
                  AND V_SLIP_REQ.ITEM_CLASS_S = #{itemClassS}
                  </if>
                 <!-- 品名分類大分類コード -->
                 <if test="@org.apache.commons.lang.StringUtils@isNotBlank(itemProductClassL)">
                  AND V_SLIP_REQ.ITEM_CLASS_L = #{itemProductClassL}
                 </if>
                 <!-- 品名分類中分類コード -->
                 <if test="@org.apache.commons.lang.StringUtils@isNotBlank(itemProductClassM)">
                  AND V_SLIP_REQ.ITEM_CLASS_M = #{itemProductClassM}
                 </if>
                 <!-- 品名分類小分類コード -->
                  <if test="@org.apache.commons.lang.StringUtils@isNotBlank(itemProductClassS)">
                  AND V_SLIP_REQ.ITEM_CLASS_S = #{itemProductClassS}
                  </if>
                  <!-- 品名コード -->
                  <if test="@org.apache.commons.lang.StringUtils@isNotBlank(itemCd)">
                  AND V_SLIP_REQ.ITEM_CD = #{itemCd}
                  </if>
                   <!-- 品名 -->
                  <if test="@org.apache.commons.lang.StringUtils@isNotBlank(itemName)">
                  AND V_SLIP_REQ.ITEM_NAME ${@fw.common.util.SearchModeUtil@getSearchSQL("fw.domain.slip.businesscommon.slipsearch.SlipSearchCondition","itemName")}
                  </if>
                 <!-- 取引先コード -->
                  <if test="@org.apache.commons.lang.StringUtils@isNotBlank(supplierCd)">
                  AND V_SLIP_REQ.SUP_CD = #{supplierCd}
                  </if>
                  <!-- 依頼元担当者ID -->
                  <if test="@org.apache.commons.lang.StringUtils@isNotBlank(purReqUserId)">
                  AND V_SLIP_REQ.REQ_USER_ID = #{purReqUserId}
                  </if>
                  <!-- 起票担当者ID -->
                  <if test="@org.apache.commons.lang.StringUtils@isNotBlank(issueVousherId)">
                  AND V_SLIP_REQ.INPUT_USER_ID = #{issueVousherId}
                  </if>
                  <!-- 納入先コード -->
                  <if test="@org.apache.commons.lang.StringUtils@isNotBlank(delivPlaceCd)">
                  AND V_SLIP_REQ.DELIV_PLACE_CD  = #{delivPlaceCd}
                  </if>
                  <!-- 購入依頼日 -->
                  <if test="@org.apache.commons.lang.StringUtils@isNotBlank(reqDateFrom.dateOfymd)">
                  AND V_SLIP_REQ.PUR_REQ_DATE  >= #{reqDateFrom.dateOfymd}
                  </if>
                  <!-- 購入依頼日 -->
                  <if test="@org.apache.commons.lang.StringUtils@isNotBlank(reqDateTo.dateOfymd)">
                  AND V_SLIP_REQ.PUR_REQ_DATE  &lt;= #{reqDateTo.dateOfymd}
                  </if>
                  <!-- 希望納期 -->
                  <if test="@org.apache.commons.lang.StringUtils@isNotBlank(delivDateFrom.dateOfymd)">
                  AND V_SLIP_REQ.REQ_DELIV_DATE  >= #{delivDateFrom.dateOfymd}
                  </if>
                  <!-- 希望納期 -->
                  <if test="@org.apache.commons.lang.StringUtils@isNotBlank(delivDateTo.dateOfymd)">
                  AND V_SLIP_REQ.REQ_DELIV_DATE  &lt;= #{delivDateTo.dateOfymd}
                  </if>
                  <!-- 負担部門コード -->
                  <if test="@org.apache.commons.lang.StringUtils@isNotBlank(loadSectionCd)">
                  AND V_SLIP_REQ.LOAD_SECTION_CD = #{loadSectionCd}
                  </if>
                  <!-- 予算番号 -->
                  <if test="@org.apache.commons.lang.StringUtils@isNotBlank(budgetNo)">
                  AND V_SLIP_REQ.BUDGET_NO ${@fw.common.util.SearchModeUtil@getSearchSQL("fw.domain.slip.businesscommon.slipsearch.SlipSearchCondition","budgetNo")}
                  </if>
                  <!-- 型式 -->
                  <if test="@org.apache.commons.lang.StringUtils@isNotBlank(katashiki)">
                  AND V_SLIP_REQ.KATASHIKI ${@fw.common.util.SearchModeUtil@getSearchSQL("fw.domain.slip.businesscommon.slipsearch.SlipSearchCondition","katashiki")}
                  </if>
                  <!-- 科目コード -->
                  <if test="@org.apache.commons.lang.StringUtils@isNotBlank(subjectCd)">
                  AND V_SLIP_REQ.SUBJECT_CD = #{subjectCd}
                  </if>
                  <!-- 依頼区分 -->
                  <if test="!@org.apache.commons.lang.StringUtils@equals('',reqInd)">
                  AND V_SLIP_REQ.REQ_TYPE_IND  = #{reqInd}
                  </if>
                  <!-- 注文状況が「未発注（注文打切は含まない）」の場合 -->
                  <if test="@org.apache.commons.lang.StringUtils@equals('1',orderSituation)">
                  AND ((V_SLIP_REQ.ORDER_STATUS != '05' AND V_SLIP_REQ.ORDER_STATUS != '20') OR V_SLIP_REQ.ORDER_STATUS IS NULL)
                  </if>
                  <!-- 注文状況が「注文済（注文打切も含む）」の場合 -->
                  <if test="@org.apache.commons.lang.StringUtils@equals('2',orderSituation)">
                  AND (V_SLIP_REQ.ORDER_STATUS = '05' OR V_SLIP_REQ.ORDER_STATUS = '20')
                  </if>
                  <!-- 受入状況のいづれかが選択されていた場合 若しくは、検収状況のいづれかが選択していた場合 -->
                  <if test="!receiveStates.empty or !acceptanceStates.empty">
                  AND V_SLIP_REQ.ORDER_STATUS != '10'
                  </if>
                  <if test="!receiveStates.empty">
                  AND V_SLIP_REQ.RECEIVE_STATUS_IND IN
                    <foreach collection="receiveStates.list" item="receiveStatus" open="(" separator="," close=")">
                      #{receiveStatus, jdbcType=VARCHAR}
                    </foreach>
                  </if>
                  <if test="!acceptanceStates.empty">
                  AND V_SLIP_REQ.ACCEPTANCE_STATUS_IND IN
                    <foreach collection="acceptanceStates.list" item="acceptanceStatus" open="(" separator="," close=")">
                      #{acceptanceStatus, jdbcType=VARCHAR}
                    </foreach>
                  </if>
       </sql>

   <select id="download" parameterType="fw.domain.slip.businesscommon.slipsearch.SlipSearchCondition" resultMap="SlipSearchItem_Map">
   <include refid="pageHeader"/>
      SELECT
              V_SLIP_REQ.SLIP_NO AS slipNo,
              V_SLIP_REQ.PUR_REQ_NO AS purReqNo,
              V_SLIP_REQ.REQ_TYPE_IND AS reqInd,
              V_SLIP_REQ.PUR_REQ_DATE AS "purReqDate.dateOfymd",
              V_SLIP_REQ.ORDER_NO AS orderNo,
              V_SLIP_REQ.ORDER_DATE AS "orderDate.dateOfymd",
              T_QUOT_REQUEST.QUOT_REQ_NO AS "quotReqNo",
              V_SLIP_REQ.PUR_APL_NO AS purAplNo,
              V_SLIP_REQ.TITLE_NAME AS titleName,
              V_SLIP_REQ.SUP_CD AS supCd,
              V_SLIP_REQ.SUP_ABBR_NAME AS supName,
              V_SLIP_REQ.SUBCON_IND AS subconInd,
              V_SLIP_REQ.EDI_IND AS ediInd,
              V_SLIP_REQ.ITEM_CD AS itemCd,
              V_SLIP_REQ.ITEM_NAME AS itemName,
              V_SLIP_REQ.KATASHIKI AS katashiki,
              V_SLIP_REQ.MANUFACT_CD AS manufactCd,
              V_SLIP_REQ.MANUFACT_NAME AS manufactName,
              V_SLIP_REQ.REQ_DELIV_DATE AS "reqDelivDate.dateOfymd",
              V_SLIP_REQ.ORDER_DELIV_DATE AS "orderDelivDate.dateOfymd",
              V_SLIP_REQ.UNIT_NAME AS unitName,
              V_SLIP_REQ.REQ_VOL AS "hopeVol.vol",
              V_SLIP_REQ.ORDER_VOL AS "orderVol.vol",
              CASE WHEN (V_SLIP_REQ.ORDER_VOL - nvl(V_SLIP_REQ.RECEIVED_VOL,0)) &lt; 0 THEN 0 ELSE (V_SLIP_REQ.ORDER_VOL - nvl(V_SLIP_REQ.RECEIVED_VOL,0)) END AS "receiveRemainingVol.vol",
              V_SLIP_REQ.UNIT_PRICE_IND AS unitPriceInd,
              V_SLIP_REQ.HOPE_CURRENCY_CD AS hopeCurrencyCd,
              V_SLIP_REQ.CURRENCY_CD AS currencyCd,
              V_SLIP_REQ.REQ_UNIT_PRICE AS "hopeUnitPrice.amount",
              V_SLIP_REQ.REQ_AMOUNT AS "hopeAmount.amount",
              V_SLIP_REQ.ORDER_UNIT_PRICE AS "orderUnitPrice.amount",
              V_SLIP_REQ.ORDER_AMOUNT AS "orderAmount.amount",
              V_SLIP_REQ.ORDER_CANCEL_VOL,
              V_SLIP_REQ.ORDER_CANCEL_AMOUNT,
              V_SLIP_REQ.TAX_IND AS taxInd,
              V_SLIP_REQ.BUDGET_NO AS budgetNo,
              V_SLIP_REQ.SUBJECT_CD AS subjectCd,
              V_SLIP_REQ.SUBJECT_NAME AS subjectName,
              V_SLIP_REQ.DELIV_PLACE_CD AS delivPlaceCd,
              V_SLIP_REQ.DELIV_PLACE_NAME AS delivPlaceName,
              V_SLIP_REQ.ITEM_CLASS_L_NAME AS itemClassLName,
              V_SLIP_REQ.ITEM_CLASS_M_NAME AS itemClassMName,
              V_SLIP_REQ.ITEM_CLASS_S_NAME AS itemClassSName,
              V_SLIP_REQ.REQ_SECTION_CD AS reqSectionCd,
              V_SLIP_REQ.REQ_SECTION_NAME AS reqSectionName,
              V_SLIP_REQ.REQ_USER_ID AS reqUserId,
              V_SLIP_REQ.REQ_USER_NAME AS reqUserName,
              V_SLIP_REQ.BUYER_SECTION_NAME AS buyerSectionName,
              V_SLIP_REQ.BUYER_SECTION_CD AS buyerSectionCd,
              V_SLIP_REQ.BUYER_USER_NAME AS buyerUserName,
              V_SLIP_REQ.BUYER_USER_ID AS buyerUserId,
              V_SLIP_REQ.LOAD_SECTION_CD AS loadSectionCd,
              V_SLIP_REQ.LOAD_SECTION_NAME AS loadSectionName,
              V_SLIP_REQ.SLIP_STATUS AS slipStatus,
              V_SLIP_REQ.RECEIVE_STATUS_IND AS receiveStatusInd,
              V_SLIP_REQ.INSPECT_STATUS_IND AS inspectStatusInd,
              V_SLIP_REQ.ACCEPTANCE_STATUS_IND AS acceptanceStatusInd,
              TEST2.DELIV_VOL AS "delivVol.vol",
              T_QUOT_ACQ_APL.QUOT_ACQ_APL_STATUS AS quotAcqAplStat,
              T_QUOT_REQUEST.QUOT_REQ_SEQ AS quotReqSeqNo,
              V_SLIP_REQ.ORDER_SEQ AS orderSeq,
              TEST1.KENSHU AS kenshu,<!-- DAIKO_KANEKO TEST1:T_DLV_EST_MNG:納期管理の数は何に使うのか不明/削除した方がよい -->
              V_SLIP_REQ.PUR_REQ_SEQ AS purReqSeq,
              V_SLIP_REQ.PUR_APL_SEQ AS purAplSeqNo,
              V_SLIP_REQ.APP_UNIT_NO AS appUnitNo,
              V_SLIP_REQ.REQ_TYPE_IND AS reqTypeIndName,
                V_SLIP_REQ.SUBCON_IND AS subconIndName,
                V_SLIP_REQ.EDI_IND AS ediIndName,
                V_SLIP_REQ.UNIT_CD AS unitCd,
                V_SLIP_REQ.TAX_IND AS taxIndName,
                V_SLIP_REQ.ITEM_CLASS_L AS itemClassL,
                V_SLIP_REQ.ITEM_CLASS_M AS itemClassM,
                V_SLIP_REQ.ITEM_CLASS_S AS itemClassS,
                V_SLIP_REQ.REQ_COMPANY_CD AS reqCompanyCd,
                V_SLIP_REQ.REQ_COMPANY_NAME AS reqCompanyName,
                V_SLIP_REQ.REQ_SECTION_PLACE_CD AS reqSectionPlaceCd,
                V_SLIP_REQ.REQ_SECTION_PLACE_NAME AS reqSectionPlaceName,
                V_SLIP_REQ.INPUT_COMPANY_CD AS inputCompanyCd,
                V_SLIP_REQ.INPUT_COMPANY_NAME AS inputCompanyName,
                V_SLIP_REQ.INPUT_SECTION_PLACE_CD AS inputSectionPlaceCd,
                V_SLIP_REQ.INPUT_SECTION_PLACE_NAME AS inputSectionPlaceName,
                V_SLIP_REQ.INPUT_SECTION_CD AS inputSectionCd,
                V_SLIP_REQ.INPUT_SECTION_NAME AS inputSectionName,
                V_SLIP_REQ.INPUT_USER_ID AS inputUserId,
                V_SLIP_REQ.INPUT_USER_NAME AS inputUserName,
                V_SLIP_REQ.BUYER_COMPANY_CD AS buyerCompanyCd,
                V_SLIP_REQ.BUYER_COMPANY_NAME AS buyerCompanyName,
                V_SLIP_REQ.BUYER_SECTION_PLACE_CD AS buyerSectionPlaceCd,
                V_SLIP_REQ.BUYER_SECTION_PLACE_NAME AS buyerSectionPlaceName,
                APPROVED_T_ARRIVAL.APPROVED_DELIV_VOL AS "approvedDelivVol.vol"
                , V_SLIP_REQ.ACCEPT_VOL AS "acceptVol.vol"
                , V_SLIP_REQ.ACCEPT_AMOUNT AS "acceptAmount.amount"
                , V_SLIP_REQ.RECEIVED_VOL AS "receivedVol.vol"
                , <include refid="extItem"/>
           FROM V_SLIP_REQ
           <!-- 多明細伝票で自動見積された際の見積と紐づけるために伝票番号と見積依頼番号を紐づける -->
	       LEFT JOIN 
	           (
	               SELECT      QUOT_REQ_NO
	               ,           QUOT_REQ_SEQ
	               FROM        T_QUOT_REQUEST
	               WHERE       QUOT_TYPE_IND IN ('1', '4')
	               AND         NEW_APP_FLG = '1'
	               AND         DELETE_FLG = '0'
	           ) T_QUOT_REQUEST
	           ON (V_SLIP_REQ.PUR_APL_NO = T_QUOT_REQUEST.QUOT_REQ_NO
	               OR  V_SLIP_REQ.SLIP_NO = T_QUOT_REQUEST.QUOT_REQ_NO)
	       LEFT JOIN
	           (
	               SELECT      QUOT_ACQ_APL_NO
	               ,           QUOT_ACQ_APL_STATUS
	               FROM        T_QUOT_ACQ_APL
	               WHERE       NEW_FLG = '1'
	               AND         DELETE_FLG ='0'
	           ) T_QUOT_ACQ_APL
	           ON T_QUOT_ACQ_APL.QUOT_ACQ_APL_NO = V_SLIP_REQ.PUR_APL_NO
           <!-- DAIKO_KANEKO TEST1:T_DLV_EST_MNG:納期管理の数は何に使うのか不明/削除した方がよい -->
           LEFT JOIN
                (SELECT T_DLV_EST_MNG.ORDER_NO,
                 COUNT(T_DLV_EST_MNG.DELIV_MNG_SEQ) KENSHU
                 FROM T_DLV_EST_MNG
                WHERE
                T_DLV_EST_MNG.INQ_RESP_IND = '2'
                AND T_DLV_EST_MNG.DELETE_FLG = '0'
                GROUP BY T_DLV_EST_MNG.ORDER_NO
                ) TEST1
                ON TEST1.ORDER_NO = V_SLIP_REQ.ORDER_NO
           LEFT JOIN
                 (SELECT T_RECEIVE_MNG.ORDER_NO, SUM(T_RECEIVE_MNG.DELIV_VOL) DELIV_VOL  FROM T_RECEIVE_MNG
                  INNER JOIN T_ARRIVAL
                  ON T_RECEIVE_MNG.APP_ARRIVAL_SEQ = T_ARRIVAL.ARRIVAL_SEQ
                 WHERE T_RECEIVE_MNG.DELETE_FLG = '0'
                  AND T_ARRIVAL.DELETE_FLG = '0'
                  AND T_ARRIVAL.ARRIVAL_STATUS = '04'
                 GROUP BY T_RECEIVE_MNG.ORDER_NO) TEST2
                ON TEST2.ORDER_NO = V_SLIP_REQ.ORDER_NO
           LEFT JOIN
                (SELECT T_ARRIVAL.ORDER_NO, SUM(T_ARRIVAL.DELIV_VOL) APPROVED_DELIV_VOL
                 FROM T_ARRIVAL
                 INNER JOIN T_RECEIVE_MNG
                  ON T_ARRIVAL.ARRIVAL_SEQ = T_RECEIVE_MNG.APP_ARRIVAL_SEQ
                 WHERE T_ARRIVAL.DELETE_FLG = '0'
                  AND T_ARRIVAL.RB_IND = '0'
                  AND T_RECEIVE_MNG.DELETE_FLG = '0'
                 GROUP BY T_ARRIVAL.ORDER_NO) APPROVED_T_ARRIVAL
                ON APPROVED_T_ARRIVAL.ORDER_NO = V_SLIP_REQ.ORDER_NO
        <where>
            <include refid="listKeyIdentityWhereCondition"/>
        </where>
         ORDER BY ${searchCondition.columnOrder.columnOrder()}
        <include refid="pageRoot"/>
       </select>
      <select id="downloadCount" parameterType="fw.domain.slip.businesscommon.slipsearch.SlipSearchCondition"
   resultType="java.lang.Long">
      SELECT COUNT(*)
           FROM V_SLIP_REQ
           LEFT JOIN T_QUOT_REQUEST ON
                V_SLIP_REQ.PUR_REQ_NO = T_QUOT_REQUEST.QUOT_REQ_NO
                AND T_QUOT_REQUEST.QUOT_TYPE_IND IN ('1', '4')
                AND T_QUOT_REQUEST.NEW_APP_FLG = '1'
                AND T_QUOT_REQUEST.DELETE_FLG = '0'
           LEFT JOIN T_QUOT_ACQ_APL
                ON T_QUOT_ACQ_APL.QUOT_ACQ_APL_NO = V_SLIP_REQ.PUR_APL_NO
                AND T_QUOT_ACQ_APL.NEW_FLG = '1'
                AND T_QUOT_ACQ_APL.DELETE_FLG ='0'
           <!-- DAIKO_KANEKO TEST1:T_DLV_EST_MNG:納期管理との結合の意味は不明/削除した方がよい -->
           LEFT JOIN
                (SELECT T_DLV_EST_MNG.ORDER_NO,
                 COUNT(T_DLV_EST_MNG.DELIV_MNG_SEQ) KENSHU
                 FROM T_DLV_EST_MNG
                WHERE
                T_DLV_EST_MNG.INQ_RESP_IND = '2'
                AND T_DLV_EST_MNG.DELETE_FLG = '0'
                GROUP BY T_DLV_EST_MNG.ORDER_NO
                ) TEST1
                ON TEST1.ORDER_NO = V_SLIP_REQ.ORDER_NO
           LEFT JOIN
                (SELECT ORDER_NO, SUM(DELIV_VOL) DELIV_VOL  FROM T_RECEIVE_MNG
                WHERE DELETE_FLG = '0' AND APP_INSPECT_SEQ IS NOT NULL
                GROUP BY ORDER_NO) TEST2
                ON TEST2.ORDER_NO = V_SLIP_REQ.ORDER_NO
           LEFT JOIN
                (SELECT T_ARRIVAL.ORDER_NO, SUM(T_ARRIVAL.DELIV_VOL) APPROVED_DELIV_VOL
                 FROM T_ARRIVAL
                 INNER JOIN T_RECEIVE_MNG
                  ON T_ARRIVAL.ARRIVAL_SEQ = T_RECEIVE_MNG.APP_ARRIVAL_SEQ
                 WHERE T_ARRIVAL.DELETE_FLG = '0'
                  AND T_ARRIVAL.RB_IND = '0'
                  AND T_RECEIVE_MNG.DELETE_FLG = '0'
                 GROUP BY T_ARRIVAL.ORDER_NO) APPROVED_T_ARRIVAL
                ON APPROVED_T_ARRIVAL.ORDER_NO = V_SLIP_REQ.ORDER_NO
        <where>
            <include refid="listKeyIdentityWhereCondition"/>
        </where>
       </select>

    <select id="listKeyIdentity" parameterType="fw.domain.slip.businesscommon.slipsearch.SlipSearchCondition"
        resultType="fw.domain.slip.businesscommon.slipsearch.SlipSearchIdentify">
            SELECT  SLIP_NO as slipNo
                    FROM V_SLIP_REQ_NO V_SLIP_REQ
            <where>
                <include refid="listKeyIdentityWhereCondition"/>
            </where>
        ORDER BY ${searchCondition.columnOrder.columnOrder()}
    </select>

    <resultMap type="fw.domain.slip.businesscommon.slipsearch.SlipSearchItem" id="SlipSearchItem_Map">
        <id column="ORDER_CANCEL_VOL" property="orderCancel.orderCancelVol.vol"/>
        <id column="ORDER_CANCEL_AMOUNT" property="orderCancel.orderCancelAmount.amount"/>
        <id column="ORD_EXT_TXT_1" property="orderExtItem.extendTxt.extendTxt1" />
        <id column="ORD_EXT_TXT_2" property="orderExtItem.extendTxt.extendTxt2" />
        <id column="ORD_EXT_TXT_3" property="orderExtItem.extendTxt.extendTxt3" />
        <id column="ORD_EXT_TXT_4" property="orderExtItem.extendTxt.extendTxt4" />
        <id column="ORD_EXT_TXT_5" property="orderExtItem.extendTxt.extendTxt5" />
        <id column="ORD_EXT_TXT_6" property="orderExtItem.extendTxt.extendTxt6" />
        <id column="ORD_EXT_TXT_7" property="orderExtItem.extendTxt.extendTxt7" />
        <id column="ORD_EXT_TXT_8" property="orderExtItem.extendTxt.extendTxt8" />
        <id column="ORD_EXT_TXT_9" property="orderExtItem.extendTxt.extendTxt9" />
        <id column="ORD_EXT_TXT_10" property="orderExtItem.extendTxt.extendTxt10" />
        <id column="ORD_EXT_AREA_1" property="orderExtItem.extendArea.extendArea1" />
        <id column="ORD_EXT_AREA_2" property="orderExtItem.extendArea.extendArea2" />
        <id column="ORD_EXT_AREA_3" property="orderExtItem.extendArea.extendArea3" />
        <id column="ORD_EXT_AREA_4" property="orderExtItem.extendArea.extendArea4" />
        <id column="ORD_EXT_AREA_5" property="orderExtItem.extendArea.extendArea5" />
        <id column="ORD_EXT_DATE_1" property="orderExtItem.extendDate.extendDate1.dateOfymd" />
        <id column="ORD_EXT_DATE_2" property="orderExtItem.extendDate.extendDate2.dateOfymd" />
        <id column="ORD_EXT_DATE_3" property="orderExtItem.extendDate.extendDate3.dateOfymd" />
        <id column="ORD_EXT_DATE_4" property="orderExtItem.extendDate.extendDate4.dateOfymd" />
        <id column="ORD_EXT_DATE_5" property="orderExtItem.extendDate.extendDate5.dateOfymd" />
        <id column="ORD_EXT_INT_1" property="orderExtItem.extendInt.extendInt1.value" />
        <id column="ORD_EXT_INT_2" property="orderExtItem.extendInt.extendInt2.value" />
        <id column="ORD_EXT_INT_3" property="orderExtItem.extendInt.extendInt3.value" />
        <id column="ORD_EXT_INT_4" property="orderExtItem.extendInt.extendInt4.value" />
        <id column="ORD_EXT_INT_5" property="orderExtItem.extendInt.extendInt5.value" />
        <id column="ORD_EXT_INT_6" property="orderExtItem.extendInt.extendInt6.value" />
        <id column="ORD_EXT_INT_7" property="orderExtItem.extendInt.extendInt7.value" />
        <id column="ORD_EXT_INT_8" property="orderExtItem.extendInt.extendInt8.value" />
        <id column="ORD_EXT_INT_9" property="orderExtItem.extendInt.extendInt9.value" />
        <id column="ORD_EXT_INT_10" property="orderExtItem.extendInt.extendInt10.value" />
        <id column="ORD_EXT_DEC_1" property="orderExtItem.extendDec.extendDec1.value" />
        <id column="ORD_EXT_DEC_2" property="orderExtItem.extendDec.extendDec2.value" />
        <id column="ORD_EXT_DEC_3" property="orderExtItem.extendDec.extendDec3.value" />
        <id column="ORD_EXT_DEC_4" property="orderExtItem.extendDec.extendDec4.value" />
        <id column="ORD_EXT_DEC_5" property="orderExtItem.extendDec.extendDec5.value" />
        <id column="ORD_EXT_SEL_1" property="orderExtItem.extendSel.extendSel1" />
        <id column="ORD_EXT_SEL_2" property="orderExtItem.extendSel.extendSel2" />
        <id column="ORD_EXT_SEL_3" property="orderExtItem.extendSel.extendSel3" />
        <id column="ORD_EXT_SEL_4" property="orderExtItem.extendSel.extendSel4" />
        <id column="ORD_EXT_SEL_5" property="orderExtItem.extendSel.extendSel5" />
        <id column="ORD_EXT_SEL_6" property="orderExtItem.extendSel.extendSel6" />
        <id column="ORD_EXT_SEL_7" property="orderExtItem.extendSel.extendSel7" />
        <id column="ORD_EXT_SEL_8" property="orderExtItem.extendSel.extendSel8" />
        <id column="ORD_EXT_SEL_9" property="orderExtItem.extendSel.extendSel9" />
        <id column="ORD_EXT_SEL_10" property="orderExtItem.extendSel.extendSel10" />
        <id column="ORD_EXT_CHK_1" property="orderExtItem.extendChk.extendChk1" />
        <id column="ORD_EXT_CHK_2" property="orderExtItem.extendChk.extendChk2" />
        <id column="ORD_EXT_CHK_3" property="orderExtItem.extendChk.extendChk3" />
        <id column="ORD_EXT_CHK_4" property="orderExtItem.extendChk.extendChk4" />
        <id column="ORD_EXT_CHK_5" property="orderExtItem.extendChk.extendChk5" />
        <id column="ORD_EXT_FILE_1" property="orderExtItem.extendFile.extendFile1.fileName" />
        <id column="ORD_EXT_FILE_2" property="orderExtItem.extendFile.extendFile2.fileName" />
        <id column="ORD_EXT_FILE_3" property="orderExtItem.extendFile.extendFile3.fileName" />
        <id column="ORD_EXT_MST_1" property="orderExtItem.extendMst.extendMst1.mstKey" />
        <id column="ORD_EXT_MST_2" property="orderExtItem.extendMst.extendMst2.mstKey" />
        <id column="ORD_EXT_MST_3" property="orderExtItem.extendMst.extendMst3.mstKey" />
        <id column="ORD_EXT_MST_4" property="orderExtItem.extendMst.extendMst4.mstKey" />
        <id column="ORD_EXT_MST_5" property="orderExtItem.extendMst.extendMst5.mstKey" />
        <id column="ORD_EXT_MST_6" property="orderExtItem.extendMst.extendMst6.mstKey" />
        <id column="ORD_EXT_MST_7" property="orderExtItem.extendMst.extendMst7.mstKey" />
        <id column="ORD_EXT_MST_8" property="orderExtItem.extendMst.extendMst8.mstKey" />
        <id column="ORD_EXT_MST_NAME_1" property="orderExtItem.extendMst.extendMst1.mstName" />
        <id column="ORD_EXT_MST_NAME_2" property="orderExtItem.extendMst.extendMst2.mstName" />
        <id column="ORD_EXT_MST_NAME_3" property="orderExtItem.extendMst.extendMst3.mstName" />
        <id column="ORD_EXT_MST_NAME_4" property="orderExtItem.extendMst.extendMst4.mstName" />
        <id column="ORD_EXT_MST_NAME_5" property="orderExtItem.extendMst.extendMst5.mstName" />
        <id column="ORD_EXT_MST_NAME_6" property="orderExtItem.extendMst.extendMst6.mstName" />
        <id column="ORD_EXT_MST_NAME_7" property="orderExtItem.extendMst.extendMst7.mstName" />
        <id column="ORD_EXT_MST_NAME_8" property="orderExtItem.extendMst.extendMst8.mstName" />
        <id column="APL_EXT_TXT_1" property="purAplExtItem.extendTxt.extendTxt1" />
        <id column="APL_EXT_TXT_2" property="purAplExtItem.extendTxt.extendTxt2" />
        <id column="APL_EXT_TXT_3" property="purAplExtItem.extendTxt.extendTxt3" />
        <id column="APL_EXT_TXT_4" property="purAplExtItem.extendTxt.extendTxt4" />
        <id column="APL_EXT_TXT_5" property="purAplExtItem.extendTxt.extendTxt5" />
        <id column="APL_EXT_TXT_6" property="purAplExtItem.extendTxt.extendTxt6" />
        <id column="APL_EXT_TXT_7" property="purAplExtItem.extendTxt.extendTxt7" />
        <id column="APL_EXT_TXT_8" property="purAplExtItem.extendTxt.extendTxt8" />
        <id column="APL_EXT_TXT_9" property="purAplExtItem.extendTxt.extendTxt9" />
        <id column="APL_EXT_TXT_10" property="purAplExtItem.extendTxt.extendTxt10" />
        <id column="APL_EXT_AREA_1" property="purAplExtItem.extendArea.extendArea1" />
        <id column="APL_EXT_AREA_2" property="purAplExtItem.extendArea.extendArea2" />
        <id column="APL_EXT_AREA_3" property="purAplExtItem.extendArea.extendArea3" />
        <id column="APL_EXT_AREA_4" property="purAplExtItem.extendArea.extendArea4" />
        <id column="APL_EXT_AREA_5" property="purAplExtItem.extendArea.extendArea5" />
        <id column="APL_EXT_DATE_1" property="purAplExtItem.extendDate.extendDate1.dateOfymd" />
        <id column="APL_EXT_DATE_2" property="purAplExtItem.extendDate.extendDate2.dateOfymd" />
        <id column="APL_EXT_DATE_3" property="purAplExtItem.extendDate.extendDate3.dateOfymd" />
        <id column="APL_EXT_DATE_4" property="purAplExtItem.extendDate.extendDate4.dateOfymd" />
        <id column="APL_EXT_DATE_5" property="purAplExtItem.extendDate.extendDate5.dateOfymd" />
        <id column="APL_EXT_INT_1" property="purAplExtItem.extendInt.extendInt1.value" />
        <id column="APL_EXT_INT_2" property="purAplExtItem.extendInt.extendInt2.value" />
        <id column="APL_EXT_INT_3" property="purAplExtItem.extendInt.extendInt3.value" />
        <id column="APL_EXT_INT_4" property="purAplExtItem.extendInt.extendInt4.value" />
        <id column="APL_EXT_INT_5" property="purAplExtItem.extendInt.extendInt5.value" />
        <id column="APL_EXT_INT_6" property="purAplExtItem.extendInt.extendInt6.value" />
        <id column="APL_EXT_INT_7" property="purAplExtItem.extendInt.extendInt7.value" />
        <id column="APL_EXT_INT_8" property="purAplExtItem.extendInt.extendInt8.value" />
        <id column="APL_EXT_INT_9" property="purAplExtItem.extendInt.extendInt9.value" />
        <id column="APL_EXT_INT_10" property="purAplExtItem.extendInt.extendInt10.value" />
        <id column="APL_EXT_DEC_1" property="purAplExtItem.extendDec.extendDec1.value" />
        <id column="APL_EXT_DEC_2" property="purAplExtItem.extendDec.extendDec2.value" />
        <id column="APL_EXT_DEC_3" property="purAplExtItem.extendDec.extendDec3.value" />
        <id column="APL_EXT_DEC_4" property="purAplExtItem.extendDec.extendDec4.value" />
        <id column="APL_EXT_DEC_5" property="purAplExtItem.extendDec.extendDec5.value" />
        <id column="APL_EXT_SEL_1" property="purAplExtItem.extendSel.extendSel1" />
        <id column="APL_EXT_SEL_2" property="purAplExtItem.extendSel.extendSel2" />
        <id column="APL_EXT_SEL_3" property="purAplExtItem.extendSel.extendSel3" />
        <id column="APL_EXT_SEL_4" property="purAplExtItem.extendSel.extendSel4" />
        <id column="APL_EXT_SEL_5" property="purAplExtItem.extendSel.extendSel5" />
        <id column="APL_EXT_SEL_6" property="purAplExtItem.extendSel.extendSel6" />
        <id column="APL_EXT_SEL_7" property="purAplExtItem.extendSel.extendSel7" />
        <id column="APL_EXT_SEL_8" property="purAplExtItem.extendSel.extendSel8" />
        <id column="APL_EXT_SEL_9" property="purAplExtItem.extendSel.extendSel9" />
        <id column="APL_EXT_SEL_10" property="purAplExtItem.extendSel.extendSel10" />
        <id column="APL_EXT_CHK_1" property="purAplExtItem.extendChk.extendChk1" />
        <id column="APL_EXT_CHK_2" property="purAplExtItem.extendChk.extendChk2" />
        <id column="APL_EXT_CHK_3" property="purAplExtItem.extendChk.extendChk3" />
        <id column="APL_EXT_CHK_4" property="purAplExtItem.extendChk.extendChk4" />
        <id column="APL_EXT_CHK_5" property="purAplExtItem.extendChk.extendChk5" />
        <id column="APL_EXT_FILE_1" property="purAplExtItem.extendFile.extendFile1.fileName" />
        <id column="APL_EXT_FILE_2" property="purAplExtItem.extendFile.extendFile2.fileName" />
        <id column="APL_EXT_FILE_3" property="purAplExtItem.extendFile.extendFile3.fileName" />
        <id column="APL_EXT_MST_1" property="purAplExtItem.extendMst.extendMst1.mstKey" />
        <id column="APL_EXT_MST_2" property="purAplExtItem.extendMst.extendMst2.mstKey" />
        <id column="APL_EXT_MST_3" property="purAplExtItem.extendMst.extendMst3.mstKey" />
        <id column="APL_EXT_MST_4" property="purAplExtItem.extendMst.extendMst4.mstKey" />
        <id column="APL_EXT_MST_5" property="purAplExtItem.extendMst.extendMst5.mstKey" />
        <id column="APL_EXT_MST_6" property="purAplExtItem.extendMst.extendMst6.mstKey" />
        <id column="APL_EXT_MST_7" property="purAplExtItem.extendMst.extendMst7.mstKey" />
        <id column="APL_EXT_MST_8" property="purAplExtItem.extendMst.extendMst8.mstKey" />
        <id column="APL_EXT_MST_NAME_1" property="purAplExtItem.extendMst.extendMst1.mstName" />
        <id column="APL_EXT_MST_NAME_2" property="purAplExtItem.extendMst.extendMst2.mstName" />
        <id column="APL_EXT_MST_NAME_3" property="purAplExtItem.extendMst.extendMst3.mstName" />
        <id column="APL_EXT_MST_NAME_4" property="purAplExtItem.extendMst.extendMst4.mstName" />
        <id column="APL_EXT_MST_NAME_5" property="purAplExtItem.extendMst.extendMst5.mstName" />
        <id column="APL_EXT_MST_NAME_6" property="purAplExtItem.extendMst.extendMst6.mstName" />
        <id column="APL_EXT_MST_NAME_7" property="purAplExtItem.extendMst.extendMst7.mstName" />
        <id column="APL_EXT_MST_NAME_8" property="purAplExtItem.extendMst.extendMst8.mstName" />
        <id column="REQ_EXT_TXT_1" property="purRequestExtItem.extendTxt.extendTxt1" />
        <id column="REQ_EXT_TXT_2" property="purRequestExtItem.extendTxt.extendTxt2" />
        <id column="REQ_EXT_TXT_3" property="purRequestExtItem.extendTxt.extendTxt3" />
        <id column="REQ_EXT_TXT_4" property="purRequestExtItem.extendTxt.extendTxt4" />
        <id column="REQ_EXT_TXT_5" property="purRequestExtItem.extendTxt.extendTxt5" />
        <id column="REQ_EXT_TXT_6" property="purRequestExtItem.extendTxt.extendTxt6" />
        <id column="REQ_EXT_TXT_7" property="purRequestExtItem.extendTxt.extendTxt7" />
        <id column="REQ_EXT_TXT_8" property="purRequestExtItem.extendTxt.extendTxt8" />
        <id column="REQ_EXT_TXT_9" property="purRequestExtItem.extendTxt.extendTxt9" />
        <id column="REQ_EXT_TXT_10" property="purRequestExtItem.extendTxt.extendTxt10" />
        <id column="REQ_EXT_AREA_1" property="purRequestExtItem.extendArea.extendArea1" />
        <id column="REQ_EXT_AREA_2" property="purRequestExtItem.extendArea.extendArea2" />
        <id column="REQ_EXT_AREA_3" property="purRequestExtItem.extendArea.extendArea3" />
        <id column="REQ_EXT_AREA_4" property="purRequestExtItem.extendArea.extendArea4" />
        <id column="REQ_EXT_AREA_5" property="purRequestExtItem.extendArea.extendArea5" />
        <id column="REQ_EXT_DATE_1" property="purRequestExtItem.extendDate.extendDate1.dateOfymd" />
        <id column="REQ_EXT_DATE_2" property="purRequestExtItem.extendDate.extendDate2.dateOfymd" />
        <id column="REQ_EXT_DATE_3" property="purRequestExtItem.extendDate.extendDate3.dateOfymd" />
        <id column="REQ_EXT_DATE_4" property="purRequestExtItem.extendDate.extendDate4.dateOfymd" />
        <id column="REQ_EXT_DATE_5" property="purRequestExtItem.extendDate.extendDate5.dateOfymd" />
        <id column="REQ_EXT_INT_1" property="purRequestExtItem.extendInt.extendInt1.value" />
        <id column="REQ_EXT_INT_2" property="purRequestExtItem.extendInt.extendInt2.value" />
        <id column="REQ_EXT_INT_3" property="purRequestExtItem.extendInt.extendInt3.value" />
        <id column="REQ_EXT_INT_4" property="purRequestExtItem.extendInt.extendInt4.value" />
        <id column="REQ_EXT_INT_5" property="purRequestExtItem.extendInt.extendInt5.value" />
        <id column="REQ_EXT_INT_6" property="purRequestExtItem.extendInt.extendInt6.value" />
        <id column="REQ_EXT_INT_7" property="purRequestExtItem.extendInt.extendInt7.value" />
        <id column="REQ_EXT_INT_8" property="purRequestExtItem.extendInt.extendInt8.value" />
        <id column="REQ_EXT_INT_9" property="purRequestExtItem.extendInt.extendInt9.value" />
        <id column="REQ_EXT_INT_10" property="purRequestExtItem.extendInt.extendInt10.value" />
        <id column="REQ_EXT_DEC_1" property="purRequestExtItem.extendDec.extendDec1.value" />
        <id column="REQ_EXT_DEC_2" property="purRequestExtItem.extendDec.extendDec2.value" />
        <id column="REQ_EXT_DEC_3" property="purRequestExtItem.extendDec.extendDec3.value" />
        <id column="REQ_EXT_DEC_4" property="purRequestExtItem.extendDec.extendDec4.value" />
        <id column="REQ_EXT_DEC_5" property="purRequestExtItem.extendDec.extendDec5.value" />
        <id column="REQ_EXT_SEL_1" property="purRequestExtItem.extendSel.extendSel1" />
        <id column="REQ_EXT_SEL_2" property="purRequestExtItem.extendSel.extendSel2" />
        <id column="REQ_EXT_SEL_3" property="purRequestExtItem.extendSel.extendSel3" />
        <id column="REQ_EXT_SEL_4" property="purRequestExtItem.extendSel.extendSel4" />
        <id column="REQ_EXT_SEL_5" property="purRequestExtItem.extendSel.extendSel5" />
        <id column="REQ_EXT_SEL_6" property="purRequestExtItem.extendSel.extendSel6" />
        <id column="REQ_EXT_SEL_7" property="purRequestExtItem.extendSel.extendSel7" />
        <id column="REQ_EXT_SEL_8" property="purRequestExtItem.extendSel.extendSel8" />
        <id column="REQ_EXT_SEL_9" property="purRequestExtItem.extendSel.extendSel9" />
        <id column="REQ_EXT_SEL_10" property="purRequestExtItem.extendSel.extendSel10" />
        <id column="REQ_EXT_CHK_1" property="purRequestExtItem.extendChk.extendChk1" />
        <id column="REQ_EXT_CHK_2" property="purRequestExtItem.extendChk.extendChk2" />
        <id column="REQ_EXT_CHK_3" property="purRequestExtItem.extendChk.extendChk3" />
        <id column="REQ_EXT_CHK_4" property="purRequestExtItem.extendChk.extendChk4" />
        <id column="REQ_EXT_CHK_5" property="purRequestExtItem.extendChk.extendChk5" />
        <id column="REQ_EXT_FILE_1" property="purRequestExtItem.extendFile.extendFile1.fileName" />
        <id column="REQ_EXT_FILE_2" property="purRequestExtItem.extendFile.extendFile2.fileName" />
        <id column="REQ_EXT_FILE_3" property="purRequestExtItem.extendFile.extendFile3.fileName" />
        <id column="REQ_EXT_MST_1" property="purRequestExtItem.extendMst.extendMst1.mstKey" />
        <id column="REQ_EXT_MST_2" property="purRequestExtItem.extendMst.extendMst2.mstKey" />
        <id column="REQ_EXT_MST_3" property="purRequestExtItem.extendMst.extendMst3.mstKey" />
        <id column="REQ_EXT_MST_4" property="purRequestExtItem.extendMst.extendMst4.mstKey" />
        <id column="REQ_EXT_MST_5" property="purRequestExtItem.extendMst.extendMst5.mstKey" />
        <id column="REQ_EXT_MST_6" property="purRequestExtItem.extendMst.extendMst6.mstKey" />
        <id column="REQ_EXT_MST_7" property="purRequestExtItem.extendMst.extendMst7.mstKey" />
        <id column="REQ_EXT_MST_8" property="purRequestExtItem.extendMst.extendMst8.mstKey" />
        <id column="REQ_EXT_MST_NAME_1" property="purRequestExtItem.extendMst.extendMst1.mstName" />
        <id column="REQ_EXT_MST_NAME_2" property="purRequestExtItem.extendMst.extendMst2.mstName" />
        <id column="REQ_EXT_MST_NAME_3" property="purRequestExtItem.extendMst.extendMst3.mstName" />
        <id column="REQ_EXT_MST_NAME_4" property="purRequestExtItem.extendMst.extendMst4.mstName" />
        <id column="REQ_EXT_MST_NAME_5" property="purRequestExtItem.extendMst.extendMst5.mstName" />
        <id column="REQ_EXT_MST_NAME_6" property="purRequestExtItem.extendMst.extendMst6.mstName" />
        <id column="REQ_EXT_MST_NAME_7" property="purRequestExtItem.extendMst.extendMst7.mstName" />
        <id column="REQ_EXT_MST_NAME_8" property="purRequestExtItem.extendMst.extendMst8.mstName" />
    </resultMap>

    <select id="listPageItem" parameterType="fw.domain.slip.businesscommon.slipsearch.SlipSearchCondition"
        resultMap="SlipSearchItem_Map">
                 SELECT
                     V_SLIP_REQ.SLIP_NO AS "slipSearchIdentify.slipNo",
                     V_SLIP_REQ.SLIP_NO AS slipNo,
                     V_SLIP_REQ.PUR_REQ_NO AS purReqNo,
                     V_SLIP_REQ.REQ_TYPE_IND AS reqInd,
                     V_SLIP_REQ.PUR_REQ_DATE AS "purReqDate.dateOfymd",
                     V_SLIP_REQ.ORDER_NO AS orderNo,
                     V_SLIP_REQ.ORDER_DATE AS "orderDate.dateOfymd",
                     T_QUOT_REQUEST.QUOT_REQ_NO AS "quotReqNo",
                     V_SLIP_REQ.PUR_APL_NO AS purAplNo,
                     V_SLIP_REQ.TITLE_NAME AS titleName,
                     V_SLIP_REQ.SUP_CD AS supCd,
                     V_SLIP_REQ.SUP_ABBR_NAME AS supName,
                     V_SLIP_REQ.SUBCON_IND AS subconInd,
                     V_SLIP_REQ.EDI_IND AS ediInd,
                     V_SLIP_REQ.ITEM_CD AS itemCd,
                     V_SLIP_REQ.ITEM_NAME AS itemName,
                     V_SLIP_REQ.KATASHIKI AS katashiki,
                     V_SLIP_REQ.MANUFACT_CD AS manufactCd,
                     V_SLIP_REQ.MANUFACT_NAME AS manufactName,
                     V_SLIP_REQ.REQ_DELIV_DATE AS "reqDelivDate.dateOfymd",
                     V_SLIP_REQ.ORDER_DELIV_DATE AS "orderDelivDate.dateOfymd",
                     V_SLIP_REQ.CURRENCY_CD AS currencyCd,
                     V_SLIP_REQ.UNIT_NAME AS unitName,
                     V_SLIP_REQ.REQ_VOL AS "hopeVol.vol",
                     V_SLIP_REQ.ORDER_VOL AS "orderVol.vol",
                     CASE WHEN (V_SLIP_REQ.ORDER_VOL - nvl(V_SLIP_REQ.RECEIVED_VOL,0)) &lt; 0 THEN 0 ELSE (V_SLIP_REQ.ORDER_VOL - nvl(V_SLIP_REQ.RECEIVED_VOL,0)) END AS "receiveRemainingVol.vol",
                     V_SLIP_REQ.UNIT_PRICE_IND AS unitPriceInd,
                     V_SLIP_REQ.HOPE_CURRENCY_CD AS hopeCurrencyCd,
                     V_SLIP_REQ.CURRENCY_CD AS currencyCd,
                     V_SLIP_REQ.REQ_UNIT_PRICE AS "hopeUnitPrice.amount",
                     V_SLIP_REQ.REQ_AMOUNT AS "hopeAmount.amount",
                     V_SLIP_REQ.ORDER_CANCEL_VOL,
                     V_SLIP_REQ.ORDER_CANCEL_AMOUNT,
                     V_SLIP_REQ.ORDER_UNIT_PRICE AS "orderUnitPrice.amount",
                     V_SLIP_REQ.ORDER_AMOUNT AS "orderAmount.amount",
                     V_SLIP_REQ.TAX_IND AS taxInd,
                     V_SLIP_REQ.BUDGET_NO AS budgetNo,
                     V_SLIP_REQ.SUBJECT_CD AS subjectCd,
                     V_SLIP_REQ.SUBJECT_NAME AS subjectName,
                     V_SLIP_REQ.DELIV_PLACE_CD AS delivPlaceCd,
                     V_SLIP_REQ.DELIV_PLACE_NAME AS delivPlaceName,
                     V_SLIP_REQ.ITEM_CLASS_L_NAME AS itemClassLName,
                     V_SLIP_REQ.ITEM_CLASS_M_NAME AS itemClassMName,
                     V_SLIP_REQ.ITEM_CLASS_S_NAME AS itemClassSName,
                     V_SLIP_REQ.REQ_SECTION_CD AS reqSectionCd,
                     V_SLIP_REQ.REQ_SECTION_NAME AS reqSectionName,
                     V_SLIP_REQ.REQ_USER_ID AS reqUserId,
                     V_SLIP_REQ.REQ_USER_NAME AS reqUserName,
                     V_SLIP_REQ.BUYER_SECTION_NAME AS buyerSectionName,
                     V_SLIP_REQ.BUYER_SECTION_CD AS buyerSectionCd,
                     V_SLIP_REQ.BUYER_USER_NAME AS buyerUserName,
                     V_SLIP_REQ.BUYER_USER_ID AS buyerUserId,
                     V_SLIP_REQ.LOAD_SECTION_CD AS loadSectionCd,
                     V_SLIP_REQ.LOAD_SECTION_NAME AS loadSectionName,
                     V_SLIP_REQ.SLIP_STATUS AS slipStatus,
                     V_SLIP_REQ.RECEIVE_STATUS_IND AS receiveStatusInd,
                     V_SLIP_REQ.INSPECT_STATUS_IND AS inspectStatusInd,
                     V_SLIP_REQ.ACCEPTANCE_STATUS_IND AS acceptanceStatusInd,
                     TEST2.DELIV_VOL AS "delivVol.vol",
                     T_QUOT_ACQ_APL.QUOT_ACQ_APL_STATUS AS quotAcqAplStat,
                     T_QUOT_REQUEST.QUOT_REQ_SEQ AS quotReqSeqNo,
                     V_SLIP_REQ.ORDER_SEQ AS orderSeq,
                     V_SLIP_REQ.PUR_REQ_SEQ AS purReqSeq,
                     TEST1.KENSHU AS kenshu,<!-- DAIKO_KANEKO TEST1:T_DLV_EST_MNG:納期管理の数は何に使うのか不明/削除した方がよい -->
                     V_SLIP_REQ.LAST_UPD_DATE AS lastUpdDate,
                     V_SLIP_REQ.ORDER_NO AS orderNo,
                     V_SLIP_REQ.PUR_APL_SEQ AS purAplSeqNo,
                     V_SLIP_REQ.APP_UNIT_NO AS appUnitNo,
                     T_QUOT_ACQ_APL.QUOT_ACQ_APL_SEQ AS quotAcqAplSeqNo,
                     APPROVED_T_ARRIVAL.APPROVED_DELIV_VOL AS "approvedDelivVol.vol" ,
                     V_SLIP_REQ.ACCEPT_VOL AS "acceptVol.vol",
                     V_SLIP_REQ.ACCEPT_AMOUNT AS "acceptAmount.amount",
                     V_SLIP_REQ.RECEIVED_VOL AS "receivedVol.vol",
                <include refid="extItem"/>
           FROM V_SLIP_REQ
           <!-- 多明細伝票で自動見積された際の見積と紐づけるために伝票番号と見積依頼番号を紐づける -->
           LEFT JOIN T_QUOT_REQUEST ON
                (V_SLIP_REQ.PUR_APL_NO = T_QUOT_REQUEST.QUOT_REQ_NO
                OR V_SLIP_REQ.SLIP_NO = T_QUOT_REQUEST.QUOT_REQ_NO)
                AND T_QUOT_REQUEST.QUOT_TYPE_IND IN ('1', '4')
                AND T_QUOT_REQUEST.NEW_APP_FLG = '1' <!-- 詳細画面用 2013.01.04 ADD DAIKO_KANEKO -->
                AND T_QUOT_REQUEST.DELETE_FLG = '0'
           LEFT JOIN T_QUOT_ACQ_APL
                ON T_QUOT_ACQ_APL.QUOT_ACQ_APL_NO = V_SLIP_REQ.PUR_APL_NO
                AND T_QUOT_ACQ_APL.NEW_FLG = '1'
                AND T_QUOT_ACQ_APL.DELETE_FLG ='0'

           <!-- DAIKO_KANEKO TEST1:T_DLV_EST_MNG:納期管理の数は何に使うのか不明/削除した方がよい -->
           LEFT JOIN
                (SELECT T_DLV_EST_MNG.ORDER_NO,
                 COUNT(T_DLV_EST_MNG.DELIV_MNG_SEQ) KENSHU
                 FROM T_DLV_EST_MNG
                WHERE
                T_DLV_EST_MNG.INQ_RESP_IND = '2'
                AND T_DLV_EST_MNG.DELETE_FLG = '0'
                GROUP BY T_DLV_EST_MNG.ORDER_NO
                ) TEST1
                ON TEST1.ORDER_NO = V_SLIP_REQ.ORDER_NO
           LEFT JOIN
                (SELECT T_RECEIVE_MNG.ORDER_NO, SUM(T_RECEIVE_MNG.DELIV_VOL) DELIV_VOL
                FROM T_RECEIVE_MNG
                 INNER JOIN T_ARRIVAL
                 ON T_RECEIVE_MNG.APP_ARRIVAL_SEQ = T_ARRIVAL.ARRIVAL_SEQ
                WHERE T_RECEIVE_MNG.DELETE_FLG = '0'
                 AND T_ARRIVAL.DELETE_FLG = '0'
                 AND T_ARRIVAL.ARRIVAL_STATUS = '04'
                GROUP BY T_RECEIVE_MNG.ORDER_NO) TEST2
                ON TEST2.ORDER_NO = V_SLIP_REQ.ORDER_NO

           LEFT JOIN
                (SELECT T_ARRIVAL.ORDER_NO, SUM(T_ARRIVAL.DELIV_VOL) APPROVED_DELIV_VOL
                 FROM T_ARRIVAL
                 INNER JOIN T_RECEIVE_MNG
                  ON T_ARRIVAL.ARRIVAL_SEQ = T_RECEIVE_MNG.APP_ARRIVAL_SEQ
                 WHERE T_ARRIVAL.DELETE_FLG = '0'
                  AND T_ARRIVAL.RB_IND = '0'
                  AND T_RECEIVE_MNG.DELETE_FLG = '0'
                 GROUP BY T_ARRIVAL.ORDER_NO) APPROVED_T_ARRIVAL
                ON APPROVED_T_ARRIVAL.ORDER_NO = V_SLIP_REQ.ORDER_NO
         <where>
                V_SLIP_REQ.SLIP_NO IN
                <foreach collection="searchCondition.page.keyDomainEntityList" item="keyList"  open="(" separator="," close=")">
                (#{keyList.slipNo})
                </foreach>
                <include refid="listKeyIdentityWhereCondition"/>
         </where>
         ORDER BY ${searchCondition.columnOrder.columnOrder()}
    </select>
    <sql id="pageHeader">
       SELECT * FROM (
    </sql>
    <sql id="pageRoot">
        ) WHERE  ROWNUM &lt;=${@fw.common.util.PropertiesUtil@getLong("DOWNLOAD_MAXCNT")}
    </sql>
    <!-- 詳細画面用 2013.01.04 ADD DAIKO_KANEKO START -->
    <!-- 暫定的にSlipMapperに配置 -->
    <select id="getReceiveManagement" resultMap="ReceiveManagement_Map">
        SELECT
            T_RECEIVE_MNG.ORDER_NO as "orderNo",<!-- 注文番号 -->
            T_RECEIVE_MNG.DELIV_KEY_NO,
            T_RECEIVE_MNG.DELIV_STATUS as "DELIV_STATUS",<!-- 受入管理ステータス -->
            T_RECEIVE_MNG.NEW_ARRIVAL_SEQ as "newSeqNo.arrival",<!-- 最新入荷シーケンス番号 -->
            T_RECEIVE_MNG.NEW_INSPECT_SEQ as "newSeqNo.inspect",<!-- 最新検査シーケンス番号 -->
            T_RECEIVE_MNG.NEW_ACCEPTANCE_SEQ as "newSeqNo.acceptance",<!-- 最新検収シーケンス番号 -->
            T_RECEIVE_MNG.APP_ARRIVAL_SEQ as "appSeqNo.arrival",<!-- 承認済入荷シーケンス番号 -->
            T_RECEIVE_MNG.APP_INSPECT_SEQ as "appSeqNo.inspect",<!-- 承認済検査シーケンス番号 -->
            T_RECEIVE_MNG.APP_ACCEPTANCE_SEQ as "appSeqNo.acceptance",<!-- 承認済検収シーケンス番号 -->
            T_RECEIVE_MNG.DELIV_VOL as "delivVol.delivVol.vol",<!-- 納入数量 -->
            T_ORDER.ORDER_VOL - SUM(T_RECEIVE_MNG.DELIV_VOL) as "unDelivVol.vol",<!-- 未納入数量 -->
            SUM(T_RECEIVE_MNG.DELIV_VOL) as "totalDelivVol.vol",<!-- 合計納入数量 -->
            T_RECEIVE_MNG.DELIV_VOL * T_ORDER.UNIT_PRICE as "totalAmount",<!-- 合計金額 -->
            T_RECEIVE_MNG.LAST_UPD_DATE as "lastUpdDate"<!-- 最終更新日時 -->
        FROM T_RECEIVE_MNG
        INNER JOIN T_ORDER ON
            T_RECEIVE_MNG.ORDER_NO = T_ORDER.ORDER_NO
        WHERE T_RECEIVE_MNG.ORDER_NO = #{orderNo}
            AND T_RECEIVE_MNG.DELETE_FLG = '0'
        GROUP BY
            T_RECEIVE_MNG.ORDER_NO,
            T_RECEIVE_MNG.DELIV_KEY_NO,
            T_RECEIVE_MNG.DELIV_STATUS,
            T_RECEIVE_MNG.NEW_ARRIVAL_SEQ,
            T_RECEIVE_MNG.NEW_INSPECT_SEQ,
            T_RECEIVE_MNG.NEW_ACCEPTANCE_SEQ,
            T_RECEIVE_MNG.APP_ARRIVAL_SEQ,
            T_RECEIVE_MNG.APP_INSPECT_SEQ,
            T_RECEIVE_MNG.APP_ACCEPTANCE_SEQ,
            T_RECEIVE_MNG.DELIV_VOL,
            T_ORDER.ORDER_VOL,
            T_ORDER.UNIT_PRICE,
            T_RECEIVE_MNG.LAST_UPD_DATE
    </select>

    <!-- 注文番号から受入管理リストを取得 -->
    <select id="getShipmentAndReceiveSummary" resultMap="ReceiveManagement_Map">
        SELECT
            T_RECEIVE_MNG.ORDER_NO as "orderNo.orderNo",<!-- 注文番号 -->
            T_RECEIVE_MNG.DELIV_KEY_NO,
            T_RECEIVE_MNG.NEW_ARRIVAL_SEQ as "newSeqNo.arrival",<!-- 最新入荷シーケンス番号 -->
            T_RECEIVE_MNG.NEW_INSPECT_SEQ as "newSeqNo.inspect",<!-- 最新検査シーケンス番号 -->
            T_RECEIVE_MNG.NEW_ACCEPTANCE_SEQ as "newSeqNo.acceptance",<!-- 最新検収シーケンス番号 -->
            T_RECEIVE_MNG.APP_ARRIVAL_SEQ as "appSeqNo.arrival",<!-- 承認済入荷シーケンス番号 -->
            T_RECEIVE_MNG.APP_INSPECT_SEQ as "appSeqNo.inspect",<!-- 承認済検査シーケンス番号 -->
            T_RECEIVE_MNG.APP_ACCEPTANCE_SEQ as "appSeqNo.acceptance" <!-- 承認済検収シーケンス番号 -->
        FROM
            T_RECEIVE_MNG
        INNER JOIN
            T_ORDER
        ON
            T_RECEIVE_MNG.ORDER_NO = T_ORDER.ORDER_NO
        WHERE
            T_RECEIVE_MNG.ORDER_NO = #{orderNo}
        AND T_RECEIVE_MNG.DELETE_FLG = '0'
        UNION ALL
        SELECT
            T_SHIPMENT_MNG.ORDER_NO as "orderNo.orderNo",<!-- 注文番号  -->
            T_SHIPMENT_MNG.DELIV_KEY_NO,
            0 as "newSeqNo.arrival",<!-- 最新入荷シーケンス番号 -->
            null as "newSeqNo.inspect",<!-- 最新検査シーケンス番号 -->
            null as "newSeqNo.acceptance",<!-- 最新検収シーケンス番号 -->
            null as "appSeqNo.arrival",<!-- 承認済入荷シーケンス番号 -->
            null as "appSeqNo.inspect",<!-- 承認済検査シーケンス番号 -->
            null as "appSeqNo.acceptance" <!-- 承認済検収シーケンス番号 -->
        FROM
            T_SHIPMENT_MNG
        INNER JOIN
            T_SHIPMENT
        ON
            T_SHIPMENT.SHIPMENT_SEQ = T_SHIPMENT_MNG.NEW_SHIPMENT_SEQ
        AND T_SHIPMENT.CORRECT_CD != '3'
        AND T_SHIPMENT.DELETE_FLG = 0
        WHERE
            T_SHIPMENT_MNG.ORDER_NO = #{orderNo}
        AND T_SHIPMENT_MNG.DELETE_FLG = '0'
        AND NOT EXISTS (
            SELECT
                T_SHIPMENT_MNG.ORDER_NO
            FROM
                T_RECEIVE_MNG
            WHERE
                T_SHIPMENT_MNG.ORDER_NO = T_RECEIVE_MNG.ORDER_NO
            AND T_SHIPMENT_MNG.DELIV_KEY_NO = T_RECEIVE_MNG.DELIV_KEY_NO
        )
    </select>
    <resultMap type="fw.domain.slip.receivemng.ReceiveManagement" id="ReceiveManagement_Map">
            <id column="DELIV_STATUS" property="receiveManagementStatus.receiveManagementStatus"/><!-- 受入管理ステータス -->
    </resultMap>

</mapper>