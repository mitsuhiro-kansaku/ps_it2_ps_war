<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" 
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="ps.dataaccess.his.history.HistoryMapper">

    <sql id="listKeyIdentityWhereCondition">
         AND V_HISTORY.BUYER_COMPANY_CD = '${@fw.security.SecurityUtil@getCompanyCdByEscapeSql()}'
         AND (V_HISTORY.SLIP_STATUS NOT IN
               ('0501','0502','0503','0504','0505','0506',
                '0101','0102','0103','0104','0105','0106','0107',
                '0211','0212','0213',
                '0301','0302','0303','0304','0305','0306','0307',
                '0411','0412','0413','0421','0422'
               ) OR (
                V_HISTORY.QUOT_ACQ_REQ_EXIST_FLG = '0' AND V_HISTORY.SLIP_STATUS IN
               ('0301','0302','0303','0304','0305','0306','0307',
                '0411','0412','0413','0421','0422')
               )
             )
        <if test="!@org.apache.commons.lang.StringUtils@isNotBlank(historySerchAllGrantFlg)">
         AND V_HISTORY.BUYER_SECTION_CD = '${@fw.security.SecurityUtil@getDefaultSectionCdByEscapeSql()}'
        </if>
        <if test="@org.apache.commons.lang.StringUtils@isNotBlank(historySerchAllGrantFlg)">
            <if test="@org.apache.commons.lang.StringUtils@isNotBlank(buyerSectionCd)">
         AND V_HISTORY.BUYER_SECTION_CD = #{buyerSectionCd}
            </if> 
        </if>
        <if test="@org.apache.commons.lang.StringUtils@isNotBlank(purReqNo)">
         AND V_HISTORY.SLIP_NO ${@fw.common.util.SearchModeUtil@getSearchSQL("fw.domain.slip.historysearch.HistorySearchSearchCondition","purReqNo")} 
        </if> 
        <if test="@org.apache.commons.lang.StringUtils@isNotBlank(aplNo)">
         AND V_HISTORY.PUR_APL_NO ${@fw.common.util.SearchModeUtil@getSearchSQL("fw.domain.slip.historysearch.HistorySearchSearchCondition","aplNo")} 
        </if>
        <if test="@org.apache.commons.lang.StringUtils@isNotBlank(orderNo)">
         AND V_HISTORY.ORDER_NO ${@fw.common.util.SearchModeUtil@getSearchSQL("fw.domain.slip.historysearch.HistorySearchSearchCondition","orderNo")} 
        </if>
        <if test="@org.apache.commons.lang.StringUtils@isNotBlank(quotReqNo)">
         AND T_QUOT_REQUEST.QUOT_REQ_NO ${@fw.common.util.SearchModeUtil@getSearchSQL("fw.domain.slip.historysearch.HistorySearchSearchCondition","quotReqNo")} 
        </if>
        <if test="@org.apache.commons.lang.StringUtils@isNotBlank(titleName)">
         AND V_HISTORY.TITLE_NAME ${@fw.common.util.SearchModeUtil@getSearchSQL("fw.domain.slip.historysearch.HistorySearchSearchCondition","titleName")} 
        </if>
        <if test="@org.apache.commons.lang.StringUtils@isNotBlank(itemCd)">
         AND V_HISTORY.ITEM_CD ${@fw.common.util.SearchModeUtil@getSearchSQL("fw.domain.slip.historysearch.HistorySearchSearchCondition","itemCd")} 
        </if>
        <if test="@org.apache.commons.lang.StringUtils@isNotBlank(itemName)">
         AND V_HISTORY.ITEM_NAME ${@fw.common.util.SearchModeUtil@getSearchSQL("fw.domain.slip.historysearch.HistorySearchSearchCondition","itemName")} 
        </if>
        <if test="@org.apache.commons.lang.StringUtils@isNotBlank(supplierFromCd)">
         AND V_HISTORY.SUP_CD ${@fw.common.util.SearchModeUtil@getSearchSQL("fw.domain.slip.historysearch.HistorySearchSearchCondition","supplierFromCd")} 
        </if>
        <if test="@org.apache.commons.lang.StringUtils@isNotBlank(supplierFromName)">
         AND V_HISTORY.SUP_ABBR_NAME ${@fw.common.util.SearchModeUtil@getSearchSQL("fw.domain.slip.historysearch.HistorySearchSearchCondition","supplierFromName")}
        </if>
        <if test="@org.apache.commons.lang.StringUtils@isNotBlank(buyerUserId)">
         AND V_HISTORY.BUYER_USER_ID = #{buyerUserId}
        </if>
        <if test="@org.apache.commons.lang.StringUtils@isNotBlank(reqSectionCd)">
         AND V_HISTORY.REQ_SECTION_CD = #{reqSectionCd}
        </if>
        <if test="@org.apache.commons.lang.StringUtils@isNotBlank(reqUserId)">
         AND V_HISTORY.REQ_USER_ID = #{reqUserId}
        </if>
        <if test="@org.apache.commons.lang.StringUtils@isNotBlank(orderDateFrom.dateOfymd)">
         AND V_HISTORY.ORDER_DATE >= #{orderDateFrom.dateOfymd}
        </if>
        <if test="@org.apache.commons.lang.StringUtils@isNotBlank(orderDateTo.dateOfymd)">
         AND V_HISTORY.ORDER_DATE &lt;= #{orderDateTo.dateOfymd}
        </if> 
        <if test="@org.apache.commons.lang.StringUtils@isNotBlank(purReqDateFrom.dateOfymd)">
         AND V_HISTORY.PUR_REQ_DATE >= #{purReqDateFrom.dateOfymd}
        </if>
        <if test="@org.apache.commons.lang.StringUtils@isNotBlank(purReqDateTo.dateOfymd)">
         AND V_HISTORY.PUR_REQ_DATE &lt;= #{purReqDateTo.dateOfymd}
        </if>
        <if test="@org.apache.commons.lang.StringUtils@isNotBlank(reqInd)">
         AND V_HISTORY.REQ_TYPE_IND = #{reqInd}
        </if>
        <if test="@org.apache.commons.lang.StringUtils@isBlank(reqInd)">
         AND V_HISTORY.REQ_TYPE_IND IN ('2','3','9')
        </if>
        <!-- 受入状況のいづれかが選択されていた場合 若しくは、検収状況のいづれかが選択していた場合 -->
        <if test="!receiveStates.empty or !acceptanceStates.empty">
         AND V_HISTORY.ORDER_STATUS != '10'
        </if>
        <if test="!receiveStates.empty">
         AND V_HISTORY.RECEIVE_STATUS_IND IN
            <foreach collection="receiveStates.list" item="receiveStatus" open="(" separator="," close=")">
                #{receiveStatus, jdbcType=VARCHAR}
            </foreach>
        </if>
        <if test="!acceptanceStates.empty">
         AND V_HISTORY.ACCEPTANCE_STATUS_IND IN
            <foreach collection="acceptanceStates.list" item="acceptanceStatus" open="(" separator="," close=")">
                #{acceptanceStatus, jdbcType=VARCHAR}
            </foreach>
        </if>
    </sql>

    <!--検索条件で全てキリストを取得する-->
    <select id="listKeyIdentity" 
        parameterType="fw.domain.slip.historysearch.HistorySearchSearchCondition"
        resultType="fw.domain.slip.slipmng.SlipMngIdentify">
        SELECT      V_HISTORY.SLIP_NO as slipNo
        FROM        V_HISTORY
        LEFT JOIN   T_QUOT_REQUEST
        ON          (T_QUOT_REQUEST.QUOT_REQ_NO = V_HISTORY.PUR_APL_NO
        OR          V_HISTORY.SLIP_NO = T_QUOT_REQUEST.QUOT_REQ_NO)
        AND         T_QUOT_REQUEST.QUOT_TYPE_IND IN ('1','4')
        AND         T_QUOT_REQUEST.NEW_FLG = '1'
        AND         T_QUOT_REQUEST.DELETE_FLG = '0'
        <where>
            <include refid="listKeyIdentityWhereCondition"/>
        </where>
        ORDER BY ${searchCondition.columnOrder.columnOrder()}
    </select>

    <resultMap type="fw.domain.slip.historysearch.HistorySearchItem" id="HistorySearchItem_Map">
        <id column="ORDER_CANCEL_VOL" property="orderCancel.orderCancelVol.vol"/>
        <id column="ORDER_CANCEL_AMOUNT" property="orderCancel.orderCancelAmount.amount"/>
        <id column="ORD_EXT_TXT_1" property="orderExtItem.extendTxt.extendTxt1" />
        <id column="ORD_EXT_TXT_2" property="orderExtItem.extendTxt.extendTxt2" />
        <id column="ORD_EXT_TXT_3" property="orderExtItem.extendTxt.extendTxt3" />
        <id column="ORD_EXT_TXT_4" property="orderExtItem.extendTxt.extendTxt4" />
        <id column="ORD_EXT_TXT_5" property="orderExtItem.extendTxt.extendTxt5" />
        <id column="ORD_EXT_TXT_6" property="orderExtItem.extendTxt.extendTxt6" />
        <id column="ORD_EXT_TXT_7" property="orderExtItem.extendTxt.extendTxt7" />
        <id column="ORD_EXT_TXT_8" property="orderExtItem.extendTxt.extendTxt8" />
        <id column="ORD_EXT_TXT_9" property="orderExtItem.extendTxt.extendTxt9" />
        <id column="ORD_EXT_TXT_10" property="orderExtItem.extendTxt.extendTxt10" />
        <id column="ORD_EXT_AREA_1" property="orderExtItem.extendArea.extendArea1" />
        <id column="ORD_EXT_AREA_2" property="orderExtItem.extendArea.extendArea2" />
        <id column="ORD_EXT_AREA_3" property="orderExtItem.extendArea.extendArea3" />
        <id column="ORD_EXT_AREA_4" property="orderExtItem.extendArea.extendArea4" />
        <id column="ORD_EXT_AREA_5" property="orderExtItem.extendArea.extendArea5" />
        <id column="ORD_EXT_DATE_1" property="orderExtItem.extendDate.extendDate1.dateOfymd" />
        <id column="ORD_EXT_DATE_2" property="orderExtItem.extendDate.extendDate2.dateOfymd" />
        <id column="ORD_EXT_DATE_3" property="orderExtItem.extendDate.extendDate3.dateOfymd" />
        <id column="ORD_EXT_DATE_4" property="orderExtItem.extendDate.extendDate4.dateOfymd" />
        <id column="ORD_EXT_DATE_5" property="orderExtItem.extendDate.extendDate5.dateOfymd" />
        <id column="ORD_EXT_INT_1" property="orderExtItem.extendInt.extendInt1.value" />
        <id column="ORD_EXT_INT_2" property="orderExtItem.extendInt.extendInt2.value" />
        <id column="ORD_EXT_INT_3" property="orderExtItem.extendInt.extendInt3.value" />
        <id column="ORD_EXT_INT_4" property="orderExtItem.extendInt.extendInt4.value" />
        <id column="ORD_EXT_INT_5" property="orderExtItem.extendInt.extendInt5.value" />
        <id column="ORD_EXT_INT_6" property="orderExtItem.extendInt.extendInt6.value" />
        <id column="ORD_EXT_INT_7" property="orderExtItem.extendInt.extendInt7.value" />
        <id column="ORD_EXT_INT_8" property="orderExtItem.extendInt.extendInt8.value" />
        <id column="ORD_EXT_INT_9" property="orderExtItem.extendInt.extendInt9.value" />
        <id column="ORD_EXT_INT_10" property="orderExtItem.extendInt.extendInt10.value" />
        <id column="ORD_EXT_DEC_1" property="orderExtItem.extendDec.extendDec1.value" />
        <id column="ORD_EXT_DEC_2" property="orderExtItem.extendDec.extendDec2.value" />
        <id column="ORD_EXT_DEC_3" property="orderExtItem.extendDec.extendDec3.value" />
        <id column="ORD_EXT_DEC_4" property="orderExtItem.extendDec.extendDec4.value" />
        <id column="ORD_EXT_DEC_5" property="orderExtItem.extendDec.extendDec5.value" />
        <id column="ORD_EXT_SEL_1" property="orderExtItem.extendSel.extendSel1" />
        <id column="ORD_EXT_SEL_2" property="orderExtItem.extendSel.extendSel2" />
        <id column="ORD_EXT_SEL_3" property="orderExtItem.extendSel.extendSel3" />
        <id column="ORD_EXT_SEL_4" property="orderExtItem.extendSel.extendSel4" />
        <id column="ORD_EXT_SEL_5" property="orderExtItem.extendSel.extendSel5" />
        <id column="ORD_EXT_SEL_6" property="orderExtItem.extendSel.extendSel6" />
        <id column="ORD_EXT_SEL_7" property="orderExtItem.extendSel.extendSel7" />
        <id column="ORD_EXT_SEL_8" property="orderExtItem.extendSel.extendSel8" />
        <id column="ORD_EXT_SEL_9" property="orderExtItem.extendSel.extendSel9" />
        <id column="ORD_EXT_SEL_10" property="orderExtItem.extendSel.extendSel10" />
        <id column="ORD_EXT_CHK_1" property="orderExtItem.extendChk.extendChk1" />
        <id column="ORD_EXT_CHK_2" property="orderExtItem.extendChk.extendChk2" />
        <id column="ORD_EXT_CHK_3" property="orderExtItem.extendChk.extendChk3" />
        <id column="ORD_EXT_CHK_4" property="orderExtItem.extendChk.extendChk4" />
        <id column="ORD_EXT_CHK_5" property="orderExtItem.extendChk.extendChk5" />
        <id column="ORD_EXT_FILE_1" property="orderExtItem.extendFile.extendFile1.fileName" />
        <id column="ORD_EXT_FILE_2" property="orderExtItem.extendFile.extendFile2.fileName" />
        <id column="ORD_EXT_FILE_3" property="orderExtItem.extendFile.extendFile3.fileName" />
        <id column="ORD_EXT_MST_1" property="orderExtItem.extendMst.extendMst1.mstKey" />
        <id column="ORD_EXT_MST_2" property="orderExtItem.extendMst.extendMst2.mstKey" />
        <id column="ORD_EXT_MST_3" property="orderExtItem.extendMst.extendMst3.mstKey" />
        <id column="ORD_EXT_MST_4" property="orderExtItem.extendMst.extendMst4.mstKey" />
        <id column="ORD_EXT_MST_5" property="orderExtItem.extendMst.extendMst5.mstKey" />
        <id column="ORD_EXT_MST_6" property="orderExtItem.extendMst.extendMst6.mstKey" />
        <id column="ORD_EXT_MST_7" property="orderExtItem.extendMst.extendMst7.mstKey" />
        <id column="ORD_EXT_MST_8" property="orderExtItem.extendMst.extendMst8.mstKey" />
        <id column="ORD_EXT_MST_NAME_1" property="orderExtItem.extendMst.extendMst1.mstName" />
        <id column="ORD_EXT_MST_NAME_2" property="orderExtItem.extendMst.extendMst2.mstName" />
        <id column="ORD_EXT_MST_NAME_3" property="orderExtItem.extendMst.extendMst3.mstName" />
        <id column="ORD_EXT_MST_NAME_4" property="orderExtItem.extendMst.extendMst4.mstName" />
        <id column="ORD_EXT_MST_NAME_5" property="orderExtItem.extendMst.extendMst5.mstName" />
        <id column="ORD_EXT_MST_NAME_6" property="orderExtItem.extendMst.extendMst6.mstName" />
        <id column="ORD_EXT_MST_NAME_7" property="orderExtItem.extendMst.extendMst7.mstName" />
        <id column="ORD_EXT_MST_NAME_8" property="orderExtItem.extendMst.extendMst8.mstName" />
        <id column="APL_EXT_TXT_1" property="purAplExtItem.extendTxt.extendTxt1" />
        <id column="APL_EXT_TXT_2" property="purAplExtItem.extendTxt.extendTxt2" />
        <id column="APL_EXT_TXT_3" property="purAplExtItem.extendTxt.extendTxt3" />
        <id column="APL_EXT_TXT_4" property="purAplExtItem.extendTxt.extendTxt4" />
        <id column="APL_EXT_TXT_5" property="purAplExtItem.extendTxt.extendTxt5" />
        <id column="APL_EXT_TXT_6" property="purAplExtItem.extendTxt.extendTxt6" />
        <id column="APL_EXT_TXT_7" property="purAplExtItem.extendTxt.extendTxt7" />
        <id column="APL_EXT_TXT_8" property="purAplExtItem.extendTxt.extendTxt8" />
        <id column="APL_EXT_TXT_9" property="purAplExtItem.extendTxt.extendTxt9" />
        <id column="APL_EXT_TXT_10" property="purAplExtItem.extendTxt.extendTxt10" />
        <id column="APL_EXT_AREA_1" property="purAplExtItem.extendArea.extendArea1" />
        <id column="APL_EXT_AREA_2" property="purAplExtItem.extendArea.extendArea2" />
        <id column="APL_EXT_AREA_3" property="purAplExtItem.extendArea.extendArea3" />
        <id column="APL_EXT_AREA_4" property="purAplExtItem.extendArea.extendArea4" />
        <id column="APL_EXT_AREA_5" property="purAplExtItem.extendArea.extendArea5" />
        <id column="APL_EXT_DATE_1" property="purAplExtItem.extendDate.extendDate1.dateOfymd" />
        <id column="APL_EXT_DATE_2" property="purAplExtItem.extendDate.extendDate2.dateOfymd" />
        <id column="APL_EXT_DATE_3" property="purAplExtItem.extendDate.extendDate3.dateOfymd" />
        <id column="APL_EXT_DATE_4" property="purAplExtItem.extendDate.extendDate4.dateOfymd" />
        <id column="APL_EXT_DATE_5" property="purAplExtItem.extendDate.extendDate5.dateOfymd" />
        <id column="APL_EXT_INT_1" property="purAplExtItem.extendInt.extendInt1.value" />
        <id column="APL_EXT_INT_2" property="purAplExtItem.extendInt.extendInt2.value" />
        <id column="APL_EXT_INT_3" property="purAplExtItem.extendInt.extendInt3.value" />
        <id column="APL_EXT_INT_4" property="purAplExtItem.extendInt.extendInt4.value" />
        <id column="APL_EXT_INT_5" property="purAplExtItem.extendInt.extendInt5.value" />
        <id column="APL_EXT_INT_6" property="purAplExtItem.extendInt.extendInt6.value" />
        <id column="APL_EXT_INT_7" property="purAplExtItem.extendInt.extendInt7.value" />
        <id column="APL_EXT_INT_8" property="purAplExtItem.extendInt.extendInt8.value" />
        <id column="APL_EXT_INT_9" property="purAplExtItem.extendInt.extendInt9.value" />
        <id column="APL_EXT_INT_10" property="purAplExtItem.extendInt.extendInt10.value" />
        <id column="APL_EXT_DEC_1" property="purAplExtItem.extendDec.extendDec1.value" />
        <id column="APL_EXT_DEC_2" property="purAplExtItem.extendDec.extendDec2.value" />
        <id column="APL_EXT_DEC_3" property="purAplExtItem.extendDec.extendDec3.value" />
        <id column="APL_EXT_DEC_4" property="purAplExtItem.extendDec.extendDec4.value" />
        <id column="APL_EXT_DEC_5" property="purAplExtItem.extendDec.extendDec5.value" />
        <id column="APL_EXT_SEL_1" property="purAplExtItem.extendSel.extendSel1" />
        <id column="APL_EXT_SEL_2" property="purAplExtItem.extendSel.extendSel2" />
        <id column="APL_EXT_SEL_3" property="purAplExtItem.extendSel.extendSel3" />
        <id column="APL_EXT_SEL_4" property="purAplExtItem.extendSel.extendSel4" />
        <id column="APL_EXT_SEL_5" property="purAplExtItem.extendSel.extendSel5" />
        <id column="APL_EXT_SEL_6" property="purAplExtItem.extendSel.extendSel6" />
        <id column="APL_EXT_SEL_7" property="purAplExtItem.extendSel.extendSel7" />
        <id column="APL_EXT_SEL_8" property="purAplExtItem.extendSel.extendSel8" />
        <id column="APL_EXT_SEL_9" property="purAplExtItem.extendSel.extendSel9" />
        <id column="APL_EXT_SEL_10" property="purAplExtItem.extendSel.extendSel10" />
        <id column="APL_EXT_CHK_1" property="purAplExtItem.extendChk.extendChk1" />
        <id column="APL_EXT_CHK_2" property="purAplExtItem.extendChk.extendChk2" />
        <id column="APL_EXT_CHK_3" property="purAplExtItem.extendChk.extendChk3" />
        <id column="APL_EXT_CHK_4" property="purAplExtItem.extendChk.extendChk4" />
        <id column="APL_EXT_CHK_5" property="purAplExtItem.extendChk.extendChk5" />
        <id column="APL_EXT_FILE_1" property="purAplExtItem.extendFile.extendFile1.fileName" />
        <id column="APL_EXT_FILE_2" property="purAplExtItem.extendFile.extendFile2.fileName" />
        <id column="APL_EXT_FILE_3" property="purAplExtItem.extendFile.extendFile3.fileName" />
        <id column="APL_EXT_MST_1" property="purAplExtItem.extendMst.extendMst1.mstKey" />
        <id column="APL_EXT_MST_2" property="purAplExtItem.extendMst.extendMst2.mstKey" />
        <id column="APL_EXT_MST_3" property="purAplExtItem.extendMst.extendMst3.mstKey" />
        <id column="APL_EXT_MST_4" property="purAplExtItem.extendMst.extendMst4.mstKey" />
        <id column="APL_EXT_MST_5" property="purAplExtItem.extendMst.extendMst5.mstKey" />
        <id column="APL_EXT_MST_6" property="purAplExtItem.extendMst.extendMst6.mstKey" />
        <id column="APL_EXT_MST_7" property="purAplExtItem.extendMst.extendMst7.mstKey" />
        <id column="APL_EXT_MST_8" property="purAplExtItem.extendMst.extendMst8.mstKey" />
        <id column="APL_EXT_MST_NAME_1" property="purAplExtItem.extendMst.extendMst1.mstName" />
        <id column="APL_EXT_MST_NAME_2" property="purAplExtItem.extendMst.extendMst2.mstName" />
        <id column="APL_EXT_MST_NAME_3" property="purAplExtItem.extendMst.extendMst3.mstName" />
        <id column="APL_EXT_MST_NAME_4" property="purAplExtItem.extendMst.extendMst4.mstName" />
        <id column="APL_EXT_MST_NAME_5" property="purAplExtItem.extendMst.extendMst5.mstName" />
        <id column="APL_EXT_MST_NAME_6" property="purAplExtItem.extendMst.extendMst6.mstName" />
        <id column="APL_EXT_MST_NAME_7" property="purAplExtItem.extendMst.extendMst7.mstName" />
        <id column="APL_EXT_MST_NAME_8" property="purAplExtItem.extendMst.extendMst8.mstName" />
        <id column="REQ_EXT_TXT_1" property="purRequestExtItem.extendTxt.extendTxt1" />
        <id column="REQ_EXT_TXT_2" property="purRequestExtItem.extendTxt.extendTxt2" />
        <id column="REQ_EXT_TXT_3" property="purRequestExtItem.extendTxt.extendTxt3" />
        <id column="REQ_EXT_TXT_4" property="purRequestExtItem.extendTxt.extendTxt4" />
        <id column="REQ_EXT_TXT_5" property="purRequestExtItem.extendTxt.extendTxt5" />
        <id column="REQ_EXT_TXT_6" property="purRequestExtItem.extendTxt.extendTxt6" />
        <id column="REQ_EXT_TXT_7" property="purRequestExtItem.extendTxt.extendTxt7" />
        <id column="REQ_EXT_TXT_8" property="purRequestExtItem.extendTxt.extendTxt8" />
        <id column="REQ_EXT_TXT_9" property="purRequestExtItem.extendTxt.extendTxt9" />
        <id column="REQ_EXT_TXT_10" property="purRequestExtItem.extendTxt.extendTxt10" />
        <id column="REQ_EXT_AREA_1" property="purRequestExtItem.extendArea.extendArea1" />
        <id column="REQ_EXT_AREA_2" property="purRequestExtItem.extendArea.extendArea2" />
        <id column="REQ_EXT_AREA_3" property="purRequestExtItem.extendArea.extendArea3" />
        <id column="REQ_EXT_AREA_4" property="purRequestExtItem.extendArea.extendArea4" />
        <id column="REQ_EXT_AREA_5" property="purRequestExtItem.extendArea.extendArea5" />
        <id column="REQ_EXT_DATE_1" property="purRequestExtItem.extendDate.extendDate1.dateOfymd" />
        <id column="REQ_EXT_DATE_2" property="purRequestExtItem.extendDate.extendDate2.dateOfymd" />
        <id column="REQ_EXT_DATE_3" property="purRequestExtItem.extendDate.extendDate3.dateOfymd" />
        <id column="REQ_EXT_DATE_4" property="purRequestExtItem.extendDate.extendDate4.dateOfymd" />
        <id column="REQ_EXT_DATE_5" property="purRequestExtItem.extendDate.extendDate5.dateOfymd" />
        <id column="REQ_EXT_INT_1" property="purRequestExtItem.extendInt.extendInt1.value" />
        <id column="REQ_EXT_INT_2" property="purRequestExtItem.extendInt.extendInt2.value" />
        <id column="REQ_EXT_INT_3" property="purRequestExtItem.extendInt.extendInt3.value" />
        <id column="REQ_EXT_INT_4" property="purRequestExtItem.extendInt.extendInt4.value" />
        <id column="REQ_EXT_INT_5" property="purRequestExtItem.extendInt.extendInt5.value" />
        <id column="REQ_EXT_INT_6" property="purRequestExtItem.extendInt.extendInt6.value" />
        <id column="REQ_EXT_INT_7" property="purRequestExtItem.extendInt.extendInt7.value" />
        <id column="REQ_EXT_INT_8" property="purRequestExtItem.extendInt.extendInt8.value" />
        <id column="REQ_EXT_INT_9" property="purRequestExtItem.extendInt.extendInt9.value" />
        <id column="REQ_EXT_INT_10" property="purRequestExtItem.extendInt.extendInt10.value" />
        <id column="REQ_EXT_DEC_1" property="purRequestExtItem.extendDec.extendDec1.value" />
        <id column="REQ_EXT_DEC_2" property="purRequestExtItem.extendDec.extendDec2.value" />
        <id column="REQ_EXT_DEC_3" property="purRequestExtItem.extendDec.extendDec3.value" />
        <id column="REQ_EXT_DEC_4" property="purRequestExtItem.extendDec.extendDec4.value" />
        <id column="REQ_EXT_DEC_5" property="purRequestExtItem.extendDec.extendDec5.value" />
        <id column="REQ_EXT_SEL_1" property="purRequestExtItem.extendSel.extendSel1" />
        <id column="REQ_EXT_SEL_2" property="purRequestExtItem.extendSel.extendSel2" />
        <id column="REQ_EXT_SEL_3" property="purRequestExtItem.extendSel.extendSel3" />
        <id column="REQ_EXT_SEL_4" property="purRequestExtItem.extendSel.extendSel4" />
        <id column="REQ_EXT_SEL_5" property="purRequestExtItem.extendSel.extendSel5" />
        <id column="REQ_EXT_SEL_6" property="purRequestExtItem.extendSel.extendSel6" />
        <id column="REQ_EXT_SEL_7" property="purRequestExtItem.extendSel.extendSel7" />
        <id column="REQ_EXT_SEL_8" property="purRequestExtItem.extendSel.extendSel8" />
        <id column="REQ_EXT_SEL_9" property="purRequestExtItem.extendSel.extendSel9" />
        <id column="REQ_EXT_SEL_10" property="purRequestExtItem.extendSel.extendSel10" />
        <id column="REQ_EXT_CHK_1" property="purRequestExtItem.extendChk.extendChk1" />
        <id column="REQ_EXT_CHK_2" property="purRequestExtItem.extendChk.extendChk2" />
        <id column="REQ_EXT_CHK_3" property="purRequestExtItem.extendChk.extendChk3" />
        <id column="REQ_EXT_CHK_4" property="purRequestExtItem.extendChk.extendChk4" />
        <id column="REQ_EXT_CHK_5" property="purRequestExtItem.extendChk.extendChk5" />
        <id column="REQ_EXT_FILE_1" property="purRequestExtItem.extendFile.extendFile1.fileName" />
        <id column="REQ_EXT_FILE_2" property="purRequestExtItem.extendFile.extendFile2.fileName" />
        <id column="REQ_EXT_FILE_3" property="purRequestExtItem.extendFile.extendFile3.fileName" />
        <id column="REQ_EXT_MST_1" property="purRequestExtItem.extendMst.extendMst1.mstKey" />
        <id column="REQ_EXT_MST_2" property="purRequestExtItem.extendMst.extendMst2.mstKey" />
        <id column="REQ_EXT_MST_3" property="purRequestExtItem.extendMst.extendMst3.mstKey" />
        <id column="REQ_EXT_MST_4" property="purRequestExtItem.extendMst.extendMst4.mstKey" />
        <id column="REQ_EXT_MST_5" property="purRequestExtItem.extendMst.extendMst5.mstKey" />
        <id column="REQ_EXT_MST_6" property="purRequestExtItem.extendMst.extendMst6.mstKey" />
        <id column="REQ_EXT_MST_7" property="purRequestExtItem.extendMst.extendMst7.mstKey" />
        <id column="REQ_EXT_MST_8" property="purRequestExtItem.extendMst.extendMst8.mstKey" />
        <id column="REQ_EXT_MST_NAME_1" property="purRequestExtItem.extendMst.extendMst1.mstName" />
        <id column="REQ_EXT_MST_NAME_2" property="purRequestExtItem.extendMst.extendMst2.mstName" />
        <id column="REQ_EXT_MST_NAME_3" property="purRequestExtItem.extendMst.extendMst3.mstName" />
        <id column="REQ_EXT_MST_NAME_4" property="purRequestExtItem.extendMst.extendMst4.mstName" />
        <id column="REQ_EXT_MST_NAME_5" property="purRequestExtItem.extendMst.extendMst5.mstName" />
        <id column="REQ_EXT_MST_NAME_6" property="purRequestExtItem.extendMst.extendMst6.mstName" />
        <id column="REQ_EXT_MST_NAME_7" property="purRequestExtItem.extendMst.extendMst7.mstName" />
        <id column="REQ_EXT_MST_NAME_8" property="purRequestExtItem.extendMst.extendMst8.mstName" />
    </resultMap>
    
    <!--履歴照会明細を取得する-->
    <select id="listPageItem" 
        parameterType="fw.domain.mst.searchcondition.SearchCondition" 
        resultMap="HistorySearchItem_Map">
         SELECT V_HISTORY.SLIP_NO AS "purReqNo",
               V_HISTORY.REQ_TYPE_IND AS "reqInd",
               V_HISTORY.CORRECT_CD AS "correctInd",
               V_HISTORY.PUR_REQ_DATE AS "purReqDate.dateOfymd",
               V_HISTORY.ORDER_NO AS "orderNo",
               V_HISTORY.ORDER_DATE AS "orderDate.dateOfymd",
               V_HISTORY.CHANGE_ORDER_DATE AS "changeOrderDate.dateOfymd",
               T_QUOT_REQUEST.QUOT_REQ_NO AS "quotReqNo",
               T_QUOT_ACQ_APL.QUOT_ACQ_APL_NO AS "quotAcqAplNo",  <!-- 詳細画面用 2013.01.08 ADD DAIKO_KANEKO -->
               V_HISTORY.PUR_APL_NO AS "purAplNo",   <!-- 詳細画面用 2013.01.04 ADD DAIKO_KANEKO -->
               V_HISTORY.TITLE_NAME AS "titleName",
               V_HISTORY.ITEM_CD AS "itemCd",
               V_HISTORY.ITEM_NAME AS "item",
               V_HISTORY.KATASHIKI AS "katashiki",
               V_HISTORY.MANUFACT_CD AS "manufactCd",
               V_HISTORY.MANUFACT_NAME AS "manufactName",
               V_HISTORY.SUP_CD AS "supplierFromCd",
               V_HISTORY.SUP_ABBR_NAME AS "supplierFromName",
               V_HISTORY.UNIT_NAME AS "unit",
               V_HISTORY.REQ_VOL AS "hopeVol.vol",
               V_HISTORY.ORDER_VOL AS "orderVol.vol",
               V_HISTORY.ORDER_CANCEL_VOL,
               V_HISTORY.ORDER_CANCEL_AMOUNT,
               CASE WHEN V_HISTORY.ORDER_VOL IS NULL THEN V_HISTORY.ORDER_VOL
               WHEN (nvl(V_HISTORY.ORDER_VOL,0) - nvl(V_HISTORY.RECEIVED_VOL,0)) &lt; 0 THEN 0 
               ELSE (nvl(V_HISTORY.ORDER_VOL,0) - nvl(V_HISTORY.RECEIVED_VOL,0)) END AS "receiveRemainingVol.vol",
               V_HISTORY.DELIV_PLACE_CD AS "delivPlaceCd",
               V_HISTORY.DELIV_PLACE_NAME AS "delivPlaceName",
               V_HISTORY.REQ_DELIV_DATE AS "reqDelivDate.dateOfymd",
               V_HISTORY.ORDER_DELIV_DATE AS "orderDelivDate.dateOfymd",
               V_HISTORY.HOPE_CURRENCY_CD AS "hopeCurrencyCd",
               V_HISTORY.CURRENCY_CD AS "currencyCd",
               V_HISTORY.REQ_UNIT_PRICE AS "hopeUnitPrice.amount",
               V_HISTORY.REQ_AMOUNT AS "reqAmount.amount",
               V_HISTORY.ORDER_UNIT_PRICE AS "orderUnitPrice.amount",
               V_HISTORY.ORDER_AMOUNT AS "orderAmount.amount",
               V_HISTORY.TAX_IND AS "taxInd",
               V_HISTORY.CONSUMPT_IND AS "consumeInd",
               V_HISTORY.SUBJECT_CD AS "subjectCd",
               V_HISTORY.SUBJECT_NAME AS "subjectName",
               V_HISTORY.LOAD_SECTION_CD AS "loadSectionCd",
               V_HISTORY.LOAD_SECTION_NAME AS "loadSectionName",
               V_HISTORY.REQ_SECTION_CD AS "reqSectionCd",
               V_HISTORY.REQ_SECTION_NAME AS "reqSectionName",
               V_HISTORY.REQ_USER_ID AS "reqUserCd",
               V_HISTORY.REQ_USER_NAME AS "reqUserName",
               V_HISTORY.BUYER_SECTION_CD AS "purSectionCd",
               V_HISTORY.BUYER_SECTION_NAME AS "purSectionName",
               V_HISTORY.BUYER_USER_ID AS "purUserCd",
               V_HISTORY.BUYER_USER_NAME AS "purUserName",
               V_HISTORY.RECEIVE_STATUS_IND AS "statusInd.receiveStatus",
               V_HISTORY.ACCEPTANCE_STATUS_IND AS "statusInd.acceptanceStatus",
               V_HISTORY.INSPECT_STATUS_IND AS "statusInd.inspectStatus",
               V_HISTORY.SLIP_STATUS AS "slipStatus",
               T_RECEIVE.DELIV_VOL_TOTAL AS "delivVol.vol",
               T_QUOT_ACQ_APL.QUOT_ACQ_APL_STATUS AS "quotAcqAplStatus",
               T_QUOT_REQUEST.QUOT_REQ_SEQ AS quotReqSeqNo,
               T_DLV_EST.SEQCOUNT AS "count",<!-- DAIKO_KANEKO T_DLV_EST_MNG:納期管理の数は何に使うのか不明/削除した方がよい -->
               V_HISTORY.ORDER_SEQ AS "orderSeq",
               V_HISTORY.PUR_APL_SEQ AS "purAplSeq",
               V_HISTORY.APP_UNIT_NO AS "appUnitNo",
               T_QUOT_ACQ_APL.QUOT_ACQ_APL_SEQ AS "quotAcqAplSeqNo", <!-- 詳細画面用 2013.01.04 ADD DAIKO_KANEKO -->
               APPROVED_T_ARRIVAL.APPROVED_DELIV_VOL AS "approvedDelivVol.vol",
               V_HISTORY.ACCEPT_VOL AS "acceptVol.vol",
               V_HISTORY.ACCEPT_AMOUNT AS "acceptAmount.amount",
               V_HISTORY.RECEIVED_VOL AS "receivedVol.vol",
               V_HISTORY.ORD_EXT_TXT_1,
               V_HISTORY.ORD_EXT_TXT_2,
               V_HISTORY.ORD_EXT_TXT_3,
               V_HISTORY.ORD_EXT_TXT_4,
               V_HISTORY.ORD_EXT_TXT_5,
               V_HISTORY.ORD_EXT_TXT_6,
               V_HISTORY.ORD_EXT_TXT_7,
               V_HISTORY.ORD_EXT_TXT_8,
               V_HISTORY.ORD_EXT_TXT_9,
               V_HISTORY.ORD_EXT_TXT_10,
               V_HISTORY.ORD_EXT_AREA_1,
               V_HISTORY.ORD_EXT_AREA_2,
               V_HISTORY.ORD_EXT_AREA_3,
               V_HISTORY.ORD_EXT_AREA_4,
               V_HISTORY.ORD_EXT_AREA_5,
               V_HISTORY.ORD_EXT_DATE_1,
               V_HISTORY.ORD_EXT_DATE_2,
               V_HISTORY.ORD_EXT_DATE_3,
               V_HISTORY.ORD_EXT_DATE_4,
               V_HISTORY.ORD_EXT_DATE_5,
               V_HISTORY.ORD_EXT_INT_1,
               V_HISTORY.ORD_EXT_INT_2,
               V_HISTORY.ORD_EXT_INT_3,
               V_HISTORY.ORD_EXT_INT_4,
               V_HISTORY.ORD_EXT_INT_5,
               V_HISTORY.ORD_EXT_INT_6,
               V_HISTORY.ORD_EXT_INT_7,
               V_HISTORY.ORD_EXT_INT_8,
               V_HISTORY.ORD_EXT_INT_9,
               V_HISTORY.ORD_EXT_INT_10,
               V_HISTORY.ORD_EXT_DEC_1,
               V_HISTORY.ORD_EXT_DEC_2,
               V_HISTORY.ORD_EXT_DEC_3,
               V_HISTORY.ORD_EXT_DEC_4,
               V_HISTORY.ORD_EXT_DEC_5,
               V_HISTORY.ORD_EXT_SEL_1,
               V_HISTORY.ORD_EXT_SEL_2,
               V_HISTORY.ORD_EXT_SEL_3,
               V_HISTORY.ORD_EXT_SEL_4,
               V_HISTORY.ORD_EXT_SEL_5,
               V_HISTORY.ORD_EXT_SEL_6,
               V_HISTORY.ORD_EXT_SEL_7,
               V_HISTORY.ORD_EXT_SEL_8,
               V_HISTORY.ORD_EXT_SEL_9,
               V_HISTORY.ORD_EXT_SEL_10,
               V_HISTORY.ORD_EXT_CHK_1,
               V_HISTORY.ORD_EXT_CHK_2,
               V_HISTORY.ORD_EXT_CHK_3,
               V_HISTORY.ORD_EXT_CHK_4,
               V_HISTORY.ORD_EXT_CHK_5,
               V_HISTORY.ORD_EXT_FILE_1,
               V_HISTORY.ORD_EXT_FILE_2,
               V_HISTORY.ORD_EXT_FILE_3,
               V_HISTORY.ORD_EXT_MST_1,
               V_HISTORY.ORD_EXT_MST_2,
               V_HISTORY.ORD_EXT_MST_3,
               V_HISTORY.ORD_EXT_MST_4,
               V_HISTORY.ORD_EXT_MST_5,
               V_HISTORY.ORD_EXT_MST_6,
               V_HISTORY.ORD_EXT_MST_7,
               V_HISTORY.ORD_EXT_MST_8,
               V_HISTORY.ORD_EXT_MST_NAME_1,
               V_HISTORY.ORD_EXT_MST_NAME_2,
               V_HISTORY.ORD_EXT_MST_NAME_3,
               V_HISTORY.ORD_EXT_MST_NAME_4,
               V_HISTORY.ORD_EXT_MST_NAME_5,
               V_HISTORY.ORD_EXT_MST_NAME_6,
               V_HISTORY.ORD_EXT_MST_NAME_7,
               V_HISTORY.ORD_EXT_MST_NAME_8,
               V_HISTORY.APL_EXT_TXT_1,
               V_HISTORY.APL_EXT_TXT_2,
               V_HISTORY.APL_EXT_TXT_3,
               V_HISTORY.APL_EXT_TXT_4,
               V_HISTORY.APL_EXT_TXT_5,
               V_HISTORY.APL_EXT_TXT_6,
               V_HISTORY.APL_EXT_TXT_7,
               V_HISTORY.APL_EXT_TXT_8,
               V_HISTORY.APL_EXT_TXT_9,
               V_HISTORY.APL_EXT_TXT_10,
               V_HISTORY.APL_EXT_AREA_1,
               V_HISTORY.APL_EXT_AREA_2,
               V_HISTORY.APL_EXT_AREA_3,
               V_HISTORY.APL_EXT_AREA_4,
               V_HISTORY.APL_EXT_AREA_5,
               V_HISTORY.APL_EXT_DATE_1,
               V_HISTORY.APL_EXT_DATE_2,
               V_HISTORY.APL_EXT_DATE_3,
               V_HISTORY.APL_EXT_DATE_4,
               V_HISTORY.APL_EXT_DATE_5,
               V_HISTORY.APL_EXT_INT_1,
               V_HISTORY.APL_EXT_INT_2,
               V_HISTORY.APL_EXT_INT_3,
               V_HISTORY.APL_EXT_INT_4,
               V_HISTORY.APL_EXT_INT_5,
               V_HISTORY.APL_EXT_INT_6,
               V_HISTORY.APL_EXT_INT_7,
               V_HISTORY.APL_EXT_INT_8,
               V_HISTORY.APL_EXT_INT_9,
               V_HISTORY.APL_EXT_INT_10,
               V_HISTORY.APL_EXT_DEC_1,
               V_HISTORY.APL_EXT_DEC_2,
               V_HISTORY.APL_EXT_DEC_3,
               V_HISTORY.APL_EXT_DEC_4,
               V_HISTORY.APL_EXT_DEC_5,
               V_HISTORY.APL_EXT_SEL_1,
               V_HISTORY.APL_EXT_SEL_2,
               V_HISTORY.APL_EXT_SEL_3,
               V_HISTORY.APL_EXT_SEL_4,
               V_HISTORY.APL_EXT_SEL_5,
               V_HISTORY.APL_EXT_SEL_6,
               V_HISTORY.APL_EXT_SEL_7,
               V_HISTORY.APL_EXT_SEL_8,
               V_HISTORY.APL_EXT_SEL_9,
               V_HISTORY.APL_EXT_SEL_10,
               V_HISTORY.APL_EXT_CHK_1,
               V_HISTORY.APL_EXT_CHK_2,
               V_HISTORY.APL_EXT_CHK_3,
               V_HISTORY.APL_EXT_CHK_4,
               V_HISTORY.APL_EXT_CHK_5,
               V_HISTORY.APL_EXT_FILE_1,
               V_HISTORY.APL_EXT_FILE_2,
               V_HISTORY.APL_EXT_FILE_3,
               V_HISTORY.APL_EXT_MST_1,
               V_HISTORY.APL_EXT_MST_2,
               V_HISTORY.APL_EXT_MST_3,
               V_HISTORY.APL_EXT_MST_4,
               V_HISTORY.APL_EXT_MST_5,
               V_HISTORY.APL_EXT_MST_6,
               V_HISTORY.APL_EXT_MST_7,
               V_HISTORY.APL_EXT_MST_8,
               V_HISTORY.APL_EXT_MST_NAME_1,
               V_HISTORY.APL_EXT_MST_NAME_2,
               V_HISTORY.APL_EXT_MST_NAME_3,
               V_HISTORY.APL_EXT_MST_NAME_4,
               V_HISTORY.APL_EXT_MST_NAME_5,
               V_HISTORY.APL_EXT_MST_NAME_6,
               V_HISTORY.APL_EXT_MST_NAME_7,
               V_HISTORY.APL_EXT_MST_NAME_8,
               V_HISTORY.REQ_EXT_TXT_1,
               V_HISTORY.REQ_EXT_TXT_2,
               V_HISTORY.REQ_EXT_TXT_3,
               V_HISTORY.REQ_EXT_TXT_4,
               V_HISTORY.REQ_EXT_TXT_5,
               V_HISTORY.REQ_EXT_TXT_6,
               V_HISTORY.REQ_EXT_TXT_7,
               V_HISTORY.REQ_EXT_TXT_8,
               V_HISTORY.REQ_EXT_TXT_9,
               V_HISTORY.REQ_EXT_TXT_10,
               V_HISTORY.REQ_EXT_AREA_1,
               V_HISTORY.REQ_EXT_AREA_2,
               V_HISTORY.REQ_EXT_AREA_3,
               V_HISTORY.REQ_EXT_AREA_4,
               V_HISTORY.REQ_EXT_AREA_5,
               V_HISTORY.REQ_EXT_DATE_1,
               V_HISTORY.REQ_EXT_DATE_2,
               V_HISTORY.REQ_EXT_DATE_3,
               V_HISTORY.REQ_EXT_DATE_4,
               V_HISTORY.REQ_EXT_DATE_5,
               V_HISTORY.REQ_EXT_INT_1,
               V_HISTORY.REQ_EXT_INT_2,
               V_HISTORY.REQ_EXT_INT_3,
               V_HISTORY.REQ_EXT_INT_4,
               V_HISTORY.REQ_EXT_INT_5,
               V_HISTORY.REQ_EXT_INT_6,
               V_HISTORY.REQ_EXT_INT_7,
               V_HISTORY.REQ_EXT_INT_8,
               V_HISTORY.REQ_EXT_INT_9,
               V_HISTORY.REQ_EXT_INT_10,
               V_HISTORY.REQ_EXT_DEC_1,
               V_HISTORY.REQ_EXT_DEC_2,
               V_HISTORY.REQ_EXT_DEC_3,
               V_HISTORY.REQ_EXT_DEC_4,
               V_HISTORY.REQ_EXT_DEC_5,
               V_HISTORY.REQ_EXT_SEL_1,
               V_HISTORY.REQ_EXT_SEL_2,
               V_HISTORY.REQ_EXT_SEL_3,
               V_HISTORY.REQ_EXT_SEL_4,
               V_HISTORY.REQ_EXT_SEL_5,
               V_HISTORY.REQ_EXT_SEL_6,
               V_HISTORY.REQ_EXT_SEL_7,
               V_HISTORY.REQ_EXT_SEL_8,
               V_HISTORY.REQ_EXT_SEL_9,
               V_HISTORY.REQ_EXT_SEL_10,
               V_HISTORY.REQ_EXT_CHK_1,
               V_HISTORY.REQ_EXT_CHK_2,
               V_HISTORY.REQ_EXT_CHK_3,
               V_HISTORY.REQ_EXT_CHK_4,
               V_HISTORY.REQ_EXT_CHK_5,
               V_HISTORY.REQ_EXT_FILE_1,
               V_HISTORY.REQ_EXT_FILE_2,
               V_HISTORY.REQ_EXT_FILE_3,
               V_HISTORY.REQ_EXT_MST_1,
               V_HISTORY.REQ_EXT_MST_2,
               V_HISTORY.REQ_EXT_MST_3,
               V_HISTORY.REQ_EXT_MST_4,
               V_HISTORY.REQ_EXT_MST_5,
               V_HISTORY.REQ_EXT_MST_6,
               V_HISTORY.REQ_EXT_MST_7,
               V_HISTORY.REQ_EXT_MST_8,
               V_HISTORY.REQ_EXT_MST_NAME_1,
               V_HISTORY.REQ_EXT_MST_NAME_2,
               V_HISTORY.REQ_EXT_MST_NAME_3,
               V_HISTORY.REQ_EXT_MST_NAME_4,
               V_HISTORY.REQ_EXT_MST_NAME_5,
               V_HISTORY.REQ_EXT_MST_NAME_6,
               V_HISTORY.REQ_EXT_MST_NAME_7,
               V_HISTORY.REQ_EXT_MST_NAME_8
          FROM V_HISTORY
          <!-- 多明細伝票で自動見積された際の見積と紐づけるために伝票番号と見積依頼番号を紐づける -->
          LEFT JOIN T_QUOT_REQUEST
          ON        (T_QUOT_REQUEST.QUOT_REQ_NO = V_HISTORY.PUR_APL_NO
          OR        T_QUOT_REQUEST.QUOT_REQ_NO = V_HISTORY.SLIP_NO)
          AND       T_QUOT_REQUEST.QUOT_TYPE_IND IN ('1','4')
          AND       T_QUOT_REQUEST.NEW_FLG = '1'
          AND       T_QUOT_REQUEST.DELETE_FLG = '0'
         LEFT JOIN T_QUOT_ACQ_APL
            ON T_QUOT_ACQ_APL.QUOT_ACQ_APL_NO = V_HISTORY.PUR_APL_NO
            AND T_QUOT_ACQ_APL.NEW_FLG = '1'
            AND T_QUOT_ACQ_APL.DELETE_FLG = '0'
         <!-- DAIKO_KANEKO TEST1:T_DLV_EST_MNG:納期管理の数は何に使うのか不明/削除した方がよい -->
         LEFT JOIN ( SELECT ORDER_NO, COUNT(DELIV_MNG_SEQ)AS SEQCOUNT FROM T_DLV_EST_MNG
                     WHERE T_DLV_EST_MNG.INQ_RESP_IND = '2'
                           AND T_DLV_EST_MNG.DELETE_FLG = '0'
                        GROUP BY ORDER_NO) T_DLV_EST
             ON T_DLV_EST.ORDER_NO = V_HISTORY.ORDER_NO
         LEFT JOIN ( SELECT ORDER_NO, SUM(DELIV_VOL)AS DELIV_VOL_TOTAL FROM T_RECEIVE_MNG
                     WHERE T_RECEIVE_MNG.DELETE_FLG = '0'
                        GROUP BY ORDER_NO) T_RECEIVE
             ON T_RECEIVE.ORDER_NO = V_HISTORY.ORDER_NO
         LEFT JOIN 
                (SELECT T_ARRIVAL.ORDER_NO, SUM(T_ARRIVAL.DELIV_VOL) APPROVED_DELIV_VOL
                 FROM T_ARRIVAL
                 INNER JOIN T_RECEIVE_MNG
                  ON T_ARRIVAL.ARRIVAL_SEQ = T_RECEIVE_MNG.APP_ARRIVAL_SEQ
                 WHERE T_ARRIVAL.DELETE_FLG = '0'
                  AND T_ARRIVAL.RB_IND = '0'
                  AND T_RECEIVE_MNG.DELETE_FLG = '0'
                 GROUP BY T_ARRIVAL.ORDER_NO) APPROVED_T_ARRIVAL
                ON APPROVED_T_ARRIVAL.ORDER_NO = V_HISTORY.ORDER_NO
         <where> V_HISTORY.SLIP_NO IN
         <foreach collection="searchCondition.page.keyDomainEntityList" item="keyList"  open="(" separator="," close=")">  
                 #{keyList.slipNo, jdbcType=VARCHAR}
         </foreach>
         <include refid="listKeyIdentityWhereCondition"/>
         </where>
        ORDER BY ${searchCondition.columnOrder.columnOrder()}
    </select>
</mapper>