<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="ps.dataaccess.pur.req.ReqAllMapper">
    <resultMap type="fw.domain.slip.purreq.everypurreq.EveryPurReqApl" id="PurApl_Map">
        <id column="PUR_APL_NO" property="purAplManagement.purAplIdentify.purAplNo.purAplNo"/>
        <id column="URGENT_IND" property="purAplManagement.urgentInd.urgentInd"/>
        <id column="PUR_APL_STATUS" property="purAplManagement.status"/>
        <id column="PUR_REQ_DATE" property="purAplManagement.purReqDate.purReqDate.reqDate.dateOfymd"/>
        <id column="TITLE_NAME" property="purAplManagement.titleName.titleName"/>
        <id column="INPUT_COMPANY_CD" property="purAplManagement.inputUser.inputUser.section.company.companyCd"/>
        <id column="INPUT_SECTION_CD" property="purAplManagement.inputUser.inputUser.section.sectionCd"/>
        <id column="INPUT_SECTION_NAME" property="purAplManagement.inputUser.inputUser.section.sectionName"/>
        <id column="INPUT_USER_ID" property="purAplManagement.inputUser.inputUser.userID"/>
        <id column="INPUT_USER_NAME" property="purAplManagement.inputUser.inputUser.userName"/>
        <id column="REQ_COMPANY_CD" property="purAplManagement.reqUser.reqUser.section.company.companyCd"/>
        <id column="REQ_SECTION_CD" property="purAplManagement.reqUser.reqUser.section.sectionCd"/>
        <id column="REQ_SECTION_NAME" property="purAplManagement.reqUser.reqUser.section.sectionName"/>
        <id column="REQ_USER_EXTENSION_NO" property="purAplManagement.reqUser.reqUser.extNo.extensionNo"/>
        <id column="REQ_USER_TEL_NO" property="purAplManagement.reqUser.reqUser.externalNo.externalNo"/>
        <id column="REQ_USER_ID" property="purAplManagement.reqUser.reqUser.userID"/>
        <id column="REQ_USER_NAME" property="purAplManagement.reqUser.reqUser.userName"/>
        <id column="BACK_APP_COMMENTS" property="purAplManagement.appManagement.backApp.backAppReason.backReason.comment"/>
        <id column="LOAD_SECTION_CD" property="purAplManagement.loadSection.loadSection.sectionCd"/>
        <id column="LOAD_SECTION_NAME" property="purAplManagement.loadSection.loadSection.sectionName"/>
        <id column="DELIV_PLACE_CD" property="purAplManagement.delivPlace.delivPlaceCd"/>
        <id column="DELIV_PLACE_NAME" property="purAplManagement.delivPlace.delivPlaceName"/>
        <id column="HOPE_SUPPLIER_CD" property="purAplManagement.hopeSupplier.hopeSupplier.supCd"/>
        <id column="HOPE_SUPPLIER_ABBR_NAME" property="purAplManagement.hopeSupplier.hopeSupplier.supplierName.supplierAbbrName"/>
        <id column="HOPE_SUPPLIER_COMPANY_CD" property="purAplManagement.hopeSupplier.hopeSupplier.supCompanyCd"/>
        <id column="ITEM_CLASS_L_NAME" property="purAplManagement.itemKind.itemClassLName"/>
        <id column="ITEM_CLASS_M_NAME" property="purAplManagement.itemKind.itemClassMName"/>
        <id column="ITEM_CLASS_S_NAME" property="purAplManagement.itemKind.itemClassSName"/>
        <id column="ITEM_CLASS_L" property="purAplManagement.itemKind.itemClassL"/>
        <id column="ITEM_CLASS_M" property="purAplManagement.itemKind.itemClassM"/>
        <id column="ITEM_CLASS_S" property="purAplManagement.itemKind.itemClassS"/>
        <id column="PRICE_REQ_FLG" property="purAplManagement.priceRegisterFlg.priceRegisterFlg"/>
        <id column="BUDGET_NO" property="purAplManagement.budgetNumber.budgetNumber"/>
        <id column="BUDGET_NAME" property="purAplManagement.budgetNumber.titleName.titleName"/>
        <id column="ATTACH_FILE_NAME_A" property="purAplManagement.rangeByAttachFile1.attachFile.fileName"/>
        <id column="ATTACH_SCOPE_A" property="purAplManagement.rangeByAttachFile1.attachRange.attachRange"/>
        <id column="ATTACH_FILE_NAME_B" property="purAplManagement.rangeByAttachFile2.attachFile.fileName"/>
        <id column="ATTACH_SCOPE_B" property="purAplManagement.rangeByAttachFile2.attachRange.attachRange"/>
        <id column="FOR_BOSS_COMMENT" property="purAplManagement.forAppComment.forAppComment.comment"/>
        <id column="FOR_BUYER_COMMENT" property="purAplManagement.forBuyerComment.forBuyerComment.comment"/>
        <id column="FOR_SUPPRIER_COMMENT" property="purAplManagement.forSupplierComment.forSupplierComment.comment"/>
        <id column="APP_ROUTE_NAME" property="application.approute.appRouteName"/>
        <id column="APP_ROUTE_NO" property="application.approute.appRouteNo"/>
        <id column="ATTACH_FILE_SEQ1" property="purAplManagement.rangeByAttachFile1.attachFile.seqNo"/>
        <id column="ATTACH_FILE_SEQ2" property="purAplManagement.rangeByAttachFile2.attachFile.seqNo"/>
        <id column="EXT_TXT_1" property="purAplManagement.detailExtItem.extendTxt.extendTxt1" />
        <id column="EXT_TXT_2" property="purAplManagement.detailExtItem.extendTxt.extendTxt2" />
        <id column="EXT_TXT_3" property="purAplManagement.detailExtItem.extendTxt.extendTxt3" />
        <id column="EXT_TXT_4" property="purAplManagement.detailExtItem.extendTxt.extendTxt4" />
        <id column="EXT_TXT_5" property="purAplManagement.detailExtItem.extendTxt.extendTxt5" />
        <id column="EXT_TXT_6" property="purAplManagement.detailExtItem.extendTxt.extendTxt6" />
        <id column="EXT_TXT_7" property="purAplManagement.detailExtItem.extendTxt.extendTxt7" />
        <id column="EXT_TXT_8" property="purAplManagement.detailExtItem.extendTxt.extendTxt8" />
        <id column="EXT_TXT_9" property="purAplManagement.detailExtItem.extendTxt.extendTxt9" />
        <id column="EXT_TXT_10" property="purAplManagement.detailExtItem.extendTxt.extendTxt10" />
        <id column="EXT_AREA_1" property="purAplManagement.detailExtItem.extendArea.extendArea1" />
        <id column="EXT_AREA_2" property="purAplManagement.detailExtItem.extendArea.extendArea2" />
        <id column="EXT_AREA_3" property="purAplManagement.detailExtItem.extendArea.extendArea3" />
        <id column="EXT_AREA_4" property="purAplManagement.detailExtItem.extendArea.extendArea4" />
        <id column="EXT_AREA_5" property="purAplManagement.detailExtItem.extendArea.extendArea5" />
        <id column="EXT_DATE_1" property="purAplManagement.detailExtItem.extendDate.extendDate1.dateOfymd" />
        <id column="EXT_DATE_2" property="purAplManagement.detailExtItem.extendDate.extendDate2.dateOfymd" />
        <id column="EXT_DATE_3" property="purAplManagement.detailExtItem.extendDate.extendDate3.dateOfymd" />
        <id column="EXT_DATE_4" property="purAplManagement.detailExtItem.extendDate.extendDate4.dateOfymd" />
        <id column="EXT_DATE_5" property="purAplManagement.detailExtItem.extendDate.extendDate5.dateOfymd" />
        <id column="EXT_INT_1" property="purAplManagement.detailExtItem.extendInt.extendInt1.value" />
        <id column="EXT_INT_2" property="purAplManagement.detailExtItem.extendInt.extendInt2.value" />
        <id column="EXT_INT_3" property="purAplManagement.detailExtItem.extendInt.extendInt3.value" />
        <id column="EXT_INT_4" property="purAplManagement.detailExtItem.extendInt.extendInt4.value" />
        <id column="EXT_INT_5" property="purAplManagement.detailExtItem.extendInt.extendInt5.value" />
        <id column="EXT_INT_6" property="purAplManagement.detailExtItem.extendInt.extendInt6.value" />
        <id column="EXT_INT_7" property="purAplManagement.detailExtItem.extendInt.extendInt7.value" />
        <id column="EXT_INT_8" property="purAplManagement.detailExtItem.extendInt.extendInt8.value" />
        <id column="EXT_INT_9" property="purAplManagement.detailExtItem.extendInt.extendInt9.value" />
        <id column="EXT_INT_10" property="purAplManagement.detailExtItem.extendInt.extendInt10.value" />
        <id column="EXT_DEC_1" property="purAplManagement.detailExtItem.extendDec.extendDec1.value" />
        <id column="EXT_DEC_2" property="purAplManagement.detailExtItem.extendDec.extendDec2.value" />
        <id column="EXT_DEC_3" property="purAplManagement.detailExtItem.extendDec.extendDec3.value" />
        <id column="EXT_DEC_4" property="purAplManagement.detailExtItem.extendDec.extendDec4.value" />
        <id column="EXT_DEC_5" property="purAplManagement.detailExtItem.extendDec.extendDec5.value" />
        <id column="EXT_SEL_1" property="purAplManagement.detailExtItem.extendSel.extendSel1" />
        <id column="EXT_SEL_2" property="purAplManagement.detailExtItem.extendSel.extendSel2" />
        <id column="EXT_SEL_3" property="purAplManagement.detailExtItem.extendSel.extendSel3" />
        <id column="EXT_SEL_4" property="purAplManagement.detailExtItem.extendSel.extendSel4" />
        <id column="EXT_SEL_5" property="purAplManagement.detailExtItem.extendSel.extendSel5" />
        <id column="EXT_SEL_6" property="purAplManagement.detailExtItem.extendSel.extendSel6" />
        <id column="EXT_SEL_7" property="purAplManagement.detailExtItem.extendSel.extendSel7" />
        <id column="EXT_SEL_8" property="purAplManagement.detailExtItem.extendSel.extendSel8" />
        <id column="EXT_SEL_9" property="purAplManagement.detailExtItem.extendSel.extendSel9" />
        <id column="EXT_SEL_10" property="purAplManagement.detailExtItem.extendSel.extendSel10" />
        <id column="EXT_CHK_1" property="purAplManagement.detailExtItem.extendChk.extendChk1" />
        <id column="EXT_CHK_2" property="purAplManagement.detailExtItem.extendChk.extendChk2" />
        <id column="EXT_CHK_3" property="purAplManagement.detailExtItem.extendChk.extendChk3" />
        <id column="EXT_CHK_4" property="purAplManagement.detailExtItem.extendChk.extendChk4" />
        <id column="EXT_CHK_5" property="purAplManagement.detailExtItem.extendChk.extendChk5" />
        <id column="EXT_FILE_1" property="purAplManagement.detailExtItem.extendFile.extendFile1.fileName" />
        <id column="EXT_FILE_2" property="purAplManagement.detailExtItem.extendFile.extendFile2.fileName" />
        <id column="EXT_FILE_3" property="purAplManagement.detailExtItem.extendFile.extendFile3.fileName" />
        <id column="EXT_FILE_BINARY_1" property="purAplManagement.detailExtItem.extendFile.extendFile1.binary" />
        <id column="EXT_FILE_BINARY_2" property="purAplManagement.detailExtItem.extendFile.extendFile2.binary" />
        <id column="EXT_FILE_BINARY_3" property="purAplManagement.detailExtItem.extendFile.extendFile3.binary" />
        <id column="EXT_MST_1" property="purAplManagement.detailExtItem.extendMst.extendMst1.mstKey" />
        <id column="EXT_MST_2" property="purAplManagement.detailExtItem.extendMst.extendMst2.mstKey" />
        <id column="EXT_MST_3" property="purAplManagement.detailExtItem.extendMst.extendMst3.mstKey" />
        <id column="EXT_MST_4" property="purAplManagement.detailExtItem.extendMst.extendMst4.mstKey" />
        <id column="EXT_MST_5" property="purAplManagement.detailExtItem.extendMst.extendMst5.mstKey" />
        <id column="EXT_MST_6" property="purAplManagement.detailExtItem.extendMst.extendMst6.mstKey" />
        <id column="EXT_MST_7" property="purAplManagement.detailExtItem.extendMst.extendMst7.mstKey" />
        <id column="EXT_MST_8" property="purAplManagement.detailExtItem.extendMst.extendMst8.mstKey" />
        <id column="EXT_MST_NAME_1" property="purAplManagement.detailExtItem.extendMst.extendMst1.mstName" />
        <id column="EXT_MST_NAME_2" property="purAplManagement.detailExtItem.extendMst.extendMst2.mstName" />
        <id column="EXT_MST_NAME_3" property="purAplManagement.detailExtItem.extendMst.extendMst3.mstName" />
        <id column="EXT_MST_NAME_4" property="purAplManagement.detailExtItem.extendMst.extendMst4.mstName" />
        <id column="EXT_MST_NAME_5" property="purAplManagement.detailExtItem.extendMst.extendMst5.mstName" />
        <id column="EXT_MST_NAME_6" property="purAplManagement.detailExtItem.extendMst.extendMst6.mstName" />
        <id column="EXT_MST_NAME_7" property="purAplManagement.detailExtItem.extendMst.extendMst7.mstName" />
        <id column="EXT_MST_NAME_8" property="purAplManagement.detailExtItem.extendMst.extendMst8.mstName" />
    </resultMap>

    <select id="getPurApl"  resultMap="PurApl_Map">
        SELECT 
            T_PUR_APL.PUR_APL_NO,
            T_PUR_APL.URGENT_IND,
            T_PUR_APL.PUR_APL_STATUS,
            T_PUR_APL.PUR_REQ_DATE,
            T_PUR_APL.TITLE_NAME,
            T_PUR_APL.INPUT_COMPANY_CD,
            T_PUR_APL.INPUT_SECTION_CD,
            T_PUR_APL.INPUT_SECTION_NAME,
            T_PUR_APL.INPUT_USER_ID,
            T_PUR_APL.INPUT_USER_NAME,
            T_PUR_APL.REQ_COMPANY_CD,
            T_PUR_APL.REQ_SECTION_CD,
            T_PUR_APL.REQ_SECTION_NAME,
            T_PUR_APL.REQ_USER_EXTENSION_NO,
            T_PUR_APL.REQ_USER_TEL_NO,
            T_PUR_APL.REQ_USER_ID,
            T_PUR_APL.REQ_USER_NAME,
            T_APPROVAL.BACK_APP_COMMENTS,
            T_PUR_APL.LOAD_SECTION_CD,
            T_PUR_APL.LOAD_SECTION_NAME,
            T_PUR_APL.DELIV_PLACE_CD,
            T_PUR_APL.DELIV_PLACE_NAME,
            T_PUR_APL.ITEM_CLASS_L_NAME,
            T_PUR_APL.ITEM_CLASS_M_NAME,
            T_PUR_APL.ITEM_CLASS_S_NAME,
            T_PUR_APL.ITEM_CLASS_L,
            T_PUR_APL.ITEM_CLASS_M,
            T_PUR_APL.ITEM_CLASS_S,
            T_PUR_APL.HOPE_SUPPLIER_CD,
            T_PUR_APL.HOPE_SUPPLIER_ABBR_NAME,
            T_PUR_APL.HOPE_SUPPLIER_COMPANY_CD,
            T_PUR_APL.PRICE_REQ_FLG,
            T_PUR_APL.BUDGET_NO,
            T_RINGI_BUDGET_DTL.BUDGET_NAME ,
            T_ATTACH_MNG_A.ATTACH_FILE_NAME AS ATTACH_FILE_NAME_A,
            T_ATTACH_MNG_A.ATTACH_SCOPE AS ATTACH_SCOPE_A,
            T_ATTACH_MNG_B.ATTACH_FILE_NAME AS ATTACH_FILE_NAME_B,
            T_ATTACH_MNG_B.ATTACH_SCOPE AS ATTACH_SCOPE_B,
            T_PUR_APL.FOR_BOSS_COMMENT,
            T_PUR_APL.FOR_BUYER_COMMENT,
            T_PUR_APL.FOR_SUPPRIER_COMMENT,
            T_PUR_APL.APP_ROUTE_NAME,
            T_PUR_APL.APP_ROUTE_NO,
            T_PUR_APL.ATTACH_FILE_SEQ1,
            T_PUR_APL.ATTACH_FILE_SEQ2,
            ${@ps.common.util.ItemSettingUtil@getItemSettingSelectSQL("T_PUR_APL")}
        FROM T_PUR_APL
        LEFT JOIN T_ATTACH_MNG T_ATTACH_MNG_A 
            ON T_PUR_APL.ATTACH_FILE_SEQ1 = T_ATTACH_MNG_A.ATTACH_FILE_SEQ
            AND T_ATTACH_MNG_A.DELETE_FLG = '0'
        LEFT JOIN T_ATTACH_MNG T_ATTACH_MNG_B 
            ON T_PUR_APL.ATTACH_FILE_SEQ2 = T_ATTACH_MNG_B.ATTACH_FILE_SEQ
            AND T_ATTACH_MNG_B.DELETE_FLG = '0'
        LEFT JOIN T_APPROVAL 
            ON T_PUR_APL.PUR_APL_SEQ = T_APPROVAL.APP_VOUCHER_KEY
            AND T_APPROVAL.APP_VOUCHER_IND = '1'
            AND T_APPROVAL.APP_ROUTE_NO = T_PUR_APL.APP_ROUTE_NO
        LEFT JOIN T_RINGI_BUDGET_DTL
            ON T_RINGI_BUDGET_DTL.COMPANY_CD = T_PUR_APL.LOAD_COMPANY_CD
            AND T_RINGI_BUDGET_DTL.SECTION_PLACE_CD = T_PUR_APL.LOAD_SECTION_PLACE_CD
            AND T_RINGI_BUDGET_DTL.BUDGET_DTL_NO = T_PUR_APL.BUDGET_NO
        WHERE T_PUR_APL.PUR_APL_SEQ = #{purAplSeq}
            AND T_PUR_APL.NEW_FLG = '1'
            AND T_PUR_APL.DELETE_FLG = '0'
        UNION ALL
        SELECT T_PUR_APL.PUR_APL_NO,
            T_PUR_APL.URGENT_IND,
            T_PUR_APL.PUR_APL_STATUS,
            T_PUR_APL.PUR_REQ_DATE,
            T_PUR_APL.TITLE_NAME,
            T_PUR_APL.INPUT_COMPANY_CD,
            T_PUR_APL.INPUT_SECTION_CD,
            T_PUR_APL.INPUT_SECTION_NAME,
            T_PUR_APL.INPUT_USER_ID,
            T_PUR_APL.INPUT_USER_NAME,
            T_PUR_APL.REQ_COMPANY_CD,
            T_PUR_APL.REQ_SECTION_CD,
            T_PUR_APL.REQ_SECTION_NAME,
            T_PUR_APL.REQ_USER_EXTENSION_NO,
            T_PUR_APL.REQ_USER_TEL_NO,
            T_PUR_APL.REQ_USER_ID,
            T_PUR_APL.REQ_USER_NAME,
            T_APPROVAL.BACK_APP_COMMENTS,
            T_PUR_APL.LOAD_SECTION_CD,
            T_PUR_APL.LOAD_SECTION_NAME,
            T_PUR_APL.DELIV_PLACE_CD,
            T_PUR_APL.DELIV_PLACE_NAME,
            T_PUR_APL.ITEM_CLASS_L_NAME,
            T_PUR_APL.ITEM_CLASS_M_NAME,
            T_PUR_APL.ITEM_CLASS_S_NAME,
            T_PUR_APL.ITEM_CLASS_L,
            T_PUR_APL.ITEM_CLASS_M,
            T_PUR_APL.ITEM_CLASS_S,
            T_PUR_APL.HOPE_SUPPLIER_CD,
            T_PUR_APL.HOPE_SUPPLIER_ABBR_NAME,
            T_PUR_APL.HOPE_SUPPLIER_COMPANY_CD,
            T_PUR_APL.PRICE_REQ_FLG,
            T_PUR_APL.BUDGET_NO,
            T_RINGI_BUDGET_DTL.BUDGET_NAME ,
            T_ATTACH_MNG_A.ATTACH_FILE_NAME AS ATTACH_FILE_NAME_A,
            T_ATTACH_MNG_A.ATTACH_SCOPE AS ATTACH_SCOPE_A,
            T_ATTACH_MNG_B.ATTACH_FILE_NAME AS ATTACH_FILE_NAME_B,
            T_ATTACH_MNG_B.ATTACH_SCOPE AS ATTACH_SCOPE_B,
            T_PUR_APL.FOR_BOSS_COMMENT,
            T_PUR_APL.FOR_BUYER_COMMENT,
            T_PUR_APL.FOR_SUPPRIER_COMMENT,
            T_PUR_APL.APP_ROUTE_NAME,
            T_PUR_APL.APP_ROUTE_NO,
            T_PUR_APL.ATTACH_FILE_SEQ1,
            T_PUR_APL.ATTACH_FILE_SEQ2,
            ${@ps.common.util.ItemSettingUtil@getItemSettingSelectSQL("T_PUR_APL")}
        FROM H_PUR_APL T_PUR_APL
        LEFT JOIN H_ATTACH_MNG T_ATTACH_MNG_A 
            ON T_PUR_APL.ATTACH_FILE_SEQ1 = T_ATTACH_MNG_A.ATTACH_FILE_SEQ
            AND T_ATTACH_MNG_A.DELETE_FLG = '0'
        LEFT JOIN H_ATTACH_MNG T_ATTACH_MNG_B 
            ON T_PUR_APL.ATTACH_FILE_SEQ2 = T_ATTACH_MNG_B.ATTACH_FILE_SEQ
            AND T_ATTACH_MNG_B.DELETE_FLG = '0'
        LEFT JOIN H_APPROVAL T_APPROVAL 
            ON T_PUR_APL.PUR_APL_SEQ = T_APPROVAL.APP_VOUCHER_KEY
            AND T_APPROVAL.APP_VOUCHER_IND = '1'
            AND T_APPROVAL.APP_ROUTE_NO = T_PUR_APL.APP_ROUTE_NO
        LEFT JOIN T_RINGI_BUDGET_DTL 
            ON T_RINGI_BUDGET_DTL.COMPANY_CD = T_PUR_APL.LOAD_COMPANY_CD
            AND T_RINGI_BUDGET_DTL.SECTION_PLACE_CD = T_PUR_APL.LOAD_SECTION_PLACE_CD
            AND T_RINGI_BUDGET_DTL.BUDGET_DTL_NO = T_PUR_APL.BUDGET_NO
        WHERE T_PUR_APL.PUR_APL_SEQ = #{purAplSeq}
            AND T_PUR_APL.NEW_FLG = '1'
            AND T_PUR_APL.DELETE_FLG = '0'
    </select>

    <resultMap type="fw.domain.slip.purreq.everypurreq.EveryPurReq" id="PurRequest_Map">
        <id column="SUBJECT_CD" property="subject.subjectCd"/>
        <id column="SUBJECT_NAME" property="subject.subjectName"/>
        <id column="ITEM_CD" property="itemName.itemCd"/>
        <id column="ITEM_NAME" property="itemName.itemName"/>
        <id column="KATASHIKI" property="itemName.katashiki"/>
        <id column="MANUFACT_CD" property="itemName.manufact.manufactCd"/>
        <id column="MANUFACT_NAME" property="itemName.manufact.manufactName"/>
        <id column="INSPECT_IND" property="inspectInd.inspectInd"/>
        <id column="REQ_DELIV_DATE" property="hopeDlvEst.hopeDlvEst.dateOfymd"/>
        <id column="CURRENCY_CD" property="amountMng.currency.currencyCd"/>
        <id column="CURRENCY_MARK" property="amountMng.currency.currencyMark"/>
        <id column="UNIT_PRICE" property="hopePrice.hopePrice.amount"/>
        <id column="REQ_VOL" property="vol.vol"/>
        <id column="UNIT_NAME" property="itemName.unit.unitName"/>
        <id column="REQ_AMOUNT" property="amountMng.totalAmount.totalAmount.amount"/>
        <id column="TAX_IND" property="amountMng.taxCalculationInd.taxInd.taxInd"/>
        <id column="ATTACH_FILE_NAME" property="rangeByAttachFile.attachFile.fileName"/>
        <id column="ATTACH_FILE_SEQ" property="rangeByAttachFile.attachFile.seqNo"/>
        <id column="ATTACH_SCOPE" property="rangeByAttachFile.attachRange.attachRange"/>
        <id column="BUYER_COMPANY_CD" property="buyUser.buyUser.section.company.companyCd"/>
        <id column="BUYER_SECTION_CD" property="buyUser.buyUser.section.sectionCd"/>
        <id column="BUYER_BACK_USER_COMMENTS" property="purReturnUser.backReason.backReason.comment"/>
        <id column="BUYER_SECTION_NAME" property="buyUser.buyUser.section.sectionName"/>
        <id column="BUYER_USER_ID" property="buyUser.buyUser.userID"/>
        <id column="BUYER_USER_NAME" property="buyUser.buyUser.userName"/>
        <id column="EXT_TXT_1" property="detailExtItem.extendTxt.extendTxt1" />
        <id column="EXT_TXT_2" property="detailExtItem.extendTxt.extendTxt2" />
        <id column="EXT_TXT_3" property="detailExtItem.extendTxt.extendTxt3" />
        <id column="EXT_TXT_4" property="detailExtItem.extendTxt.extendTxt4" />
        <id column="EXT_TXT_5" property="detailExtItem.extendTxt.extendTxt5" />
        <id column="EXT_TXT_6" property="detailExtItem.extendTxt.extendTxt6" />
        <id column="EXT_TXT_7" property="detailExtItem.extendTxt.extendTxt7" />
        <id column="EXT_TXT_8" property="detailExtItem.extendTxt.extendTxt8" />
        <id column="EXT_TXT_9" property="detailExtItem.extendTxt.extendTxt9" />
        <id column="EXT_TXT_10" property="detailExtItem.extendTxt.extendTxt10" />
        <id column="EXT_AREA_1" property="detailExtItem.extendArea.extendArea1" />
        <id column="EXT_AREA_2" property="detailExtItem.extendArea.extendArea2" />
        <id column="EXT_AREA_3" property="detailExtItem.extendArea.extendArea3" />
        <id column="EXT_AREA_4" property="detailExtItem.extendArea.extendArea4" />
        <id column="EXT_AREA_5" property="detailExtItem.extendArea.extendArea5" />
        <id column="EXT_DATE_1" property="detailExtItem.extendDate.extendDate1.dateOfymd" />
        <id column="EXT_DATE_2" property="detailExtItem.extendDate.extendDate2.dateOfymd" />
        <id column="EXT_DATE_3" property="detailExtItem.extendDate.extendDate3.dateOfymd" />
        <id column="EXT_DATE_4" property="detailExtItem.extendDate.extendDate4.dateOfymd" />
        <id column="EXT_DATE_5" property="detailExtItem.extendDate.extendDate5.dateOfymd" />
        <id column="EXT_INT_1" property="detailExtItem.extendInt.extendInt1.value" />
        <id column="EXT_INT_2" property="detailExtItem.extendInt.extendInt2.value" />
        <id column="EXT_INT_3" property="detailExtItem.extendInt.extendInt3.value" />
        <id column="EXT_INT_4" property="detailExtItem.extendInt.extendInt4.value" />
        <id column="EXT_INT_5" property="detailExtItem.extendInt.extendInt5.value" />
        <id column="EXT_INT_6" property="detailExtItem.extendInt.extendInt6.value" />
        <id column="EXT_INT_7" property="detailExtItem.extendInt.extendInt7.value" />
        <id column="EXT_INT_8" property="detailExtItem.extendInt.extendInt8.value" />
        <id column="EXT_INT_9" property="detailExtItem.extendInt.extendInt9.value" />
        <id column="EXT_INT_10" property="detailExtItem.extendInt.extendInt10.value" />
        <id column="EXT_DEC_1" property="detailExtItem.extendDec.extendDec1.value" />
        <id column="EXT_DEC_2" property="detailExtItem.extendDec.extendDec2.value" />
        <id column="EXT_DEC_3" property="detailExtItem.extendDec.extendDec3.value" />
        <id column="EXT_DEC_4" property="detailExtItem.extendDec.extendDec4.value" />
        <id column="EXT_DEC_5" property="detailExtItem.extendDec.extendDec5.value" />
        <id column="EXT_SEL_1" property="detailExtItem.extendSel.extendSel1" />
        <id column="EXT_SEL_2" property="detailExtItem.extendSel.extendSel2" />
        <id column="EXT_SEL_3" property="detailExtItem.extendSel.extendSel3" />
        <id column="EXT_SEL_4" property="detailExtItem.extendSel.extendSel4" />
        <id column="EXT_SEL_5" property="detailExtItem.extendSel.extendSel5" />
        <id column="EXT_SEL_6" property="detailExtItem.extendSel.extendSel6" />
        <id column="EXT_SEL_7" property="detailExtItem.extendSel.extendSel7" />
        <id column="EXT_SEL_8" property="detailExtItem.extendSel.extendSel8" />
        <id column="EXT_SEL_9" property="detailExtItem.extendSel.extendSel9" />
        <id column="EXT_SEL_10" property="detailExtItem.extendSel.extendSel10" />
        <id column="EXT_CHK_1" property="detailExtItem.extendChk.extendChk1" />
        <id column="EXT_CHK_2" property="detailExtItem.extendChk.extendChk2" />
        <id column="EXT_CHK_3" property="detailExtItem.extendChk.extendChk3" />
        <id column="EXT_CHK_4" property="detailExtItem.extendChk.extendChk4" />
        <id column="EXT_CHK_5" property="detailExtItem.extendChk.extendChk5" />
        <id column="EXT_FILE_1" property="detailExtItem.extendFile.extendFile1.fileName" />
        <id column="EXT_FILE_2" property="detailExtItem.extendFile.extendFile2.fileName" />
        <id column="EXT_FILE_3" property="detailExtItem.extendFile.extendFile3.fileName" />
        <id column="EXT_FILE_BINARY_1" property="detailExtItem.extendFile.extendFile1.binary" />
        <id column="EXT_FILE_BINARY_1" property="detailExtItem.extendFile.extendFile2.binary" />
        <id column="EXT_FILE_BINARY_1" property="detailExtItem.extendFile.extendFile3.binary" />
        <id column="EXT_MST_1" property="detailExtItem.extendMst.extendMst1.mstKey" />
        <id column="EXT_MST_2" property="detailExtItem.extendMst.extendMst2.mstKey" />
        <id column="EXT_MST_3" property="detailExtItem.extendMst.extendMst3.mstKey" />
        <id column="EXT_MST_4" property="detailExtItem.extendMst.extendMst4.mstKey" />
        <id column="EXT_MST_5" property="detailExtItem.extendMst.extendMst5.mstKey" />
        <id column="EXT_MST_6" property="detailExtItem.extendMst.extendMst6.mstKey" />
        <id column="EXT_MST_7" property="detailExtItem.extendMst.extendMst7.mstKey" />
        <id column="EXT_MST_8" property="detailExtItem.extendMst.extendMst8.mstKey" />
        <id column="EXT_MST_NAME_1" property="detailExtItem.extendMst.extendMst1.mstName" />
        <id column="EXT_MST_NAME_2" property="detailExtItem.extendMst.extendMst2.mstName" />
        <id column="EXT_MST_NAME_3" property="detailExtItem.extendMst.extendMst3.mstName" />
        <id column="EXT_MST_NAME_4" property="detailExtItem.extendMst.extendMst4.mstName" />
        <id column="EXT_MST_NAME_5" property="detailExtItem.extendMst.extendMst5.mstName" />
        <id column="EXT_MST_NAME_6" property="detailExtItem.extendMst.extendMst6.mstName" />
        <id column="EXT_MST_NAME_7" property="detailExtItem.extendMst.extendMst7.mstName" />
        <id column="EXT_MST_NAME_8" property="detailExtItem.extendMst.extendMst8.mstName" />
        <id column="UNIT_CD" property="itemName.unit.unitCd" />
        <id column="PUR_REQ_NO" property="purReqNo.purReqNo" />
        <id column="PUR_REQ_SEQ" property="purReqSeq" />
        <id column="PUR_REQ_STATUS" property="purReqStatus.status" />
    </resultMap>
    <select id="getPurRequestList" resultMap="PurRequest_Map">
        SELECT
            T_PUR_REQUEST.SUBJECT_CD,
            T_PUR_REQUEST.SUBJECT_NAME,
            T_PUR_REQUEST.ITEM_CD,
            T_PUR_REQUEST.ITEM_NAME,
            T_PUR_REQUEST.KATASHIKI,
            T_PUR_REQUEST.MANUFACT_CD,
            T_PUR_REQUEST.MANUFACT_NAME,
            T_PUR_REQUEST.INSPECT_IND,
            T_PUR_REQUEST.REQ_DELIV_DATE,
            T_PUR_REQUEST.CURRENCY_CD,
            M_CURRENCY.CURRENCY_MARK,
            T_PUR_REQUEST.UNIT_PRICE,
            T_PUR_REQUEST.REQ_VOL,
            T_PUR_REQUEST.UNIT_NAME,
            T_PUR_REQUEST.REQ_AMOUNT,
            T_PUR_REQUEST.TAX_IND,
            T_ATTACH_MNG.ATTACH_FILE_NAME,
            T_PUR_REQUEST.ATTACH_FILE_SEQ,
            T_ATTACH_MNG.ATTACH_SCOPE,
            T_PUR_REQUEST.BUYER_COMPANY_CD,
            T_PUR_REQUEST.BUYER_SECTION_CD,
            T_PUR_REQUEST.BUYER_SECTION_NAME,
            T_PUR_REQUEST.BUYER_USER_ID,
            T_PUR_REQUEST.BUYER_USER_NAME,
            T_PUR_REQUEST.PUR_REQ_NO,
            T_PUR_REQUEST.UNIT_CD,
            T_PUR_REQUEST.PUR_REQ_SEQ,
            T_PUR_REQUEST.BUYER_BACK_USER_COMMENTS,
            T_PUR_REQUEST.PUR_REQ_STATUS,
            ${@ps.common.util.ItemSettingUtil@getItemSettingSelectSQL("T_PUR_REQUEST")}
        FROM T_PUR_REQUEST
        LEFT JOIN T_ATTACH_MNG 
            ON T_PUR_REQUEST.ATTACH_FILE_SEQ = T_ATTACH_MNG.ATTACH_FILE_SEQ
            AND T_ATTACH_MNG.DELETE_FLG = '0'
        LEFT JOIN M_CURRENCY 
            ON T_PUR_REQUEST.CURRENCY_CD = M_CURRENCY.CURRENCY_CD
        WHERE
            T_PUR_REQUEST.PUR_APL_SEQ = #{purAplSeq}
            <if test="@org.apache.commons.lang.StringUtils@isNotBlank(purReqNo)">
                AND T_PUR_REQUEST.PUR_REQ_NO = #{purReqNo}
            </if>
            <if test="@org.apache.commons.lang.StringUtils@isBlank(purReqNo)">
                AND T_PUR_REQUEST.APP_UNIT_NO IS NULL
            </if>
            AND T_PUR_REQUEST.DELETE_FLG = '0'
        UNION ALL
        SELECT
            T_PUR_REQUEST.SUBJECT_CD,
            T_PUR_REQUEST.SUBJECT_NAME,
            T_PUR_REQUEST.ITEM_CD,
            T_PUR_REQUEST.ITEM_NAME,
            T_PUR_REQUEST.KATASHIKI,
            T_PUR_REQUEST.MANUFACT_CD,
            T_PUR_REQUEST.MANUFACT_NAME,
            T_PUR_REQUEST.INSPECT_IND,
            T_PUR_REQUEST.REQ_DELIV_DATE,
            T_PUR_REQUEST.CURRENCY_CD,
            M_CURRENCY.CURRENCY_MARK,
            T_PUR_REQUEST.UNIT_PRICE,
            T_PUR_REQUEST.REQ_VOL,
            T_PUR_REQUEST.UNIT_NAME,
            T_PUR_REQUEST.REQ_AMOUNT,
            T_PUR_REQUEST.TAX_IND,
            T_ATTACH_MNG.ATTACH_FILE_NAME,
            T_PUR_REQUEST.ATTACH_FILE_SEQ,
            T_ATTACH_MNG.ATTACH_SCOPE,
            T_PUR_REQUEST.BUYER_COMPANY_CD,
            T_PUR_REQUEST.BUYER_SECTION_CD,
            T_PUR_REQUEST.BUYER_SECTION_NAME,
            T_PUR_REQUEST.BUYER_USER_ID,
            T_PUR_REQUEST.BUYER_USER_NAME,
            T_PUR_REQUEST.PUR_REQ_NO,
            T_PUR_REQUEST.UNIT_CD,
            T_PUR_REQUEST.PUR_REQ_SEQ,
            T_PUR_REQUEST.BUYER_BACK_USER_COMMENTS,
            T_PUR_REQUEST.PUR_REQ_STATUS,
            ${@ps.common.util.ItemSettingUtil@getItemSettingSelectSQL("T_PUR_REQUEST")}
        FROM H_PUR_REQUEST T_PUR_REQUEST
        LEFT JOIN H_ATTACH_MNG T_ATTACH_MNG 
            ON T_PUR_REQUEST.ATTACH_FILE_SEQ = T_ATTACH_MNG.ATTACH_FILE_SEQ
            AND T_ATTACH_MNG.DELETE_FLG = '0'
        LEFT JOIN M_CURRENCY 
            ON T_PUR_REQUEST.CURRENCY_CD = M_CURRENCY.CURRENCY_CD
        WHERE
            T_PUR_REQUEST.PUR_APL_SEQ = #{purAplSeq}
            <if test="@org.apache.commons.lang.StringUtils@isNotBlank(purReqNo)">
                AND T_PUR_REQUEST.PUR_REQ_NO = #{purReqNo}
            </if>
            <if test="@org.apache.commons.lang.StringUtils@isBlank(purReqNo)">
                AND T_PUR_REQUEST.APP_UNIT_NO IS NULL
            </if>
            AND T_PUR_REQUEST.DELETE_FLG = '0'
        ORDER BY PUR_REQ_NO ASC
    </select>

    <resultMap type="fw.domain.slip.purreq.everypurreq.EveryPurReqApl" id="purReAmout_Map">
        <id column="REQ_AMOUNT" property="purAplManagement.hopeAmountTotal.hopeAmountTotal.amount"/>
    </resultMap>
    <select id="purReAmout" resultMap="purReAmout_Map">
        SELECT 
            T_PUR_REQUEST.PUR_APL_NO,
            SUM(T_PUR_REQUEST.REQ_AMOUNT) AS REQ_AMOUNT
        FROM T_PUR_REQUEST T_PUR_REQUEST
        INNER JOIN (
            SELECT DISTINCT
                PUR_APL_NO
            FROM
                T_PUR_REQUEST
            WHERE
                PUR_APL_SEQ = #{purAplSeq}
        ) PUR_APL_NO 
            ON T_PUR_REQUEST.PUR_APL_NO = PUR_APL_NO.PUR_APL_NO
        WHERE
            T_PUR_REQUEST.NEW_FLG = '1'
            AND T_PUR_REQUEST.DELETE_FLG = '0'
        GROUP BY T_PUR_REQUEST.PUR_APL_NO
        UNION ALL
        SELECT 
            T_PUR_REQUEST.PUR_APL_NO,
            SUM(T_PUR_REQUEST.REQ_AMOUNT) AS REQ_AMOUNT
        FROM H_PUR_REQUEST T_PUR_REQUEST
        INNER JOIN (
            SELECT DISTINCT
                PUR_APL_NO
            FROM
                H_PUR_REQUEST T_PUR_REQUEST
            WHERE
                PUR_APL_SEQ = #{purAplSeq}
        ) PUR_APL_NO 
            ON T_PUR_REQUEST.PUR_APL_NO = PUR_APL_NO.PUR_APL_NO
        WHERE
            T_PUR_REQUEST.NEW_FLG = '1'
            AND T_PUR_REQUEST.DELETE_FLG = '0'
        GROUP BY T_PUR_REQUEST.PUR_APL_NO
    </select>

    <select id="getQuotAcaRequest" resultType="String">
        SELECT count(0) FROM (
            SELECT *
            FROM T_QUOT_ACQ_APL
            <where>
                QUOT_ACQ_APL_NO = #{auotAcqAplNo}
            </where>
            UNION ALL
            SELECT  *
            FROM H_QUOT_ACQ_APL T_QUOT_ACQ_APL
            <where>
                QUOT_ACQ_APL_NO = #{auotAcqAplNo}
            </where>
        )
    </select>
</mapper>