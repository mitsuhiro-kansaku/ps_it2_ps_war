<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="ps.dataaccess.qot.ans.AnsMapper">
    <!--見積回答入力画面のヘッダ情報取得（見積依頼情報）SQL -->
    <select id="searchQuotResp"  parameterType="String" resultMap="QuotReq_Map">
        SELECT
            T_QUOT_REQUEST.QUOT_REQ_NO,
            T_QUOT_REQUEST.QUOT_REQ_VERSION,
            T_QUOT_REQUEST.BUYER_SECTION_CD,
            T_QUOT_REQUEST.BUYER_SECTION_NAME,
            T_QUOT_REQUEST.BUYER_USER_ID,
            T_QUOT_REQUEST.BUYER_USER_NAME,
            T_QUOT_REQUEST.BUYER_COMPANY_CD,
            T_QUOT_REQUEST.BUYER_USER_EXTENSION_NO,
            T_QUOT_REQUEST.BUYER_USER_TEL_NO,
            T_QUOT_REQUEST.QUOT_RESP_LIMIT_DATE,
            T_QUOT_REQUEST.DELIV_PLACE_CD,
            T_QUOT_REQUEST.DELIV_PLACE_NAME,
            T_QUOT_REQUEST.QUOT_REQ_SEQ,
            T_QUOT_REQUEST.LAST_UPD_DATE
        FROM
            T_QUOT_REQUEST
        WHERE
            T_QUOT_REQUEST.QUOT_REQ_SEQ = #{quotRespSeqNo}
    </select>
    <resultMap type="fw.domain.slip.quot.quotreq.QuotReq" id="QuotReq_Map">
        <id column="QUOT_REQ_NO" property="quotReqIdentify.quotReqNo.quotReqNo"/>
        <id column="QUOT_REQ_VERSION" property="quotReqIdentify.historyNo.historyNo"/>
        <id column="BUYER_SECTION_CD" property="itemKind.buyUser.buyUser.section.sectionCd"/>
        <id column="BUYER_SECTION_NAME" property="itemKind.buyUser.buyUser.section.sectionName"/>
        <id column="BUYER_COMPANY_CD" property="itemKind.buyUser.buyUser.section.company.companyCd"/>
        <id column="BUYER_USER_ID" property="itemKind.buyUser.buyUser.userID"/>
        <id column="BUYER_USER_NAME" property="itemKind.buyUser.buyUser.userName"/>
        <id column="BUYER_USER_EXTENSION_NO" property="itemKind.buyUser.buyUser.extNo.extensionNo"/>
        <id column="BUYER_USER_TEL_NO" property="itemKind.buyUser.buyUser.externalNo.externalNo"/>
        <id column="QUOT_RESP_LIMIT_DATE" property="respLimitDate.respLimitDate.dateOfymd"/>
        <id column="DELIV_PLACE_CD" property="delivPlace.delivPlaceCd"/>
        <id column="DELIV_PLACE_NAME" property="delivPlace.delivPlaceName"/>
        <id column="QUOT_REQ_SEQ" property="quotReqIdentify.quotReqSeqNo.seqNumber"/>
        <id column="LAST_UPD_DATE" property="quotReqIdentify.lastUpdDate"/>
    </resultMap>

    <!--見積回答入力画面のヘッダ情報取得（見積依頼取引情報）SQL -->
    <select id="searchQuotReqSup"  parameterType="String" resultMap="QuotReqSup_Map">
        SELECT
            T_QUOT_REQ_SUP.QUOT_SUP_LINE_NO,
            T_QUOT_REQ_SUP.QUOT_SUP_STATUS,
            T_QUOT_REQ_SUP.CORRECT_CD,
            T_QUOT_REQ_SUP.EDI_IND,
            T_QUOT_REQ_SUP.QUOT_REQ_SEND_IND,
            T_QUOT_REQ_SUP.SUP_CD,
            T_QUOT_REQ_SUP.SUP_ABBR_NAME,
            T_QUOT_REQ_SUP.SUP_ZIP_CD,
            T_QUOT_REQ_SUP.SUP_ADDRESS1,
            T_QUOT_REQ_SUP.SUP_ADDRESS2,
            T_QUOT_REQ_SUP.SUP_TEL_NO,
            T_QUOT_REQ_SUP.SUP_FAX_NO,
            T_QUOT_REQ_SUP.SUBCON_IND,
            T_QUOT_REQ_SUP.QUOT_REQ_DATE
        FROM
            T_QUOT_REQ_SUP
        WHERE
            T_QUOT_REQ_SUP.QUOT_REQ_SEQ = #{quotRespSeqNo} AND
            T_QUOT_REQ_SUP.QUOT_SUP_LINE_NO = #{quotSupplierLineNo} AND
            T_QUOT_REQ_SUP.DELETE_FLG = '0'
    </select>
    <resultMap type="fw.domain.slip.quot.quotreq.QuotReqSupplier" id="QuotReqSup_Map">
        <id column="QUOT_SUP_LINE_NO" property="quotReqSupplierIdentify.quotSupplierLineNo"/>
        <id column="QUOT_SUP_STATUS" property="supplierRespStatus"/>
        <id column="CORRECT_CD" property="correctInd.correctInd"/>
        <id column="EDI_IND" property="supplierFrom.ediInd.ediInd"/>
        <id column="QUOT_REQ_SEND_IND" property="dataInd.reqDataSendInd.sendInd"/>
        <id column="SUP_CD" property="supplierFrom.supCd"/>
        <id column="SUP_COMPANY_CD" property="supplierFrom.supCompanyCd"/>
        <id column="SUP_ABBR_NAME" property="supplierFrom.supplierName.supplierAbbrName"/>
        <id column="SUP_ZIP_CD" property="supplierFrom.supplierContact.ctc.zipCd.zipCd"/>
        <id column="SUP_ADDRESS1" property="supplierFrom.supplierContact.ctc.address1.address"/>
        <id column="SUP_ADDRESS2" property="supplierFrom.supplierContact.ctc.address2.address"/>
        <id column="SUP_TEL_NO" property="supplierFrom.supplierContact.ctc.telNo.telNo"/>
        <id column="SUP_FAX_NO" property="supplierFrom.supplierContact.ctc.faxNo.faxNo"/>
        <id column="SUBCON_IND" property="supplierFrom.subcon.subconInd"/>
        <id column="QUOT_REQ_DATE" property="quotReqDate.quotReqDate.reqDate.dateOfymd"/>
    </resultMap>

    <!--見積回答入力画面の明細情報取得SQL -->
    <select id="searchQuotRespDtl"  resultMap="QuotRespItem_Map">
        SELECT
            T_QUOT_REQ_DTL.QUOT_REQ_DTL_NO,
            T_QUOT_REQ_DTL.ITEM_COMPANY_CD,
            T_QUOT_REQ_DTL.ITEM_CD,
            T_QUOT_REQ_DTL.ITEM_NAME,
            T_QUOT_REQ_DTL.KATASHIKI,
            T_QUOT_REQ_DTL.MANUFACT_CD,
            T_QUOT_REQ_DTL.MANUFACT_NAME,
            T_QUOT_REQ_DTL.REQ_DELIV_DATE,
            '' as "UNIT_PRICE",
            T_QUOT_REQ_SUP.SUP_COMPANY_CD,
            T_QUOT_REQ_SUP.SUP_CD,
            T_QUOT_REQ_DTL.QUOT_REQ_AMOUNT,
            T_QUOT_REQ_DTL.QUOT_REQ_VOL,
            T_QUOT_REQ_DTL.UNIT_CD,
            T_QUOT_REQ_DTL.UNIT_NAME,
            null AS ATTACH_FILE_NAME,
            null AS ATTACH_FILE_SEQ,
            T_SLIP_MNG.SLIP_NO AS EXCLUSIVE_SLIP_NO,
            T_SLIP_MNG.LAST_UPD_DATE AS EXCLUSIVE_LAST_UPD_DATE
        FROM
            T_QUOT_REQ_DTL
        LEFT JOIN
            T_ATTACH_MNG
        ON
            T_QUOT_REQ_DTL.ATTACH_FILE_SEQ = T_ATTACH_MNG.ATTACH_FILE_SEQ AND
            T_QUOT_REQ_DTL.DELETE_FLG = '0' AND
            T_ATTACH_MNG.DELETE_FLG = '0'
        LEFT JOIN
            T_QUOT_REQ_SUP
        ON
            T_QUOT_REQ_DTL.QUOT_REQ_SEQ = T_QUOT_REQ_SUP.QUOT_REQ_SEQ AND
            T_QUOT_REQ_SUP.DELETE_FLG = '0'
        LEFT JOIN
            T_SLIP_MNG
        ON
            T_QUOT_REQ_DTL.QUOT_REQ_DTL_NO = T_SLIP_MNG.SLIP_NO AND
            T_SLIP_MNG.DELETE_FLG = '0'
        WHERE
            T_QUOT_REQ_DTL.QUOT_REQ_SEQ = #{quotRespSeqNo} AND
            T_QUOT_REQ_SUP.QUOT_SUP_LINE_NO = #{quotSupplierLineNo}
        ORDER BY
            QUOT_REQ_DTL_NO ASC
    </select>
    <resultMap type="fw.domain.slip.quot.quotresp.QuotRespItem" id="QuotRespItem_Map">
        <id column="QUOT_REQ_DTL_NO" property="quotRespItemIdentify.quotReqItemNo"/>
        <id column="ITEM_COMPANY_CD" property="itemName.itemCompanyCd"/>
        <id column="ITEM_CD" property="itemName.itemCd"/>
        <id column="ITEM_NAME" property="itemName.itemName"/>
        <id column="KATASHIKI" property="itemName.katashiki"/>
        <id column="MANUFACT_CD" property="itemName.manufact.manufactCd"/>
        <id column="MANUFACT_NAME" property="itemName.manufact.manufactName"/>
        <id column="REQ_DELIV_DATE" property="respDlvEst.respDlvEst.dateOfymd"/>
        <id column="UNIT_PRICE" property="respPrice.respPrice.amount"/>
        <id column="SUP_COMPANY_CD" property="supplierFrom.supCompanyCd"/>
        <id column="SUP_CD" property="supplierFrom.supCd"/>
        <id column="QUOT_REQ_AMOUNT" property="respAmount.respAmount.amount"/>
        <id column="QUOT_REQ_VOL" property="respVol.respVol.vol"/>
        <id column="UNIT_CD" property="itemName.unit.unitCd"/>
        <id column="UNIT_NAME" property="itemName.unit.unitName"/>
        <id column="ATTACH_FILE_NAME" property="attachFile.fileName"/>
        <id column="ATTACH_FILE_SEQ" property="attachFile.seqNo"/>
        <id column="EXCLUSIVE_SLIP_NO" property="exclusiveSlipId.slipNo"/>
        <id column="EXCLUSIVE_LAST_UPD_DATE" property="exclusiveSlipId.lastUpdDate"/>
    </resultMap>

    <!-- 取引先マスタから取引先基本言語を取得する -->
    <select id="getBaseCurrencyCode" resultType="String">
        SELECT BASE_CURRENCY_CD
          FROM M_SUPPLIER
         WHERE (COMPANY_CD = #{supCompanyCd}
            OR COMPANY_CD = '${@fw.common.constant.ApplicationConstant@COMPANY_CD_ALL}')
           AND SUP_CD = #{supcd}
           AND VALID_START_DATE &lt;= '${@fw.common.util.AppUtil@getSysDate()}'
           AND VALID_END_DATE >= '${@fw.common.util.AppUtil@getSysDate()}'
           AND TERM_FLG = '0'
    </select>

    <!--見積回答テーブルの登録SQL -->
    <insert id="insertQuotResp">
        INSERT INTO T_QUOT_RESPONSE
            (
            QUOT_RESP_SEQ,
            QUOT_RESP_VERSION,
            QUOT_REQ_NO,
            QUOT_REQ_VERSION,
            QUOT_SUP_LINE_NO,
            QUOT_RESP_INPUT_IND,
            QUOT_RESP_DATE,
            QUOT_RESP_USER_ID,
            QUOT_RESP_USER_NAME,
            QUOT_WITHDRAW_ID,
            QUOT_RESP_END_DATE,
            RESP_OPEN_FLG,
            QUOT_RESP_COMMENT,
            QUOT_ADO_IND,
            RESP_CONF_FLG,
            DELETE_FLG,
            AUTO_DELETE_FLG,
            AUTO_DELETE_DATE,
            LAST_UPD_DATE,
            LAST_UPD_COMPANY_CD,
            LAST_UPD_SECTION_CD,
            LAST_UPD_USER_ID,
            REG_DATE,
            REG_COMPANY_CD,
            REG_SECTION_CD,
            REG_USER_ID
            )
        VALUES
            (
            #{quotRespSeq},
            #{quotManagement.quotReq.quotReqIdentify.historyNo.historyNo},
            #{quotManagement.quotReq.quotReqIdentify.quotReqNo.quotReqNo},
            #{quotManagement.quotReq.quotReqIdentify.historyNo.historyNo},
            #{quotManagement.quotReq.quotReqSupplierList[0].quotReqSupplierIdentify.quotSupplierLineNo},
            '1',
            '${@fw.common.util.AppUtil@getSysDate()}',
            '${@fw.security.SecurityUtil@getUserIdByEscapeSql()}',
            '${@fw.security.SecurityUtil@getUserNameByEscapeSql()}',
            '0',
            #{quotManagement.quotResp.quotValidDate.quotValidDate.dateOfymd},
            #{respOpenFlg},
            #{quotManagement.quotResp.respBackup.respBackup.comment},
            '0',
            '1',
            '0',
            '0',
            '',
            '${@fw.common.util.AppUtil@getSysDateYyyyMMddHHmmssSSS()}',
            '${@fw.security.SecurityUtil@getCompanyCdByEscapeSql()}',
            '${@fw.security.SecurityUtil@getDefaultSectionCdByEscapeSql()}',
            '${@fw.security.SecurityUtil@getUserIdByEscapeSql()}',
            '${@fw.common.util.AppUtil@getSysDateYyyyMMddHHmmssSSS()}',
            '${@fw.security.SecurityUtil@getCompanyCdByEscapeSql()}',
            '${@fw.security.SecurityUtil@getDefaultSectionCdByEscapeSql()}',
            '${@fw.security.SecurityUtil@getUserIdByEscapeSql()}'
            )
    </insert>

    <!--見積回答明細テーブルの登録SQL -->
    <insert id="insertQuotRespDtl">
        INSERT INTO T_QUOT_RESP_DTL
            (
            QUOT_RESP_SEQ,
            QUOT_REQ_DTL_NO,
            QUOT_REQ_NO,
            QUOT_REQ_VERSION,
            QUOT_SUP_LINE_NO,
            ITEM_COMPANY_CD,
            ITEM_CD,
            QUOT_RESP_ITEM_NAME,
            QUOT_RESP_KATASHIKI,
            QUOT_RESP_MANUFACT_CD,
            QUOT_RESP_MANUFACT_NAME,
            QUOT_RESP_DELIV_DATE,
            CURRENCY_CD,
            TAX_IND,
            CONSUMPT_IND,
            QUOT_RESP_VOL,
            UNIT_CD,
            UNIT_NAME,
            UNIT_PRICE,
            QUOT_RESP_AMOUNT,
            CONSUMPT_AMOUNT,
            TOTAL_AMOUNT,
            LOWER_VOL1,
            LOWER_VOL2,
            LOWER_VOL3,
            LOWER_VOL4,
            LOWER_VOL5,
            QUOT_RESP_PRICE1,
            QUOT_RESP_PRICE2,
            QUOT_RESP_PRICE3,
            QUOT_RESP_PRICE4,
            QUOT_RESP_PRICE5,
            ORDER_LT,
            ORDER_UNIT_VOL,
            MIN_ORDER_VOL,
            VALID_START_DATE,
            VALID_END_DATE,
            ATTACH_FILE_SEQ,
            DELETE_FLG,
            AUTO_DELETE_FLG,
            AUTO_DELETE_DATE,
            LAST_UPD_DATE,
            LAST_UPD_COMPANY_CD,
            LAST_UPD_SECTION_CD,
            LAST_UPD_USER_ID,
            REG_DATE,
            REG_COMPANY_CD,
            REG_SECTION_CD,
            REG_USER_ID
            )
        VALUES
            (
            #{quotRespSeq},
            #{quotRespItem.quotRespItemIdentify.quotReqItemNo},
            #{quotReqNo},
            #{historyNo},
            #{quotSupplierLineNo},
            #{quotRespItem.itemName.itemCompanyCd},
            #{quotRespItem.itemName.itemCd},
            #{quotRespItem.itemName.itemName},
            #{quotRespItem.itemName.katashiki},
            #{quotRespItem.itemName.manufact.manufactCd},
            #{quotRespItem.itemName.manufact.manufactName},
            #{quotRespItem.respDlvEst.respDlvEst.dateOfymd},
            #{quotRespItem.amountMng.currency.currencyCd},
            #{quotRespItem.amountMng.taxCalculationInd.taxInd.taxInd},
            '2',
            '${@fw.common.util.AppUtil@deleteComma(quotRespItem.respVol.respVol.vol)}',
            #{quotRespItem.itemName.unit.unitCd},
            #{quotRespItem.itemName.unit.unitName},
            '${@fw.common.util.AppUtil@deleteComma(quotRespItem.respPrice.respPrice.amount)}',
            #{quotRespItem.respAmount.respAmount.amount},
            '${@fw.common.util.AppUtil@deleteComma(quotRespItem.amountMng.consumptAmount.consumptAmount.amount)}',
            #{quotRespItem.amountMng.totalAmount.totalAmount.amount},
            '',
            '',
            '',
            '',
            '',
            '',
            '',
            '',
            '',
            '',
            #{quotRespItem.orderDeliv.standardDelivDayCount.standardDelivDayCount.dayCount},
            '',
            '',
            '',
            '',
             #{attachFileSeq},
            '0',
            '0',
            '',
            '${@fw.common.util.AppUtil@getSysDateYyyyMMddHHmmssSSS()}',
            '${@fw.security.SecurityUtil@getCompanyCdByEscapeSql()}',
            '${@fw.security.SecurityUtil@getDefaultSectionCdByEscapeSql()}',
            '${@fw.security.SecurityUtil@getUserIdByEscapeSql()}',
            '${@fw.common.util.AppUtil@getSysDateYyyyMMddHHmmssSSS()}',
            '${@fw.security.SecurityUtil@getCompanyCdByEscapeSql()}',
            '${@fw.security.SecurityUtil@getDefaultSectionCdByEscapeSql()}',
            '${@fw.security.SecurityUtil@getUserIdByEscapeSql()}'
            )
    </insert>
    
    <!--見積依頼取引先テーブル更新SQL -->
   <update id="updateQuotReqSup" parameterType="String">
        UPDATE T_QUOT_REQ_SUP
        SET
            QUOT_SUP_STATUS = '02',
            LAST_UPD_DATE = '${@fw.common.util.AppUtil@getSysDateYyyyMMddHHmmssSSS()}',
            LAST_UPD_COMPANY_CD = '${@fw.security.SecurityUtil@getCompanyCdByEscapeSql()}',
            LAST_UPD_SECTION_CD = '${@fw.security.SecurityUtil@getDefaultSectionCdByEscapeSql()}',
            LAST_UPD_USER_ID = '${@fw.security.SecurityUtil@getUserIdByEscapeSql()}'
        WHERE
            QUOT_REQ_SEQ = #{quotRespSeqNo}
            AND QUOT_SUP_LINE_NO = #{quotSupplierLineNo}
    </update>

    <!--見積依頼取引先テーブルの回答済み件数取得SQL -->
    <select id="searchAnswerCount" parameterType="String" resultType="int">
        SELECT
            COUNT(T_QUOT_REQ_SUP.QUOT_SUP_STATUS)
        FROM
            T_QUOT_REQ_SUP
        WHERE
            T_QUOT_REQ_SUP.QUOT_REQ_SEQ = #{quotRespSeqNo}
            AND T_QUOT_REQ_SUP.QUOT_SUP_STATUS = '02'
    </select>

    <!--見積依頼取引先件数取得SQL -->
    <select id="searchQuotReqSupCount"  parameterType="String" resultType="int">
        SELECT
            COUNT(T_QUOT_REQ_SUP.QUOT_SUP_STATUS)
        FROM
            T_QUOT_REQ_SUP
        WHERE
            T_QUOT_REQ_SUP.QUOT_REQ_SEQ = #{quotRespSeqNo}
    </select>

    <!--見積依頼取引先テーブル更新SQL -->
   <update id="updateQuotRequest" parameterType="String">
        UPDATE T_QUOT_REQUEST
        SET
            QUOT_REQ_STATUS = #{quotReqStatus},
            LAST_UPD_DATE = '${@fw.common.util.AppUtil@getSysDateYyyyMMddHHmmssSSS()}',
            LAST_UPD_COMPANY_CD = '${@fw.security.SecurityUtil@getCompanyCdByEscapeSql()}',
            LAST_UPD_SECTION_CD = '${@fw.security.SecurityUtil@getDefaultSectionCdByEscapeSql()}',
            LAST_UPD_USER_ID = '${@fw.security.SecurityUtil@getUserIdByEscapeSql()}'
        WHERE
            QUOT_REQ_SEQ = #{quotRespSeqNo}
    </update>

    <!--見積回答テーブルの登録SQL -->
    <insert id="insertQuotRespToDismiss">
        INSERT INTO T_QUOT_RESPONSE
            (
            QUOT_RESP_SEQ,
            QUOT_RESP_VERSION,
            QUOT_REQ_NO,
            QUOT_REQ_VERSION,
            QUOT_SUP_LINE_NO,
            QUOT_RESP_INPUT_IND,
            QUOT_RESP_DATE,
            QUOT_RESP_USER_ID,
            QUOT_RESP_USER_NAME,
            QUOT_WITHDRAW_ID,
            QUOT_RESP_END_DATE,
            RESP_OPEN_FLG,
            QUOT_RESP_COMMENT,
            QUOT_ADO_IND,
            RESP_CONF_FLG,
            DELETE_FLG,
            AUTO_DELETE_FLG,
            AUTO_DELETE_DATE,
            LAST_UPD_DATE,
            LAST_UPD_COMPANY_CD,
            LAST_UPD_SECTION_CD,
            LAST_UPD_USER_ID,
            REG_DATE,
            REG_COMPANY_CD,
            REG_SECTION_CD,
            REG_USER_ID
            )
        VALUES
            (
            #{quotRespSeq},
            #{quotManagement.quotReq.quotReqIdentify.historyNo.historyNo},
            #{quotManagement.quotReq.quotReqIdentify.quotReqNo.quotReqNo},
            #{quotManagement.quotReq.quotReqIdentify.historyNo.historyNo},
            #{quotManagement.quotReq.quotReqSupplierList[0].quotReqSupplierIdentify.quotSupplierLineNo},
            '1',
            '${@fw.common.util.AppUtil@getSysDate()}',
            '${@fw.security.SecurityUtil@getUserIdByEscapeSql()}',
            '${@fw.security.SecurityUtil@getUserNameByEscapeSql()}',
            '1',
            #{quotManagement.quotResp.quotValidDate.quotValidDate.dateOfymd},
            #{respOpenFlg},
            #{quotManagement.quotResp.respBackup.respBackup.comment},
            '0',
            '1',
            '0',
            '0',
            '',
            '${@fw.common.util.AppUtil@getSysDateYyyyMMddHHmmssSSS()}',
            '${@fw.security.SecurityUtil@getCompanyCdByEscapeSql()}',
            '${@fw.security.SecurityUtil@getDefaultSectionCdByEscapeSql()}',
            '${@fw.security.SecurityUtil@getUserIdByEscapeSql()}',
            '${@fw.common.util.AppUtil@getSysDateYyyyMMddHHmmssSSS()}',
            '${@fw.security.SecurityUtil@getCompanyCdByEscapeSql()}',
            '${@fw.security.SecurityUtil@getDefaultSectionCdByEscapeSql()}',
            '${@fw.security.SecurityUtil@getUserIdByEscapeSql()}'
            )
    </insert>

    <sql id="selectQuotReqDetail">
        SELECT
            T_QUOT_REQUEST.QUOT_REQ_NO,
            T_QUOT_REQUEST.QUOT_REQ_SEQ,
            T_QUOT_REQUEST.QUOT_REQ_VERSION,
            T_QUOT_REQUEST.QUOT_ACQ_APL_NO,
            T_QUOT_REQUEST.QUOT_REQ_STATUS,
            T_QUOT_REQUEST.QUOT_ADO_STATUS,
            T_QUOT_REQUEST.REQ_SECTION_CD,
            T_QUOT_REQUEST.REQ_SECTION_NAME,
            T_QUOT_REQUEST.REQ_USER_ID,
            T_QUOT_REQUEST.REQ_USER_NAME,
            T_QUOT_REQUEST.REQ_COMPANY_CD,
            T_QUOT_REQUEST.REQ_USER_EXTENSION_NO,
            T_QUOT_REQUEST.REQ_USER_TEL_NO,
            T_QUOT_REQUEST.QUOT_RESP_LIMIT_DATE,
            T_QUOT_REQUEST.DELIV_PLACE_CD,
            T_QUOT_REQUEST.ITEM_CLASS_L_NAME,
            T_QUOT_REQUEST.ITEM_CLASS_M_NAME,
            T_QUOT_REQUEST.ITEM_CLASS_S_NAME,
            T_QUOT_REQUEST.TITLE_NAME,
            T_QUOT_REQUEST.DELIV_PLACE_NAME,
            T_QUOT_REQUEST.FOR_SUPPRIER_COMMENT,
            T_QUOT_REQUEST.QUOT_ADO_COMMENT,
            T_QUOT_ADO_REQUEST.APP_ROUTE_NAME,
            T_QUOT_ADO_REQUEST.APP_ROUTE_NO,
            T_ATTACH_MNG_A.ATTACH_FILE_NAME AS ATTACH_FILE_NAME1,
            T_ATTACH_MNG_B.ATTACH_FILE_NAME AS ATTACH_FILE_NAME2,
            T_ATTACH_MNG_A.ATTACH_FILE_SEQ AS ATTACH_FILE_SEQ1,
            T_ATTACH_MNG_B.ATTACH_FILE_SEQ AS ATTACH_FILE_SEQ2,
            T_ATTACH_MNG_A.ATTACH_SCOPE AS ATTACH_SCOPE1,
            T_ATTACH_MNG_B.ATTACH_SCOPE AS ATTACH_SCOPE2,
            T_QUOT_ADO_REQUEST.QUOT_ADO_SEQ,
            T_ATTACH_MNG_C.ATTACH_FILE_NAME AS ATTACH_FILE_NAME3,
            T_ATTACH_MNG_C.ATTACH_FILE_SEQ AS ATTACH_FILE_SEQ3,
            ${@ps.common.util.ItemSettingUtil@getItemSettingSelectSQL("T_QUOT_REQUEST")}
    </sql>

    <!--見積回答詳細画面(初期表示時)の見積依頼情報取得SQL -->
    <select id="searchQuotReqForInitDtl" resultMap="QuotRespDetail_Map">
        <include refid="selectQuotReqDetail" />
        FROM
            T_QUOT_REQUEST
        LEFT JOIN T_QUOT_ADO_REQUEST ON
           T_QUOT_REQUEST.QUOT_REQ_SEQ = T_QUOT_ADO_REQUEST.QUOT_REQ_SEQ
           AND T_QUOT_ADO_REQUEST.DELETE_FLG = '0'
        LEFT JOIN T_ATTACH_MNG T_ATTACH_MNG_A ON
           T_QUOT_REQUEST.ATTACH_FILE_SEQ1 = T_ATTACH_MNG_A.ATTACH_FILE_SEQ
            AND T_ATTACH_MNG_A.DELETE_FLG = '0'
        LEFT JOIN T_ATTACH_MNG T_ATTACH_MNG_B ON
           T_QUOT_REQUEST.ATTACH_FILE_SEQ2 = T_ATTACH_MNG_B.ATTACH_FILE_SEQ
            AND T_ATTACH_MNG_B.DELETE_FLG = '0'
        LEFT JOIN T_ATTACH_MNG T_ATTACH_MNG_C ON T_QUOT_ADO_REQUEST.ATTACH_FILE_SEQ =
           T_ATTACH_MNG_C.ATTACH_FILE_SEQ
            AND T_ATTACH_MNG_C.DELETE_FLG = '0'
        WHERE
            T_QUOT_REQUEST.QUOT_REQ_NO = #{quotReqNo}
            AND T_QUOT_REQUEST.NEW_FLG = '1'
            AND T_QUOT_REQUEST.DELETE_FLG = '0'
    </select>
    <resultMap type="fw.domain.slip.quot.quotresp.quotrespdetail.QuotRespDetail" id="QuotRespDetail_Map">
        <id column="QUOT_REQ_NO" property="quotReqSummary.quotReqNo"/>
        <id column="QUOT_REQ_SEQ" property="quotAdo.quotReqSeqNo"/>
        <id column="QUOT_REQ_VERSION" property="quotReqSummary.historyNo"/>
        <id column="QUOT_ACQ_APL_NO" property="quotAdo.quotAcqAplNo"/>
        <id column="QUOT_REQ_STATUS" property="quotReqSummary.status"/>
        <id column="QUOT_ADO_STATUS" property="quotReqSummary.quotAdoStatus"/>
        <id column="REQ_SECTION_CD" property="quotReqSummary.reqUser.reqUser.section.sectionCd"/>
        <id column="REQ_SECTION_NAME" property="quotReqSummary.reqUser.reqUser.section.sectionName"/>
        <id column="REQ_USER_ID" property="quotReqSummary.reqUser.reqUser.userID"/>
        <id column="REQ_USER_NAME" property="quotReqSummary.reqUser.reqUser.userName"/>
        <id column="REQ_COMPANY_CD" property="quotReqSummary.reqUser.reqUser.section.company.companyCd"/>
        <id column="REQ_USER_EXTENSION_NO" property="quotReqSummary.reqUser.reqUser.extNo.extensionNo"/>
        <id column="REQ_USER_TEL_NO" property="quotReqSummary.reqUser.reqUser.externalNo.externalNo"/>
        <id column="QUOT_RESP_LIMIT_DATE" property="quotReqSummary.respLimit.dateOfymd"/>
        <id column="DELIV_PLACE_CD" property="quotReqSummary.delivPlace.delivPlaceCd"/>
        <id column="ITEM_CLASS_L_NAME" property="quotReqInfo.itemKind.itemClassLName"/>
        <id column="ITEM_CLASS_M_NAME" property="quotReqInfo.itemKind.itemClassMName"/>
        <id column="ITEM_CLASS_S_NAME" property="quotReqInfo.itemKind.itemClassSName"/>
        <id column="TITLE_NAME" property="quotReqInfo.titleName"/>
        <id column="DELIV_PLACE_NAME" property="quotReqSummary.delivPlace.delivPlaceName"/>
        <id column="FOR_SUPPRIER_COMMENT" property="quotReqInfo.forSupplderComment"/>
        <id column="ATTACH_FILE_NAME1" property="quotReqInfo.attachFileLinkList.attachFileLink1.fileName"/>
        <id column="ATTACH_FILE_NAME2" property="quotReqInfo.attachFileLinkList.attachFileLink2.fileName"/>
        <id column="ATTACH_FILE_SEQ1" property="quotReqInfo.attachFileLinkList.attachFileLink1.seqNo"/>
        <id column="ATTACH_FILE_SEQ2" property="quotReqInfo.attachFileLinkList.attachFileLink2.seqNo"/>
        <id column="ATTACH_SCOPE1" property="quotReqInfo.attachFileLinkList.attachRange1.attachRange"/>
        <id column="ATTACH_SCOPE2" property="quotReqInfo.attachFileLinkList.attachRange2.attachRange"/>
        <id column="QUOT_ADO_SEQ" property="quotAdo.quotAdoSeqNo"/>
        <id column="QUOT_ADO_COMMENT" property="quotAdo.adoComment.comment"/>
        <id column="APP_ROUTE_NAME" property="quotAdo.approute.appRouteName"/>
        <id column="APP_ROUTE_NO" property="quotAdo.approute.appRouteNo"/>
        <id column="ATTACH_FILE_NAME3" property="quotAdo.rangeByAttachFile.attachFile.fileName"/>
        <id column="ATTACH_FILE_SEQ3" property="quotAdo.rangeByAttachFile.attachFile.seqNo"/>
        <id column="EXT_TXT_1" property="quotReqInfo.detailExtItem.extendTxt.extendTxt1"/>
        <id column="EXT_TXT_2" property="quotReqInfo.detailExtItem.extendTxt.extendTxt2"/>
        <id column="EXT_TXT_3" property="quotReqInfo.detailExtItem.extendTxt.extendTxt3"/>
        <id column="EXT_TXT_4" property="quotReqInfo.detailExtItem.extendTxt.extendTxt4"/>
        <id column="EXT_TXT_5" property="quotReqInfo.detailExtItem.extendTxt.extendTxt5"/>
        <id column="EXT_TXT_6" property="quotReqInfo.detailExtItem.extendTxt.extendTxt6"/>
        <id column="EXT_TXT_7" property="quotReqInfo.detailExtItem.extendTxt.extendTxt7"/>
        <id column="EXT_TXT_8" property="quotReqInfo.detailExtItem.extendTxt.extendTxt8"/>
        <id column="EXT_TXT_9" property="quotReqInfo.detailExtItem.extendTxt.extendTxt9"/>
        <id column="EXT_TXT_10" property="quotReqInfo.detailExtItem.extendTxt.extendTxt10"/>
        <id column="EXT_AREA_1" property="quotReqInfo.detailExtItem.extendArea.extendArea1"/>
        <id column="EXT_AREA_2" property="quotReqInfo.detailExtItem.extendArea.extendArea2"/>
        <id column="EXT_AREA_3" property="quotReqInfo.detailExtItem.extendArea.extendArea3"/>
        <id column="EXT_AREA_4" property="quotReqInfo.detailExtItem.extendArea.extendArea4"/>
        <id column="EXT_AREA_5" property="quotReqInfo.detailExtItem.extendArea.extendArea5"/>
        <id column="EXT_DATE_1" property="quotReqInfo.detailExtItem.extendDate.extendDate1.dateOfymd"/>
        <id column="EXT_DATE_2" property="quotReqInfo.detailExtItem.extendDate.extendDate2.dateOfymd"/>
        <id column="EXT_DATE_3" property="quotReqInfo.detailExtItem.extendDate.extendDate3.dateOfymd"/>
        <id column="EXT_DATE_4" property="quotReqInfo.detailExtItem.extendDate.extendDate4.dateOfymd"/>
        <id column="EXT_DATE_5" property="quotReqInfo.detailExtItem.extendDate.extendDate5.dateOfymd"/>
        <id column="EXT_INT_1" property="quotReqInfo.detailExtItem.extendInt.extendInt1.value"/>
        <id column="EXT_INT_2" property="quotReqInfo.detailExtItem.extendInt.extendInt2.value"/>
        <id column="EXT_INT_3" property="quotReqInfo.detailExtItem.extendInt.extendInt3.value"/>
        <id column="EXT_INT_4" property="quotReqInfo.detailExtItem.extendInt.extendInt4.value"/>
        <id column="EXT_INT_5" property="quotReqInfo.detailExtItem.extendInt.extendInt5.value"/>
        <id column="EXT_INT_6" property="quotReqInfo.detailExtItem.extendInt.extendInt6.value"/>
        <id column="EXT_INT_7" property="quotReqInfo.detailExtItem.extendInt.extendInt7.value"/>
        <id column="EXT_INT_8" property="quotReqInfo.detailExtItem.extendInt.extendInt8.value"/>
        <id column="EXT_INT_9" property="quotReqInfo.detailExtItem.extendInt.extendInt9.value"/>
        <id column="EXT_INT_10" property="quotReqInfo.detailExtItem.extendInt.extendInt10.value"/>
        <id column="EXT_DEC_1" property="quotReqInfo.detailExtItem.extendDec.extendDec1.value"/>
        <id column="EXT_DEC_2" property="quotReqInfo.detailExtItem.extendDec.extendDec2.value"/>
        <id column="EXT_DEC_3" property="quotReqInfo.detailExtItem.extendDec.extendDec3.value"/>
        <id column="EXT_DEC_4" property="quotReqInfo.detailExtItem.extendDec.extendDec4.value"/>
        <id column="EXT_DEC_5" property="quotReqInfo.detailExtItem.extendDec.extendDec5.value"/>
        <id column="EXT_SEL_1" property="quotReqInfo.detailExtItem.extendSel.extendSel1"/>
        <id column="EXT_SEL_2" property="quotReqInfo.detailExtItem.extendSel.extendSel2"/>
        <id column="EXT_SEL_3" property="quotReqInfo.detailExtItem.extendSel.extendSel3"/>
        <id column="EXT_SEL_4" property="quotReqInfo.detailExtItem.extendSel.extendSel4"/>
        <id column="EXT_SEL_5" property="quotReqInfo.detailExtItem.extendSel.extendSel5"/>
        <id column="EXT_SEL_6" property="quotReqInfo.detailExtItem.extendSel.extendSel6"/>
        <id column="EXT_SEL_7" property="quotReqInfo.detailExtItem.extendSel.extendSel7"/>
        <id column="EXT_SEL_8" property="quotReqInfo.detailExtItem.extendSel.extendSel8"/>
        <id column="EXT_SEL_9" property="quotReqInfo.detailExtItem.extendSel.extendSel9"/>
        <id column="EXT_SEL_10" property="quotReqInfo.detailExtItem.extendSel.extendSel10"/>
        <id column="EXT_CHK_1" property="quotReqInfo.detailExtItem.extendChk.extendChk1"/>
        <id column="EXT_CHK_2" property="quotReqInfo.detailExtItem.extendChk.extendChk2"/>
        <id column="EXT_CHK_3" property="quotReqInfo.detailExtItem.extendChk.extendChk3"/>
        <id column="EXT_CHK_4" property="quotReqInfo.detailExtItem.extendChk.extendChk4"/>
        <id column="EXT_CHK_5" property="quotReqInfo.detailExtItem.extendChk.extendChk5"/>
        <id column="EXT_FILE_1" property="quotReqInfo.detailExtItem.extendFile.extendFile1.fileName"/>
        <id column="EXT_FILE_2" property="quotReqInfo.detailExtItem.extendFile.extendFile2.fileName"/>
        <id column="EXT_FILE_3" property="quotReqInfo.detailExtItem.extendFile.extendFile3.fileName"/>
        <id column="EXT_FILE_BINARY_1" property="quotReqInfo.detailExtItem.extendFile.extendFile1.binary"/>
        <id column="EXT_FILE_BINARY_2" property="quotReqInfo.detailExtItem.extendFile.extendFile2.binary"/>
        <id column="EXT_FILE_BINARY_3" property="quotReqInfo.detailExtItem.extendFile.extendFile3.binary"/>
        <id column="EXT_MST_1" property="quotReqInfo.detailExtItem.extendMst.extendMst1.mstKey"/>
        <id column="EXT_MST_2" property="quotReqInfo.detailExtItem.extendMst.extendMst2.mstKey"/>
        <id column="EXT_MST_3" property="quotReqInfo.detailExtItem.extendMst.extendMst3.mstKey"/>
        <id column="EXT_MST_4" property="quotReqInfo.detailExtItem.extendMst.extendMst4.mstKey"/>
        <id column="EXT_MST_5" property="quotReqInfo.detailExtItem.extendMst.extendMst5.mstKey"/>
        <id column="EXT_MST_6" property="quotReqInfo.detailExtItem.extendMst.extendMst6.mstKey"/>
        <id column="EXT_MST_7" property="quotReqInfo.detailExtItem.extendMst.extendMst7.mstKey"/>
        <id column="EXT_MST_8" property="quotReqInfo.detailExtItem.extendMst.extendMst8.mstKey"/>
        <id column="EXT_MST_NAME_1" property="quotReqInfo.detailExtItem.extendMst.extendMst1.mstName"/>
        <id column="EXT_MST_NAME_2" property="quotReqInfo.detailExtItem.extendMst.extendMst2.mstName"/>
        <id column="EXT_MST_NAME_3" property="quotReqInfo.detailExtItem.extendMst.extendMst3.mstName"/>
        <id column="EXT_MST_NAME_4" property="quotReqInfo.detailExtItem.extendMst.extendMst4.mstName"/>
        <id column="EXT_MST_NAME_5" property="quotReqInfo.detailExtItem.extendMst.extendMst5.mstName"/>
        <id column="EXT_MST_NAME_6" property="quotReqInfo.detailExtItem.extendMst.extendMst6.mstName"/>
        <id column="EXT_MST_NAME_7" property="quotReqInfo.detailExtItem.extendMst.extendMst7.mstName"/>
        <id column="EXT_MST_NAME_8" property="quotReqInfo.detailExtItem.extendMst.extendMst8.mstName"/>
    </resultMap>

    <!--見積回答詳細画面(プルダウン選択時)の見積依頼情報取得SQL -->
    <select id="searchQuotReqForRefreshDtl" resultMap="QuotRespDetail_Map">
        <include refid="selectQuotReqDetail" />
        FROM
            T_QUOT_REQUEST
        LEFT JOIN T_QUOT_ADO_REQUEST ON
           T_QUOT_REQUEST.QUOT_REQ_SEQ = T_QUOT_ADO_REQUEST.QUOT_REQ_SEQ
           AND T_QUOT_ADO_REQUEST.DELETE_FLG = '0'
        LEFT JOIN T_ATTACH_MNG T_ATTACH_MNG_A ON
           T_QUOT_REQUEST.ATTACH_FILE_SEQ1 = T_ATTACH_MNG_A.ATTACH_FILE_SEQ
            AND T_ATTACH_MNG_A.DELETE_FLG = '0'
        LEFT JOIN T_ATTACH_MNG T_ATTACH_MNG_B ON
           T_QUOT_REQUEST.ATTACH_FILE_SEQ2 = T_ATTACH_MNG_B.ATTACH_FILE_SEQ
            AND T_ATTACH_MNG_B.DELETE_FLG = '0'
        LEFT JOIN T_ATTACH_MNG T_ATTACH_MNG_C ON 
           T_QUOT_ADO_REQUEST.ATTACH_FILE_SEQ = T_ATTACH_MNG_C.ATTACH_FILE_SEQ 
           AND T_ATTACH_MNG_C.DELETE_FLG = '0'
        WHERE
            T_QUOT_REQUEST.QUOT_REQ_SEQ = #{quotReqNo}
            AND T_QUOT_REQUEST.DELETE_FLG = '0'
    </select>
    <!--見積回答詳細画面(プルダウン選択時)の見積依頼情報取得SQL -->
    <select id="serchQuotReqVersion" resultType="fw.common.cache.ListItem">
        SELECT
            T_QUOT_REQUEST.QUOT_REQ_SEQ AS "value",
            T_QUOT_REQUEST.QUOT_REQ_VERSION AS "text"
        FROM
            T_QUOT_REQUEST
        WHERE
            T_QUOT_REQUEST.QUOT_REQ_NO = #{quotReqNo}
            AND DELETE_FLG = '0'
        ORDER BY T_QUOT_REQUEST.QUOT_REQ_VERSION DESC
    </select>

    <!--見積回答詳細画面の見積取得申請情報取得SQL -->
    <select id="searchQuotAcqAplForDetail" resultMap="QuotReqInfo_Map">
        SELECT
            T_QUOT_ACQ_APL.FOR_BUYER_COMMENT,
            T_QUOT_ACQ_APL.SUP_CD,
            T_QUOT_ACQ_APL.SUP_ABBR_NAME,
            T_QUOT_ACQ_APL.SUP_COMPANY_CD,
            T_QUOT_ACQ_APL.PRICE_REQ_FLG
        FROM
            T_QUOT_ACQ_APL
        WHERE
            T_QUOT_ACQ_APL.QUOT_ACQ_APL_NO = #{quotAcqAplNo}
        AND T_QUOT_ACQ_APL.NEW_FLG = '1'
        AND T_QUOT_ACQ_APL.NEW_APP_FLG = '1'
        AND T_QUOT_ACQ_APL.DELETE_FLG = '0'
    </select>
    <resultMap type="fw.domain.slip.quot.quotreq.quotdetail.QuotReqInfo" id="QuotReqInfo_Map">
        <id column="FOR_BUYER_COMMENT" property="forBuyerComment"/>
        <id column="SUP_CD" property="hopeSupplier.hopeSupplier.supCd"/>
        <id column="SUP_ABBR_NAME" property="hopeSupplier.hopeSupplier.supplierName.supplierAbbrName"/>
        <id column="SUP_COMPANY_CD" property="hopeSupplier.hopeSupplier.supCompanyCd"/>
        <id column="PRICE_REQ_FLG" property="priceRegisterFlg.priceRegisterFlg"/>
    </resultMap>

    <!--見積回答詳細画面の見積依頼明細情報取得SQL -->
    <select id="searchQuotReqDtlForDetail" resultMap="QuotReqInfoItem_Map">
        SELECT
            T_QUOT_REQ_DTL.QUOT_REQ_SEQ,
            T_QUOT_REQ_DTL.QUOT_REQ_DTL_NO,
            T_QUOT_REQ_DTL.CURRENCY_CD,
            T_QUOT_REQ_DTL.QUOT_REQ_AMOUNT,
            T_QUOT_REQ_DTL.ITEM_CD,
            T_QUOT_REQ_DTL.ITEM_NAME,
            T_QUOT_REQ_DTL.KATASHIKI,
            T_QUOT_REQ_DTL.MANUFACT_CD,
            T_QUOT_REQ_DTL.MANUFACT_NAME,
            T_QUOT_REQ_DTL.REQ_DELIV_DATE,
            T_QUOT_REQ_DTL.UNIT_PRICE,
            T_QUOT_REQ_DTL.QUOT_REQ_VOL,
            T_QUOT_REQ_DTL.UNIT_NAME,
            T_ATTACH_MNG.ATTACH_FILE_NAME,
            T_ATTACH_MNG.ATTACH_FILE_SEQ,
            T_ATTACH_MNG.ATTACH_SCOPE,
            ${@ps.common.util.ItemSettingUtil@getItemSettingSelectSQL("T_QUOT_REQ_DTL")}
        FROM
            T_QUOT_REQ_DTL
        LEFT JOIN T_ATTACH_MNG ON
            T_QUOT_REQ_DTL.ATTACH_FILE_SEQ = T_ATTACH_MNG.ATTACH_FILE_SEQ
            AND T_ATTACH_MNG.DELETE_FLG = '0'
        WHERE
            T_QUOT_REQ_DTL.QUOT_REQ_SEQ = #{quotReqSeq}
        ORDER BY
            T_QUOT_REQ_DTL.QUOT_REQ_DTL_NO
    </select>
    <resultMap type="fw.domain.slip.quot.quotreq.quotdetail.QuotReqInfoItem" id="QuotReqInfoItem_Map">
        <id column="QUOT_REQ_SEQ" property="quotReqItemIdentify.quotReqIdentify.quotReqSeqNo.seqNumber"/>
        <id column="QUOT_REQ_DTL_NO" property="quotReqItemIdentify.detailedNumber"/>
        <id column="CURRENCY_CD" property="currency.currencyCd"/>
        <id column="QUOT_REQ_AMOUNT" property="amount.amount"/>
        <id column="ITEM_CD" property="itemCd"/>
        <id column="ITEM_NAME" property="itemName"/>
        <id column="KATASHIKI" property="katashiki"/>
        <id column="MANUFACT_CD" property="manufact.manufactCd"/>
        <id column="MANUFACT_NAME" property="manufact.manufactName"/>
        <id column="REQ_DELIV_DATE" property="delivDate.dateOfymd"/>
        <id column="UNIT_PRICE" property="unitPrice.amount.amount"/>
        <id column="QUOT_REQ_VOL" property="vol.vol"/>
        <id column="UNIT_NAME" property="unitName"/>
        <id column="ATTACH_FILE_NAME" property="attachFileLink.fileName"/>
        <id column="ATTACH_FILE_SEQ" property="attachFileLink.seqNo"/>
        <id column="ATTACH_SCOPE" property="attachRange.attachRange"/>
        <id column="EXT_TXT_1" property="detailExtItem.extendTxt.extendTxt1"/>
        <id column="EXT_TXT_2" property="detailExtItem.extendTxt.extendTxt2"/>
        <id column="EXT_TXT_3" property="detailExtItem.extendTxt.extendTxt3"/>
        <id column="EXT_TXT_4" property="detailExtItem.extendTxt.extendTxt4"/>
        <id column="EXT_TXT_5" property="detailExtItem.extendTxt.extendTxt5"/>
        <id column="EXT_TXT_6" property="detailExtItem.extendTxt.extendTxt6"/>
        <id column="EXT_TXT_7" property="detailExtItem.extendTxt.extendTxt7"/>
        <id column="EXT_TXT_8" property="detailExtItem.extendTxt.extendTxt8"/>
        <id column="EXT_TXT_9" property="detailExtItem.extendTxt.extendTxt9"/>
        <id column="EXT_TXT_10" property="detailExtItem.extendTxt.extendTxt10"/>
        <id column="EXT_AREA_1" property="detailExtItem.extendArea.extendArea1"/>
        <id column="EXT_AREA_2" property="detailExtItem.extendArea.extendArea2"/>
        <id column="EXT_AREA_3" property="detailExtItem.extendArea.extendArea3"/>
        <id column="EXT_AREA_4" property="detailExtItem.extendArea.extendArea4"/>
        <id column="EXT_AREA_5" property="detailExtItem.extendArea.extendArea5"/>
        <id column="EXT_DATE_1" property="detailExtItem.extendDate.extendDate1.dateOfymd"/>
        <id column="EXT_DATE_2" property="detailExtItem.extendDate.extendDate2.dateOfymd"/>
        <id column="EXT_DATE_3" property="detailExtItem.extendDate.extendDate3.dateOfymd"/>
        <id column="EXT_DATE_4" property="detailExtItem.extendDate.extendDate4.dateOfymd"/>
        <id column="EXT_DATE_5" property="detailExtItem.extendDate.extendDate5.dateOfymd"/>
        <id column="EXT_INT_1" property="detailExtItem.extendInt.extendInt1.value"/>
        <id column="EXT_INT_2" property="detailExtItem.extendInt.extendInt2.value"/>
        <id column="EXT_INT_3" property="detailExtItem.extendInt.extendInt3.value"/>
        <id column="EXT_INT_4" property="detailExtItem.extendInt.extendInt4.value"/>
        <id column="EXT_INT_5" property="detailExtItem.extendInt.extendInt5.value"/>
        <id column="EXT_INT_6" property="detailExtItem.extendInt.extendInt6.value"/>
        <id column="EXT_INT_7" property="detailExtItem.extendInt.extendInt7.value"/>
        <id column="EXT_INT_8" property="detailExtItem.extendInt.extendInt8.value"/>
        <id column="EXT_INT_9" property="detailExtItem.extendInt.extendInt9.value"/>
        <id column="EXT_INT_10" property="detailExtItem.extendInt.extendInt10.value"/>
        <id column="EXT_DEC_1" property="detailExtItem.extendDec.extendDec1.value"/>
        <id column="EXT_DEC_2" property="detailExtItem.extendDec.extendDec2.value"/>
        <id column="EXT_DEC_3" property="detailExtItem.extendDec.extendDec3.value"/>
        <id column="EXT_DEC_4" property="detailExtItem.extendDec.extendDec4.value"/>
        <id column="EXT_DEC_5" property="detailExtItem.extendDec.extendDec5.value"/>
        <id column="EXT_SEL_1" property="detailExtItem.extendSel.extendSel1"/>
        <id column="EXT_SEL_2" property="detailExtItem.extendSel.extendSel2"/>
        <id column="EXT_SEL_3" property="detailExtItem.extendSel.extendSel3"/>
        <id column="EXT_SEL_4" property="detailExtItem.extendSel.extendSel4"/>
        <id column="EXT_SEL_5" property="detailExtItem.extendSel.extendSel5"/>
        <id column="EXT_SEL_6" property="detailExtItem.extendSel.extendSel6"/>
        <id column="EXT_SEL_7" property="detailExtItem.extendSel.extendSel7"/>
        <id column="EXT_SEL_8" property="detailExtItem.extendSel.extendSel8"/>
        <id column="EXT_SEL_9" property="detailExtItem.extendSel.extendSel9"/>
        <id column="EXT_SEL_10" property="detailExtItem.extendSel.extendSel10"/>
        <id column="EXT_CHK_1" property="detailExtItem.extendChk.extendChk1"/>
        <id column="EXT_CHK_2" property="detailExtItem.extendChk.extendChk2"/>
        <id column="EXT_CHK_3" property="detailExtItem.extendChk.extendChk3"/>
        <id column="EXT_CHK_4" property="detailExtItem.extendChk.extendChk4"/>
        <id column="EXT_CHK_5" property="detailExtItem.extendChk.extendChk5"/>
        <id column="EXT_FILE_1" property="detailExtItem.extendFile.extendFile1.fileName"/>
        <id column="EXT_FILE_2" property="detailExtItem.extendFile.extendFile2.fileName"/>
        <id column="EXT_FILE_3" property="detailExtItem.extendFile.extendFile3.fileName"/>
        <id column="EXT_FILE_BINARY_1" property="detailExtItem.extendFile.extendFile1.binary"/>
        <id column="EXT_FILE_BINARY_2" property="detailExtItem.extendFile.extendFile2.binary"/>
        <id column="EXT_FILE_BINARY_3" property="detailExtItem.extendFile.extendFile3.binary"/>
        <id column="EXT_MST_1" property="detailExtItem.extendMst.extendMst1.mstKey"/>
        <id column="EXT_MST_2" property="detailExtItem.extendMst.extendMst2.mstKey"/>
        <id column="EXT_MST_3" property="detailExtItem.extendMst.extendMst3.mstKey"/>
        <id column="EXT_MST_4" property="detailExtItem.extendMst.extendMst4.mstKey"/>
        <id column="EXT_MST_5" property="detailExtItem.extendMst.extendMst5.mstKey"/>
        <id column="EXT_MST_6" property="detailExtItem.extendMst.extendMst6.mstKey"/>
        <id column="EXT_MST_7" property="detailExtItem.extendMst.extendMst7.mstKey"/>
        <id column="EXT_MST_8" property="detailExtItem.extendMst.extendMst8.mstKey"/>
        <id column="EXT_MST_NAME_1" property="detailExtItem.extendMst.extendMst1.mstName"/>
        <id column="EXT_MST_NAME_2" property="detailExtItem.extendMst.extendMst2.mstName"/>
        <id column="EXT_MST_NAME_3" property="detailExtItem.extendMst.extendMst3.mstName"/>
        <id column="EXT_MST_NAME_4" property="detailExtItem.extendMst.extendMst4.mstName"/>
        <id column="EXT_MST_NAME_5" property="detailExtItem.extendMst.extendMst5.mstName"/>
        <id column="EXT_MST_NAME_6" property="detailExtItem.extendMst.extendMst6.mstName"/>
        <id column="EXT_MST_NAME_7" property="detailExtItem.extendMst.extendMst7.mstName"/>
        <id column="EXT_MST_NAME_8" property="detailExtItem.extendMst.extendMst8.mstName"/>
    </resultMap>

    <!--見積回答詳細画面の見積依頼取引先情報取得SQL -->
    <select id="searchQuotReqSupForDetail" resultMap="QuotSupResp_Map">
        SELECT
            T_QUOT_RESPONSE.QUOT_RESP_SEQ,
            T_QUOT_RESPONSE.QUOT_WITHDRAW_ID,
            T_QUOT_RESPONSE.RESP_CONF_FLG,
            T_QUOT_RESPONSE.QUOT_ADO_IND,
            T_QUOT_RESPONSE.RESP_OPEN_FLG,
            T_QUOT_RESPONSE.QUOT_RESP_END_DATE,
            T_QUOT_RESPONSE.QUOT_RESP_DATE,
            T_QUOT_RESPONSE.QUOT_RESP_COMMENT,
            T_QUOT_REQ_SUP.QUOT_SUP_LINE_NO,
            CASE 
                WHEN T_QUOT_RESPONSE.QUOT_RESP_SEQ IS NOT NULL THEN '02'
                ELSE '01'
            END as QUOT_SUP_STATUS,
            T_QUOT_REQ_SUP.CORRECT_CD,
            T_QUOT_REQ_SUP.EDI_IND,
            T_QUOT_REQ_SUP.QUOT_REQ_SEND_IND,
            T_QUOT_REQ_SUP.SUP_CD,
            T_QUOT_REQ_SUP.SUP_ABBR_NAME,
            T_QUOT_REQ_SUP.SUBCON_IND,
            T_QUOT_REQ_SUP.QUOT_REQ_DATE
        FROM
            T_QUOT_REQ_SUP
        LEFT JOIN T_QUOT_RESPONSE ON
            T_QUOT_REQ_SUP.QUOT_REQ_NO = T_QUOT_RESPONSE.QUOT_REQ_NO
            AND T_QUOT_REQ_SUP.QUOT_REQ_VERSION = T_QUOT_RESPONSE.QUOT_REQ_VERSION
            AND T_QUOT_REQ_SUP.QUOT_SUP_LINE_NO = T_QUOT_RESPONSE.QUOT_SUP_LINE_NO
            AND T_QUOT_RESPONSE.DELETE_FLG = '0'
        WHERE
            T_QUOT_REQ_SUP.QUOT_REQ_SEQ = #{quotReqSeq}
         AND
            T_QUOT_REQ_SUP.DELETE_FLG = '0'
        ORDER BY T_QUOT_REQ_SUP.QUOT_SUP_LINE_NO
    </select>
    <resultMap type="fw.domain.slip.quot.quotresp.quotrespdetail.QuotSupplierResp" id="QuotSupResp_Map">
        <id column="QUOT_RESP_SEQ" property="quotRespSeqNo"/>
        <id column="QUOT_WITHDRAW_ID" property="status"/>
        <id column="RESP_CONF_FLG" property="respConfFlg"/>
        <id column="QUOT_ADO_IND" property="ado"/>
        <id column="RESP_OPEN_FLG" property="respOpen"/>
        <id column="QUOT_RESP_END_DATE" property="quotEndDate.dateOfymd"/>
        <id column="QUOT_RESP_DATE" property="respDate.dateOfymd"/>
        <id column="QUOT_RESP_COMMENT" property="respComments"/>
        <id column="QUOT_SUP_LINE_NO" property="quotSupplierLineNo"/>
        <id column="QUOT_SUP_STATUS" property="quotReqSupplierStatus"/>
        <id column="CORRECT_CD" property="correctCd"/>
        <id column="EDI_IND" property="ediInd"/>
        <id column="QUOT_REQ_SEND_IND" property="dataInd.quotReqSendInd.sendInd"/>
        <id column="SUP_CD" property="supplier.supCd"/>
        <id column="SUP_ABBR_NAME" property="supplier.supplierName.supplierAbbrName"/>
        <id column="SUBCON_IND" property="supplier.subcon.subconInd"/>
        <id column="QUOT_REQ_DATE" property="quotReqDate.dateOfymd"/>
    </resultMap>

    <!-- 2015/06/17 ADD RIKI_SUGIYAMA START -->
    <!--見積回答添付テーブルの登録SQL -->
    <insert id="insertQuotRespAttachFile" parameterType="fw.domain.slip.common.attachfile.AttachFile">
        INSERT INTO T_QUOT_RESP_ATTACH
            (
            ATTACH_FILE_SEQ,
            ATTACH_FILE_NAME,
            ATTACH_FILE,
            ATTACH_FILE_SIZE,
            DELETE_FLG,
            LAST_UPD_DATE,
            LAST_UPD_COMPANY_CD,
            LAST_UPD_SECTION_CD,
            LAST_UPD_USER_ID,
            REG_DATE,
            REG_COMPANY_CD,
            REG_SECTION_CD,
            REG_USER_ID
            )
        VALUES
            (
            #{attachFile.seqNo},
            #{attachFile.fileName},
            #{attachFile.compressData},
            #{attachFile.size},
            '0',
            '${@fw.common.util.AppUtil@getSysDateYyyyMMddHHmmssSSS()}',
            '${@fw.security.SecurityUtil@getCompanyCdByEscapeSql()}',
            '${@fw.security.SecurityUtil@getDefaultSectionCdByEscapeSql()}',
            '${@fw.security.SecurityUtil@getUserIdByEscapeSql()}',
            '${@fw.common.util.AppUtil@getSysDateYyyyMMddHHmmssSSS()}',
            '${@fw.security.SecurityUtil@getCompanyCdByEscapeSql()}',
            '${@fw.security.SecurityUtil@getDefaultSectionCdByEscapeSql()}',
            '${@fw.security.SecurityUtil@getUserIdByEscapeSql()}'
            )
    </insert>

    <!--見積回答明細テーブルの登録SQL -->
    <insert id="insertQuotRespDetail" parameterType="Map">
        INSERT INTO T_QUOT_RESP_DTL
            (
            QUOT_RESP_SEQ,
            QUOT_REQ_DTL_NO,
            QUOT_REQ_NO,
            QUOT_REQ_VERSION,
            QUOT_SUP_LINE_NO,
            ITEM_COMPANY_CD,
            ITEM_CD,
            QUOT_RESP_ITEM_NAME,
            QUOT_RESP_KATASHIKI,
            QUOT_RESP_MANUFACT_CD,
            QUOT_RESP_MANUFACT_NAME,
            QUOT_RESP_DELIV_DATE,
            CURRENCY_CD,
            TAX_IND,
            CONSUMPT_IND,
            QUOT_RESP_VOL,
            UNIT_CD,
            UNIT_NAME,
            UNIT_PRICE,
            QUOT_RESP_AMOUNT,
            CONSUMPT_AMOUNT,
            TOTAL_AMOUNT,
            LOWER_VOL1,
            LOWER_VOL2,
            LOWER_VOL3,
            LOWER_VOL4,
            LOWER_VOL5,
            QUOT_RESP_PRICE1,
            QUOT_RESP_PRICE2,
            QUOT_RESP_PRICE3,
            QUOT_RESP_PRICE4,
            QUOT_RESP_PRICE5,
            ORDER_LT,
            ORDER_UNIT_VOL,
            MIN_ORDER_VOL,
            VALID_START_DATE,
            VALID_END_DATE,
            ATTACH_FILE_SEQ,
            ATTACH_FILE_SEQ2,
            DELETE_FLG,
            AUTO_DELETE_FLG,
            AUTO_DELETE_DATE,
            LAST_UPD_DATE,
            LAST_UPD_COMPANY_CD,
            LAST_UPD_SECTION_CD,
            LAST_UPD_USER_ID,
            REG_DATE,
            REG_COMPANY_CD,
            REG_SECTION_CD,
            REG_USER_ID
            )
        VALUES
            (
            #{quotRespSeq},
            #{quotRespItem.quotRespItemIdentify.quotReqItemNo},
            #{quotReqNo},
            #{historyNo},
            #{quotSupplierLineNo},
            #{quotRespItem.itemName.itemCompanyCd},
            #{quotRespItem.itemName.itemCd},
            #{quotRespItem.itemName.itemName},
            #{quotRespItem.itemName.katashiki},
            #{quotRespItem.itemName.manufact.manufactCd},
            #{quotRespItem.itemName.manufact.manufactName},
            #{quotRespItem.respDlvEst.respDlvEst.dateOfymd},
            #{quotRespItem.amountMng.currency.currencyCd},
            #{quotRespItem.amountMng.taxCalculationInd.taxInd.taxInd},
            '2',
            '${@fw.common.util.AppUtil@deleteComma(quotRespItem.respVol.respVol.vol)}',
            #{quotRespItem.itemName.unit.unitCd},
            #{quotRespItem.itemName.unit.unitName},
            '${@fw.common.util.AppUtil@deleteComma(quotRespItem.respPrice.respPrice.amount)}',
            #{quotRespItem.respAmount.respAmount.amount},
            '${@fw.common.util.AppUtil@deleteComma(quotRespItem.amountMng.consumptAmount.consumptAmount.amount)}',
            #{quotRespItem.amountMng.totalAmount.totalAmount.amount},
            '',
            '',
            '',
            '',
            '',
            '',
            '',
            '',
            '',
            '',
            #{quotRespItem.orderDeliv.standardDelivDayCount.standardDelivDayCount.dayCount},
            '',
            '',
            '',
            '',
             #{quotRespItem.attachFile.seqNo},
             #{quotRespItem.attachFile2.seqNo},
            '0',
            '0',
            '',
            '${@fw.common.util.AppUtil@getSysDateYyyyMMddHHmmssSSS()}',
            '${@fw.security.SecurityUtil@getCompanyCdByEscapeSql()}',
            '${@fw.security.SecurityUtil@getDefaultSectionCdByEscapeSql()}',
            '${@fw.security.SecurityUtil@getUserIdByEscapeSql()}',
            '${@fw.common.util.AppUtil@getSysDateYyyyMMddHHmmssSSS()}',
            '${@fw.security.SecurityUtil@getCompanyCdByEscapeSql()}',
            '${@fw.security.SecurityUtil@getDefaultSectionCdByEscapeSql()}',
            '${@fw.security.SecurityUtil@getUserIdByEscapeSql()}'
            )
    </insert>
    <!-- 2015/06/17 ADD RIKI_SUGIYAMA END -->
</mapper>