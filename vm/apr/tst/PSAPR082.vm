<!doctype html>
<HTML LANG="ja">
<head>
<title>#customSpringMessage('INS_APP')</title><!--検査承認-->
<meta http-equiv="Content-type" content="text/html; charset=UTF-8">
<meta http-equiv="Pragma" content="no-cache">
<meta http-equiv="Content-script-type" content="text/javascript">
<link id="CSS_FONT" rel="stylesheet" href="../../include/FontS.css" type="text/css">
<link rel="stylesheet" href="../../include/Layout.css" type="text/css">
<link rel="stylesheet" href="../../include/Color.css" type="text/css">
<link rel="stylesheet" href="../../include/searchbox.css" type="text/css">
<script language="javascript" type="text/javascript" src="../../include/common.js"></script>
<script language="javascript" type="text/javascript" src="../../include/check.js"></script>
<script language="javascript" type="text/javascript" src="../../include/date.js"></script>
<script language="javascript" type="text/javascript" src="../../include/tablesort.js"></script>
<script language="javascript" type="text/javascript" src="../../include/searchbox.js"></script>
<script language="javascript" type="text/javascript" src="../../include/jquery-1.7.2.min.js"></script>
<script language="javascript" type="text/javascript">
<!--
#set($isActiveProfileStock = "#isActiveProfile('stock')")
#parse("./common/common_js.vm")
#set($commonTitle = "#customSpringMessage('INS_APP')")
var isFinalAppUser = "false";
var isClickable = false;
function onLoad() {
    //setFocusForInput();
    top.document.title = document.title;
    //承認者情報の初期化 
    initAuthorizerInfo();
    var alertMessage = "$!alertMessage";
    if (alertMessage != ""){
        alert(alertMessage);
        if(alertMessage.indexOf("#customSpringMessage('E035')") != -1){
            buttonDisable();
            parent.iframeChange("${flowExecutionUrl}&_eventId=next");
            return;
        }   
    }
    var errorMsg = "$!errorMessage";
    if (errorMsg == ""){
        var isSuccessForApproval = '#jsEscape($!isSuccessForApproval)';
        if(isSuccessForApproval == 'true'){
            #set( $inspection = "#customSpringMessage('INSPECTION')")
            alert('#customMessageArgs("I028",[$!inspection])');
            buttonDisable();
            parent.iframeChange("${flowExecutionUrl}&_eventId=next");
            return;
        }
        var isSuccessForSendBack = '#jsEscape($!isSuccessForSendBack)';
        if(isSuccessForSendBack == 'true'){
            #set( $inspection = "#customSpringMessage('INSPECTION')")
            alert('#customMessageArgs("I029",[$!inspection])');
            buttonDisable();
            parent.iframeChange("${flowExecutionUrl}&_eventId=next");
            return;
        }
    }
    else{
        document.getElementById("TR_ERROR").style.display = "";
    }
    approvalPaging();
    isClickable = true;
}
//差戻し
function sendBack(){
    if(!isClickable) {
        return;
    }
    #set( $mmInspection = "#customSpringMessage('INSPECTION')" )
    #set( $appOval = "#customSpringMessage('RETURN')" )
    if( !confirm("#customMessageArgs("W001",[$mmInspection,$appOval])") ) {
        return;
    }
    buttonDisable();
    getObj("Body").action="${flowExecutionUrl}&_eventId=sendBack";
    getObj("Body").submit();
}
//承認
function approval(){
    if(!isClickable) {
        return;
    }
    valLastAppUser();
    #set( $mmInspection = "#customSpringMessage('INSPECTION')" )
    
    #set( $appOval = "#customSpringMessage('APPROVAL')" )
    if( !confirm("#customMessageArgs("W001",[$mmInspection,$appOval])") ) {
        return;
    }
    buttonDisable();
    getObj("Body").action="${flowExecutionUrl}&_eventId=approval&isFinalAppUser="+isFinalAppUser;
    getObj("Body").submit();
}
function forward() {
    setDisplay("DetailArea",false);
    setDisplay("ForwardArea",true);
    getObj("DetailTab").className = "DetailTabsOff";
    getObj("ForwardTab").className = "DetailTabsOn";
    getObj("Detail").href = "javascript:detail();";
    parent.adjustArea(ROWNUM);
}
function detail() {
    setDisplay("DetailArea",true);
    setDisplay("ForwardArea",false);
    getObj("DetailTab").className = "DetailTabsOn";
    getObj("ForwardTab").className = "DetailTabsOff";
    getObj("Forward").href = "javascript:forward();";
    parent.adjustArea(ROWNUM);
}
function changeFontSize() {
    changeFontSize0();
    getObj("DATAAREA").contentWindow.changeFontSize();
}
//承認者の削除
function removeAuthorizer(obj) {
    if(!isClickable) {
        return;
    }
    var appSeq = obj.parentNode.parentNode.children[0].children[0].innerHTML;
    getObj("Body").action="${flowExecutionUrl}&_eventId=removeAuthorizer&appSeq="+appSeq;
    getObj("Body").submit();
}
//承認者の追加
function addAuthorizer() {
    if(!isClickable) {
        return;
    }
    buttonDisable();
    getObj("Body").action="${flowExecutionUrl}&_eventId=addAuthorizer";
    getObj("Body").submit();
}
//承認者情報の初期化 
function initAuthorizerInfo(){
    var oTableAuthor = document.getElementById( "authorizer" );
    var tableRowNum = oTableAuthor.rows.length;
    var count = 0;
    for(var i=0;i<tableRowNum-1;i++){
        if(i%2==0){
            var curTR=oTableAuthor.rows[i]; 
            var no = curTR.children[0].innerHTML;
            if("#customSpringMessage('APPROVAL')"!=curTR.children[3].children[0].innerHTML && "#customSpringMessage('RETURN')"!=curTR.children[3].children[0].innerHTML){
                count++;
                var currentAppUserNo = no;
                if(count == 1){
                     valLastAppUser(tableRowNum,currentAppUserNo);
                }
                
            }
        }
    }
}
//最終承認者であるかどうかをチェックする
function valLastAppUser(tableRowNum,currentAppUserNo){
    var lastNo = tableRowNum/2;
    if(lastNo == currentAppUserNo){
        isFinalAppUser = "true";
    }else{
        isFinalAppUser = "false";
    }
}
//承認者を検索
function searchAuthorizer() {
    var userId = getObj('inspect.appManagement.appList.appUserName.userID');
    var userName = getObj('inspect.appManagement.appList.appUserName.userName');
    var sectionCd = getObj('inspect.appManagement.appList.appUserName.section.sectionCd');
    var sectionName = getObj('inspect.appManagement.appList.appUserName.section.sectionName');
    var officialName = getObj('inspect.appManagement.appList.appUserName.official.officialName');
    var sectionPlaceCd = getObj('inspect.appManagement.appList.appUserName.section.sectionPlace.sectionPlaceCd');
    var sectionPlaceName = getObj('inspect.appManagement.appList.appUserName.section.sectionPlace.sectionPlaceName');
    var mail = getObj('inspect.appManagement.appList.appUserName.mailAddr.mail');
    var extensionNo = getObj('inspect.appManagement.appList.appUserName.extNo.extensionNo');
    var externalNo = getObj('inspect.appManagement.appList.appUserName.externalNo.externalNo');
    userPopup.setObject(userId, userName, sectionCd, sectionName, officialName, sectionPlaceCd, sectionPlaceName, mail, extensionNo, externalNo); 
    masterSearch('../../src/userPopup/search?pageid=userPopupSearch&popupPageid=PSAPR082','UserSearch','750','500');
}
function downloadExt(filename, file) {
    iframeChange("${flowExecutionUrl}&_eventId=downloadext", 'filename', filename, 'file', file);
}
//-->
</script>
<style> 
table.HomeBox {
    background-color:#FFFFFF;
    border: 1px solid #333333;
    -moz-border-radius: 16px;
    -webkit-border-radius: 16px;
    border-radius: 16px;
    behavior: url("../../include/ie-css3.htc");
    zoom:1;
    position: relative;
    z-index:200;
    padding:16px;
    box-shadow: 3px 3px 0px #000000;
    margin-left:auto;
    margin-right:auto;
}
</style>
</head>
<body topmargin="0" leftmargin="0" marginwidth="0" marginheight="0" align="center"" style="overflow:hidden" onload="onLoad();">
<form name="Body" id="Body" method="post">
    <table class="SearchBody">
        <tr>
            <td id="SEARCH_AREA" class="SearchArea" height="10%"><!-- onLoadで変更 -->
                #parse("./common/common_title_tran_with_individual_approval.vm")
            </td>
        </tr>
        <tr><td class="NoBorder" style="height:auto; background-color:#CCC;" align = "center" valign="top" >
             <div id="Area" style="OVERFLOW-Y: scroll;HEIGHT: 100%;display:none;">
            <table class="HomeBox">
                    <tr>
                        <td style="padding:50px,15px,0px,15px">
                            <table class="NoBorder">
                                <tr>
                                    <td align="left">
                                        <table class="NoBorder" width="98%">
                                            <tr>
                                                <td>
                                                    <u><img src="../../image/mrkCircle.gif"><span id="StepTitle" class="FontStepTitle">#customSpringMessage('INS_APP')</span></u><br><br><!--検査承認-->
                                                    <span id="ReqNo" class="FontSmallBold DarkBlue">#customSpringMessage('PSAPR082_HEADER_COMMENT')</span>
                                                </td>
                                                <td align="right" valign="middle">
                                                    <input type="button" class="LargeButton Red" value="#customSpringMessage('RETURN')" onclick="sendBack();">&nbsp;&nbsp;
                                                    <input id="button" type="button" class="LargeButton" value="#customSpringMessage('APPROVAL')" onclick="javascript:approval();"> <!-- 差戻し--> <!-- 承認--> 
                                                </td>
                                            </tr>
                                 <tr id ="TR_ERROR" style="display:none;"><td class="error" style="height:0px;">
                                    $!errorMessage
                                </td></tr>
                                        </table>
                                        <br>
                                        $!PSAPR082PageCreater.build('upd','_td_style_right', 'class="Box1D FontSmallAnk"', '_td_style_left','class="Box1H FontBoxHeader"')
                                        <table class="NoBorder Box1G" width="100%">
                                            <tbody>
                                                <tr>
                                                    <td nowrap class="Box1H FontBoxHeader">#customSpringMessage('DELIV_KEY_NO')</td><!--納品キー番号-->
                                                    <td nowrap class="Box1D FontSmallAnk"><span class="FontSlipNo">#out($!domain.inspect.delivKeyNo.delivKeyNo)</span></td>
                                                </tr>
                                                <tr>
                                                    <td nowrap class="Box1H FontBoxHeader">#customSpringMessage('CORRECT_NAME')</td><!-- 訂正コード -->
                                                    #if($!domain.inspect.rbInd.rbInd=="1")
                                                    <td nowrap class="Box1D FontStatus Red">#out($!domain.inspect.correctInd.correctInd_PageValue)</td>
                                                    #else
                                                    <td nowrap class="Box1D FontSmallAnk">#out($!domain.inspect.correctInd.correctInd_PageValue)</td>
                                                    #end
                                                </tr>
                                                <tr>
                                                    <td nowrap class="Box1H FontBoxHeader">#customSpringMessage('REVISION_NUMBER')</td><!--履歴番号 -->
                                                    <td nowrap class="Box1D FontSmallAnk">#out($!domain.inspect.historyNo.historyNo)</td>
                                                </tr>
                                                <tr>
                                                    <td nowrap class="Box1H FontBoxHeader">#customSpringMessage('TITLE_NAME')</td><!--件名-->
                                                    <td nowrap class="Box1D FontSmallAnk">#out($!domain.inspect.order.titleName.titleName)</td>
                                                </tr>
                                                <tr>
                                                    <td nowrap class="Box1H FontBoxHeader">#customSpringMessage('DELIVERY_PLACE')</td><!--納入先 -->
                                                    <td nowrap class="Box1D FontSmallAnk">#out($!domain.inspect.order.complement.delivPlace.delivPlaceCd) #out($!domain.inspect.order.complement.delivPlace.delivPlaceName)</td>
                                                </tr>
                                                <tr>
                                                    <td nowrap class="Box1H FontBoxHeader">#customSpringMessage('ITEM_CD')</td><!-- 品名コード-->
                                                    <td nowrap class="Box1D FontSmallAnk">#out($!domain.inspect.order.accounting.orderItem.item.itemCd)</td>
                                                </tr>
                                                <tr>
                                                    <td nowrap class="Box1H FontBoxHeader">#customSpringMessage('ITEM_NAME')</td><!--品名 -->
                                                    <td nowrap class="Box1D FontSmallAnk">#out($!domain.inspect.order.accounting.orderItem.item.itemName)</td>
                                                </tr>
                                                <tr>
                                                    <td nowrap class="Box1H FontBoxHeader">#customSpringMessage('KATASHIKI')</td><!--型式-->
                                                    <td nowrap class="Box1D FontSmallAnk">#out($!domain.inspect.order.accounting.orderItem.item.katashiki)</td>
                                                </tr>
                                                <tr>
                                                    <td nowrap class="Box1H FontBoxHeader">#customSpringMessage('MANUFACT')</td><!--メーカー -->
                                                    <td nowrap class="Box1D FontSmallAnk">#out($!domain.inspect.order.accounting.orderItem.item.manufact.manufactCd) #out($!domain.inspect.order.accounting.orderItem.item.manufact.manufactName)</td>
                                                </tr>
                                                <tr>
                                                    <td nowrap class="Box1H FontBoxHeader">#customSpringMessage('ORDER_DATE')</td><!-- 注文日-->
                                                    <td nowrap class="Box1D FontSmallAnk">#out($!domain.inspect.order.schedule.orderDate.orderDate.dateOfymdFormat)</td>
                                                </tr>
                                                <tr>
                                                    <td nowrap class="Box1H FontBoxHeader">#customSpringMessage('DELIV_DATE')</td><!--納期 -->
                                                    <td nowrap class="Box1D FontSmallAnk">#out($!domain.inspect.order.schedule.dlvEst.dlvEst.dateOfymdFormat)</td>
                                                </tr>
                                                <tr>
                                                    <td nowrap class="Box1H FontBoxHeader">#customSpringMessage('CURRENCY_CD')</td><!-- 通貨コード-->
                                                    <td nowrap class="Box1D FontSmallAnk">#out($!domain.inspect.order.accounting.orderAmount.amountMng.currency.currencyCd)</td>
                                                </tr>
                                                <tr>
                                                    <td nowrap class="Box1H FontBoxHeader">#customSpringMessage('UNIT_PRICE')</td><!--単価 -->
                                                    <td nowrap class="Box1D FontSmall">
                                                        <span class="FontCurrSmall">#out($!domain.inspect.order.accounting.orderAmount.amountMng.currency.currencyMark) #out($!domain.inspect.order.accounting.orderAmount.unitPrice.amount.amountFormat)</span>
                                                    </td>
                                                </tr>
                                                <tr>
                                                    <td nowrap class="Box1H FontBoxHeader">#customSpringMessage('UNIT_PRICE_IND')</td><!--単価区分-->
                                                    <td nowrap class="Box1D FontSmallAnk">#out($!domain.inspect.order.status.priceManagement.unitPriceInd_PageValue)</td>
                                                </tr>
                                                <tr>
                                                    <td nowrap class="Box1H FontBoxHeader">#customSpringMessage('ORDER_VOL')</td><!-- 注文数量-->
                                                    <td nowrap class="Box1D">
                                                        <table width="100%">
                                                            <tr>
                                                                <td nowrap class="FontSmallAnk">
                                                                    #out($!domain.inspect.order.originVol.volFormat)
                                                                    &nbsp;
                                                                    #out($!domain.inspect.order.accounting.orderItem.item.unit.unitName)
                                                                </td>
                                                                #if( $!domain.inspect.order.orderCancel.orderCancelVol.vol != "" && $!domain.inspect.order.orderCancel.orderCancelVol.vol != "0" )
                                                                <td nowrap class="FontSmallAnk" align="right">
                                                                    #customSpringMessage("ORDER_CANCEL_VOL")&nbsp;&nbsp;
                                                                    #out($!domain.inspect.order.orderCancel.orderCancelVol.volFormat)
                                                                    &nbsp;
                                                                    #out($!domain.inspect.order.accounting.orderItem.item.unit.unitName)
                                                                </td>
                                                                #end
                                                </tr>
                                                        </table>
                                                    </td>
                                                </tr>
                                                <tr>
                                                    <td nowrap class="Box1H FontBoxHeader">
                                                               #customSpringMessage('ORDER_AMOUNT') <!-- 注文金額-->
                                                    </td>
                                                    <td nowrap class="Box1D">
                                                        <table width="100%">
                                                            <tr>
                                                                <td class="FontCurrSmall">
                                                                    #out($!domain.inspect.order.accounting.orderAmount.amountMng.currency.currencyMark)
                                                                    #out($!domain.inspect.order.originAmount.amountFormat)
                                                                </td>
                                                                #if( $!domain.inspect.order.orderCancel.orderCancelAmount.amount != "" && $!domain.inspect.order.orderCancel.orderCancelAmount.amount != "0" )
                                                                <td class="FontCurrSmall" align="right" nowrap>
                                                                    <span class="FontSmall">#customSpringMessage("ORDER_CANCEL_AMOUNT")</span>&nbsp;&nbsp;
                                                                    #out($!domain.inspect.order.accounting.orderAmount.amountMng.currency.currencyMark)
                                                                    #out($!domain.inspect.order.orderCancel.orderCancelAmount.amountFormat)
                                                                </td>
                                                                #end
                                                </tr>
                                                        </table>
                                                    </td>
                                                </tr>
                                                <tr>
                                                    <td nowrap class="Box1H FontBoxHeader">#customSpringMessage('SUPPLIER')</td><!-- 取引先-->
                                                    <td nowrap class="Box1D FontSmallAnk">
                                                        #out($!domain.inspect.order.supplierFrom.supCd)&nbsp;
                                                        <span class="FontSmallBold">#out($!domain.inspect.order.supplierFrom.supplierName.supplierAbbrName)</span>&nbsp;
                                                    #if ($!domain.inspect.order.supplierFrom.subcon.subconInd == '1')
                                                        <span class="FontSubcon Subcon">#out($!domain.inspect.order.supplierFrom.subcon.subconInd_PageValue)</span>
                                                    #end
                                                    #if ($!domain.inspect.order.supplierFrom.ediInd.ediInd != '')
                                                        <span class="FontSmallAnk">#out($!domain.inspect.order.supplierFrom.ediInd.ediInd_PageValue)</span>
                                                    #end
                                                    </td>
                                                </tr>
                                                <tr>
                                                    <td nowrap class="Box1H FontBoxHeader">#customSpringMessage('FOR_SUPPRIER_COMMENT')</td><!--取引先向けコメント-->
                                                    <td nowrap class="Box1D FontSmallAnk">#out($!domain.inspect.order.orderComment.forSupplierComment.forSupplierComment.comment)</td>
                                                </tr>
                                                #foreach($!item in $!PSAPR082PageCreater.getItemListById("extend"))
                                                    $!PSAPR082PageCreater.printDefaultForCancelForDispPos(1, $!item)
                                                #end
                                            </tbody>
                                            </table><br/>
                                            <table class="NoBorder Box1G" width="100%">
                                                <tbody>
                                                <tr>
                                                    <td nowrap class="Box1H FontBoxHeader">#customSpringMessage('RCV_DATE')</td><!--受入日 -->
                                                    <td nowrap class="Box1D FontSmallAnk">#out($!domain.inspect.receiveResult.receiveDate.receiveDate.dateOfymdFormat)</td>
                                                </tr>
                                                <tr>
                                                    <td nowrap class="Box1H FontBoxHeader">#customSpringMessage('RCV_AMOUNT')</td><!-- 受入数量-->
                                                    <td nowrap class="Box1D FontSmallAnk">#out($!domain.inspect.receiveResult.receiveVol.receiveVol.volFormat)　#out($!domain.inspect.order.accounting.orderItem.item.unit.unitName)</td>
                                                </tr>
                                            #if($isActiveProfileStock == "true")## 在庫オプション
                                                <tr>
                                                    <td nowrap class="Box1H FontBoxHeader">#customSpringMessage('HAVE_IN_STOCK_FLG')<!--在庫対象--></td>
                                                    <td nowrap class="Box1D FontSmallAnk">
                                                        #out($!domain.inspect.receiveResult.haveInStockFlg.haveInStockFlg_PageValue)
                                                    </td>
                                                </tr>
                                                <tr>
                                                    <td nowrap class="Box1H FontBoxHeader">#customSpringMessage('STOCK_PLACE')<!--在庫場所--></td>
                                                    <td nowrap class="Box1D FontSmallAnk">
                                                        #out($!domain.inspect.receiveResult.stockPlace.stockPlaceCd)
                                                        #out($!domain.inspect.receiveResult.stockPlace.stockPlaceName)
                                                    </td>
                                                </tr>
                                            #end
                                                <tr>
                                                    <td nowrap class="Box1H FontBoxHeader">#customSpringMessage('RCV_REMARK')</td><!--受入備考 -->
                                                    <td class="Box1D FontSmallAnk">
                                                        #out($!domain.inspect.receiveResult.receiveRemark.remark.comment)
                                                    </td>
                                                </tr>
                                                <tr>
                                                    <td class="Box1H FontBoxHeader" WIDTH="20%">
                                                         #customSpringMessage('RCV_USER')<!--受入担当者 -->
                                                    </td>
                                                    <td class="Box1D FontSmallAnk">
                                                        <table class="NoBorder">
                                                            <tr>
                                                                <td valign="top" rowspan="2"><img class="Mark" src="../../image/mrkHuman.gif" ></td><!--申請者-->
                                                                <td rowspan="2" nowrap>
                                                                    <span class="AppPersonArea FontSmall">#out($!domain.inspect.receiveResult.receiveUser.receiveUser.section.sectionCd) #out($!domain.inspect.receiveResult.receiveUser.receiveUser.section.sectionName) &nbsp;&nbsp;&nbsp;</span><br>
                                                                    <span class="FontSmall"> #out($!domain.inspect.receiveResult.receiveUser.receiveUser.userID) </span>&nbsp;
                                                                    <span class="FontUserName"><b class="FontUserName">#out($!domain.inspect.receiveResult.receiveUser.receiveUser.userName)</b></span>
                                                                </td>
                                                                <td><img class="Mark" src="../../image/mrkTel.gif" ></td>
                                                                <td class="FontMini" nowrap>
                                                                    #customSpringMessage('EXTENSION_NO')：<!-- 内線番号--><span class="FontSmallAnk">#out($!domain.inspect.receiveResult.receiveUser.receiveUser.extNo.extensionNo)</span>&nbsp;&nbsp;#customSpringMessage('EXTERNAL_NO')：<!-- 外線番号--><span class="FontSmallAnk">#out($!domain.inspect.receiveResult.receiveUser.receiveUser.externalNo.externalNo)</span>
                                                                </td>
                                                            </tr>
                                                            <tr>
                                                                <td><img class="Mark" src="../../image/mrkMail.gif" ></td><!-- メールアドレス-->
                                                                <td class="FontMiniAnkBold" nowrap>
                                                                    <span class="FontMiniAnk"><A HREF='mailto:#out($!domain.inspect.receiveResult.receiveUser.receiveUser.userName)<#out($!domain.inspect.receiveResult.receiveUser.receiveUser.mailAddr.mail)>'>#out($!domain.inspect.receiveResult.receiveUser.receiveUser.mailAddr.mail)</A></span></td><td align="right" valign="bottom">
                                                                </td>
                                                            </tr>
                                                        </table>
                                                    </td>
                                                </tr>
                                                #foreach($!item in $!PSAPR082PageCreater.getItemListById("extend"))
                                                    $!PSAPR082PageCreater.printDefaultForCancelForDispPos(2, $!item)
                                                #end
                                            </tbody>
                                            </table><br/>

                                            <table class="NoBorder Box1G" width="100%">
                                                <tbody>
                                                    #foreach($!item in $!PSAPR082PageCreater.getItemListForBody())
                                                        #if($!item.getColumnName()=="T_INSPECT.INSPECT_DATE")
                                                            $!PSAPR082PageCreater.printDefaultForCancel($!item)
                                                        #elseif($!item.getColumnName()=="T_INSPECT.INSPECT_PASS_QUANT")
                                                            $!PSAPR082PageCreater.printSpecial('s16_showVol', $!item)
                                                        #elseif($!item.getColumnName()=="T_INSPECT.INSPECT_ACCOUNT")
                                                            $!PSAPR082PageCreater.printSpecial('s00_label', $!item)
                                                        #elseif($!item.getColumnName()=="T_INSPECT.INSPECT_USER_ID")
                                                            $!PSAPR082PageCreater.printSpecial("INSPECTION_USER", "m15_showUser",$!item)
                                                        #else
                                                            $!PSAPR082PageCreater.printDefaultForCancelForDispPos(3, $!item)
                                                        #end
                                                    #end
                                                </tbody>
                                            </table><br/>

                                            <table class="NoBorder Box1G" width="100%">
                                            <tbody class="Box1H FontBoxHeader ListBorderWidth">
                                                <tr>
                                                    <td nowrap class="Box1H FontBoxHeader">
                                                         #customSpringMessage('INS_APP_ROUTE_NAME')<!--承認ルート名 -->
                                                    </td>
                                                    <td class="Box1D FontSmallAnk">
                                                        #out($!domain.inspect.inspectAppRoute.approute.appRouteName)
                                                    </td>
                                                </tr>
                                                <tr>
                                                    <td class="Box1H FontBoxHeader">#customSpringMessage('APP_USER')</td><!-- 承認者-->
                                                    <td class="Box1D">
                                                        <table id="authorizer" class="AppSheet" width="98%" style="-webkit-box-shadow:2px 2px 0px #000000">
                                                        #if($!domain.inspect.appManagement.appList.appItemList.size()!=0)
                                                           #foreach($!appItem in $!domain.inspect.appManagement.appList.appItemList)
                                                            
                                                            <tr id = "row_$velocityCount" name = "row_$velocityCount">
                                                                <td class="AppNoArea">
                                                                    <span class="Number">#out($!domain.inspect.appManagement.appList.appItemList[$velocityCount].appSeq)</span>
                                                                </td>
                                                                <td class="AppPersonArea FontSmall" nowrap>
                                                                    #if($!appItem.subAppFlg == '1') 
                                                                    #out($!domain.inspect.appManagement.appList.appItemList[$velocityCount].subAppUserName.section.sectionCd) 
                                                                    #out($!domain.inspect.appManagement.appList.appItemList[$velocityCount].subAppUserName.section.sectionName)
                                                                    <br>
                                                                   #out($!domain.inspect.appManagement.appList.appItemList[$velocityCount].subAppUserName.userID) &nbsp;<span class="FontUserName"><b class="FontUserName">#out($!domain.inspect.appManagement.appList.appItemList[$velocityCount].subAppUserName.userName)</b></span>
                                                                   &nbsp;<span class="FontMini">#out($!domain.inspect.appManagement.appList.appItemList[$velocityCount].subAppUserName.official.officialName)</span>
                                                                   #else
                                                                    #out($!domain.inspect.appManagement.appList.appItemList[$velocityCount].appUserName.section.sectionCd) 
                                                                    #out($!domain.inspect.appManagement.appList.appItemList[$velocityCount].appUserName.section.sectionName)
                                                                    <br>
                                                                   #out($!domain.inspect.appManagement.appList.appItemList[$velocityCount].appUserName.userID) &nbsp;<span class="FontUserName"><b class="FontUserName">#out($!domain.inspect.appManagement.appList.appItemList[$velocityCount].appUserName.userName)</b></span>
                                                                   &nbsp;<span class="FontMini">#out($!domain.inspect.appManagement.appList.appItemList[$velocityCount].appUserName.official.officialName)</span>
                                                                   #end
                                                                </td>
                                                                 <td class="AppPersonArea">
                                                                    <table class="NoBorder">
                                                                        <tr>
                                                                            <td><img src="../../image/mrkTel.gif" ></td>
                                                                            <td class="FontMini" nowrap>
                                                                                #if($!appItem.subAppFlg == '1') 
                                                                                #customSpringMessage('EXTENSION_NO')：<!-- 内線番号--><span class="FontSmallAnk">#out($!domain.inspect.appManagement.appList.appItemList[$velocityCount].subAppUserName.extNo.extensionNo)</span>&nbsp;&nbsp;#customSpringMessage('EXTERNAL_NO')：<!-- 外線番号--><span class="FontSmallAnk">$!domain.inspect.appManagement.appList.appItemList[$velocityCount].subAppUserName.externalNo.externalNo</span>
                                                                                #else
                                                                                #customSpringMessage('EXTENSION_NO')：<!-- 内線番号--><span class="FontSmallAnk">#out($!domain.inspect.appManagement.appList.appItemList[$velocityCount].appUserName.extNo.extensionNo)</span>&nbsp;&nbsp;#customSpringMessage('EXTERNAL_NO')：<!-- 外線番号--><span class="FontSmallAnk">$!domain.inspect.appManagement.appList.appItemList[$velocityCount].appUserName.externalNo.externalNo</span>
                                                                                #end
                                                                            </td>
                                                                        </tr>
                                                                        <tr>
                                                                            <td><img src="../../image/mrkMail.gif" "#customSpringMessage('MAIL_ADDR')"></td><!-- メールアドレス--> 
                                                                            <td class="FontMiniAnkBold" nowrap>
                                                                                <span class="FontMiniAnk">
                                                                                #if($!appItem.subAppFlg == '1') 
                                                                                    <a HREF='mailto:#out($!domain.inspect.appManagement.appList.appItemList[$velocityCount].subAppUserName.userName)<#out($!domain.inspect.appManagement.appList.appItemList[$velocityCount].subAppUserName.mailAddr.mail)>'>
                                                                                    #out($!domain.inspect.appManagement.appList.appItemList[$velocityCount].subAppUserName.mailAddr.mail)</a>
                                                                                #else
                                                                                    <a HREF='mailto:#out($!domain.inspect.appManagement.appList.appItemList[$velocityCount].appUserName.userName)<#out($!domain.inspect.appManagement.appList.appItemList[$velocityCount].appUserName.mailAddr.mail)>'>
                                                                                    #out($!domain.inspect.appManagement.appList.appItemList[$velocityCount].appUserName.mailAddr.mail)</a>
                                                                                #end    
                                                                                </span>
                                                                            </td>
                                                                            <td align="right" valign="bottom"></td>
                                                                        </tr>
                                                                    </table>
                                                                </td>
                                                                #if("$!domain.inspect.appManagement.appList.appItemList[$velocityCount].appItemStatus.appItemStatus"=="3"||
                                                                    "$!domain.inspect.appManagement.appList.appItemList[$velocityCount].appItemStatus.appItemStatus"=="2")
                                                                <td class="AppStampArea" nowrap>
                                                                    <span class="ScreenName">$!domain.inspect.appManagement.appList.appItemList[$velocityCount].appItemStatus.appItemStatus_PageValue</span><!--承認-->
                                                                    <span class="FontMiniAnkBold"><br>#out($!domain.inspect.appManagement.appList.appItemList[$velocityCount].appDate.appDate.dateOfymdDispYMD)</span>
                                                                </td>
                                                             #elseif("$!domain.inspect.appManagement.appList.appItemList[$velocityCount].appItemStatus.appItemStatus"=="4")
                                                                <td class="AppStampArea" nowrap>
                                                                    <span class="FontBigBold Red">$!domain.inspect.appManagement.appList.appItemList[$velocityCount].appItemStatus.appItemStatus_PageValue</span><!--差戻し-->
                                                                    <span class="FontMiniAnkBold"><br>#out($!domain.inspect.appManagement.appList.appItemList[$velocityCount].appDate.appDate.dateOfymdDispYMD)</span>
                                                                </td>
                                                             #elseif($!domain.inspect.appManagement.appList.appItemList[$velocityCount].appSeq!=$!domain.inspect.appManagement.appList.appSeq&&$!domain.inspect.appManagement.appList.appItemList[$velocityCount].canDelete())
                                                                    <td class="AppStampArea" nowrap>
                                                                    <input type="button" class="MiniButton" value="#customSpringMessage('ACTION_DELETE')" onclick="removeAuthorizer(this);"><!-- 削除 -->
                                                                   </td>
                                                             #else
                                                                <td class="AppStampArea">
                                                                    <span>&nbsp;</span>
                                                                </td>
                                                            #end
                                                            </tr>
                                                #if($velocityCount+1 <$!domain.inspect.appManagement.appList.appItemList.size())
                                                <tr id = "row_$velocityCount" name = "row_$velocityCount"><td colspan="4" class="AppBorder">&nbsp;</td></tr>
                                                #end
                                                          #end
                                                        #end
                                                        </table>
                                                        
                                                        
                                                        <br>
                                                        <table>
                                                            <tr>
                                                                <td valign="top"><img src="../../image/mrkGuide.gif">&nbsp;</td>
                                                                <td class="FontMini">
                                                                    #customSpringMessage('APP_ADD_BUTTON_COMMENT')
                                                                    <br>
                                                                </td>
                                                            </tr>
                                                            <tr>
                                                                <td nowrap colspan="2" align="center">
                                                                    <table>
                                                                        <tr>
                                                                            <td class="FontMini" align="left" valign="middle" nowrap>#customSpringMessage('ADD_APP_USER'):</td>  <!--追加する承認者-->
                                                                            <td>
                                                                                #springFormInput("domain.inspect.appManagement.appList.appUserName.userID" "class='SmallDsp' maxlength='12' type='text' size='14' readonly tabIndex='-1' ondblclick='searchAuthorizer();'")
                                                                                #springFormInput("domain.inspect.appManagement.appList.appUserName.userName" "class='SmallDsp' type='text' size='20' readonly tabIndex='-1' ondblclick='searchAuthorizer();'")
                                                                                <img class="Icon" name="UserSearch" src="../../image/btnLupe.gif" onclick="searchAuthorizer();" />
                                                                                
                                                                                #springFormHiddenInput("domain.inspect.appManagement.appList.appUserName.section.sectionCd" "")
                                                                                #springFormHiddenInput("domain.inspect.appManagement.appList.appUserName.section.sectionName" "")
                                                                                #springFormHiddenInput("domain.inspect.appManagement.appList.appUserName.official.officialName" "")
                                                                                #springFormHiddenInput("domain.inspect.appManagement.appList.appUserName.section.sectionPlace.sectionPlaceCd" "")
                                                                                #springFormHiddenInput("domain.inspect.appManagement.appList.appUserName.section.sectionPlace.sectionPlaceName" "")
                                                                                #springFormHiddenInput("domain.inspect.appManagement.appList.appUserName.mailAddr.mail" "")
                                                                                #springFormHiddenInput("domain.inspect.appManagement.appList.appUserName.extNo.extensionNo" "")
                                                                                #springFormHiddenInput("domain.inspect.appManagement.appList.appUserName.externalNo.externalNo" "")
                                                                            </td>
                                                                            <td class="FontMini" align="left" valign="middle" nowrap>#customSpringMessage('ORDER'):</td><!--順序-->
                                                                            <td class="FontMini" align="left" valign="middle" nowrap>
                                                                                #customFormSingleSelectForApproval("domain.inspect.appManagement.appList.appSeqByAdd" $!approvalList "class='Small'")
                                                                            </td>    
                                                                            <td>
                                                                                 <input type="button" class="MiniButton" value="#customSpringMessage('ACTION_ADD_APP_USER')" onclick="addAuthorizer()"><!--承認者の追加-->
                                                                            </td>
                                                                        </tr>
                                                                    </table>
                                                                </td>
                                                            </tr>
                                                        </table>
                                                    </td>
                                                </tr>
                                            </tbody>
                                            </table><br/>
                                            <table class="NoBorder Box1G" width="100%">
                                            #set($backUserName = $!domain.inspect.appManagement.backApp.backAppFirstUser.userName)
                                            #set($backReason = "domain.approval.backReason.backReason.comment")
                                            #set($domainPath = "domain.inspect.appManagement")
                                            #set($delComment = "APL_USER_COMMENT")
                                            #parse("./common/common_back.vm")
                                        </table>
             
                                        <br>
                                        <table class="NoBorder" width="98%">
                                            <tr>
                                                <td>#customSpringMessage('PSAPR082_FOOTER_COMMENT')</td>
                                                <td align="right" valign="middle">
                                                    <input type="button" class="LargeButton Red" value="#customSpringMessage('RETURN')" onclick="sendBack();">&nbsp;&nbsp;<input id="Submit" type="button" class="LargeButton" value="#customSpringMessage('APPROVAL')" onclick="approval();"><!--差戻し--><!--承　認-->
                                                </td>
                                            </tr>
                                        </table>
                                    </td>
                                                </tr>
                                            </tbody>
                                        </table>
                                    </td>
                                </tr>
                        </table>
               </div>
            </td>
        </tr>
    </table>
 </form>
</body>
</html>
<script>
    getObj("Area").style.display = "block";
</script>
