<!doctype html>
<html lang="ja">
<head>
<title>#customSpringMessage('ORDER_APP')</title>
<meta http-equiv="Content-type" content="text/html; charset=UTF-8">
<meta http-equiv="Pragma" content="no-cache">
<meta http-equiv="Content-script-type" content="text/javascript">
<link id="CSS_FONT" rel="stylesheet" href="../../include/FontS.css" type="text/css">
<link rel="stylesheet" href="../../include/Layout.css" type="text/css">
<link rel="stylesheet" href="../../include/Color.css" type="text/css">
<link rel="stylesheet" href="../../include/searchbox.css" type="text/css">
<script language="javascript" type="text/javascript" src="../../include/common.js"></script>
<script language="javascript" type="text/javascript" src="../../include/check.js"></script>
<script language="javascript" type="text/javascript" src="../../include/date.js"></script>
<script language="javascript" type="text/javascript" src="../../include/tablesort.js"></script>
<script language="javascript" type="text/javascript" src="../../include/searchbox.js"></script>
<script language="javascript" type="text/javascript" src="../../include/jquery-1.7.2.min.js"></script>
<script language="javascript" type="text/javascript">
<!--
#parse("./common/common_js.vm")
#set($commonTitle = "#customSpringMessage('ORDER_APP')")
var isFinalAppUser = "false";
#set($isActiveProfileBudget = "#isActiveProfile('budget')")
var isClickable = false;
function onLoad() {
    //マーク 変更注文
    markChangedOrder();
    var errorMsg = "$!errorMessage";

    approvalPaging();

    if (errorMsg != ""){
        document.getElementById("TR_ERROR").style.display = "";
        var isSuccessForApproval = '#jsEscape($!isSuccessForApproval)';
        if(isSuccessForApproval == 'true'){
            #set( $purOrder = "#customSpringMessage('PUR_ORDER')" )
            alert('#customMessageArgs("I028",[$purOrder])');
            #if($!toList == true)
                buttonDisable();
                parent.iframeChange("${flowExecutionUrl}&_eventId=back");
                return;
            #end
        }
        isClickable = true;
        return;
    }
    #if("$!alertMessage" != "")
        #if( $alertMessage.indexOf('W023') != -1 || $alertMessage.indexOf('W042') != -1 ||  $alertMessage.indexOf('W601') != -1 )
            if (confirm("$alertMessage")) {
                getObj("Body").action="${flowExecutionUrl}&_eventId=approval&checkPass=1";
                buttonDisable();
                getObj("Body").submit();
                return;
            }
        #else
    var alertMessage = "$!alertMessage";
        alert(alertMessage);
        if(alertMessage.indexOf("#customSpringMessage('E035')") != -1){
            buttonDisable();
            parent.iframeChange("${flowExecutionUrl}&_eventId=next");
            return;
        }
        #end
    #end
        var isSuccessForApproval = '#jsEscape($!isSuccessForApproval)';
        if(isSuccessForApproval == 'true'){
            #set( $purOrder = "#customSpringMessage('PUR_ORDER')" )
            alert('#customMessageArgs("I028",[$purOrder])');
                buttonDisable();
            parent.iframeChange("${flowExecutionUrl}&_eventId=next");
            return;
        }
        var isSuccessForsSendBack = '#jsEscape($!isSuccessForsSendBack)';
        if(isSuccessForsSendBack == 'true'){
            #set( $purOrder = "#customSpringMessage('PUR_ORDER')" )
            alert('#customMessageArgs("I029",[$purOrder])');
            buttonDisable();
            parent.iframeChange("${flowExecutionUrl}&_eventId=next");
            return;
        }
    //approvalPaging();
    isClickable = true;
}
//マーク 変更注文
function markChangedOrder() {
   var tdObjs = document.getElementsByName("changedOrder");
   for(var i=0;i<tdObjs.length;i++){
        tdObjs[i].innerHTML = "<span class='FontWarn'>★&nbsp;</span>"+tdObjs[i].innerHTML;
   }
}
//添付ファイル
function downloadFile(seqNo) {
    parent.iframeChange("${flowExecutionUrl}&_eventId=download",'seqNo',seqNo);
}
//差戻し
function sendBack(orderSeq,lastUpdDate){
    if(!isClickable) {
        return;
    }
    #set( $purOrder = "#customSpringMessage('PUR_ORDER')" )
    #set( $return = "#customSpringMessage('RETURN')" )
    if( !confirm("#customMessageArgs("W001",[$purOrder,$return])") ) {
        return;
    }
    buttonDisable();
    getObj("Body").action="${flowExecutionUrl}&_eventId=sendBack&orderSeq="+orderSeq+"&lastUpdDate="+lastUpdDate;
    getObj("Body").submit();
}
//承認
function approval(orderSeq,lastUpdDate){
    if(!isClickable) {
        return;
    }
    //valLastAppUser();
    #set( $purOrder = "#customSpringMessage('PUR_ORDER')" )
    #set( $approval = "#customSpringMessage('APPROVAL')" )
    if( !confirm("#customMessageArgs("W001",[$purOrder,$approval])") ) {
        return;
    }
    buttonDisable();
    getObj("Body").action="${flowExecutionUrl}&_eventId=approval&orderSeq="+orderSeq+"&lastUpdDate="+lastUpdDate+"&isFinalAppUser="+isFinalAppUser;
    getObj("Body").submit();
}
//承認者の削除
function removeAuthorizer(obj) {
    if(!isClickable) {
        return;
    }
    var appSeq = obj.parentNode.parentNode.children[0].innerHTML;
    buttonDisable();
    getObj("Body").action="${flowExecutionUrl}&_eventId=removeAuthorizer&appSeq="+appSeq;
    getObj("Body").submit();
}
//承認者の追加
function addAuthorizer() {
    if(!isClickable) {
        return;
    }
        buttonDisable();
        getObj("Body").action="${flowExecutionUrl}&_eventId=addAuthorizer";
        getObj("Body").submit();
}
//承認者を検索
function searchAuthorizer() {
    var userId = getObj('order.appManagement.appList.appUserName.userID');
    var userName = getObj('order.appManagement.appList.appUserName.userName');
    var sectionCd = getObj('order.appManagement.appList.appUserName.section.sectionCd');
    var sectionName = getObj('order.appManagement.appList.appUserName.section.sectionName');
    var officialName = getObj('order.appManagement.appList.appUserName.official.officialName');
    var sectionPlaceCd = getObj('order.appManagement.appList.appUserName.section.sectionPlace.sectionPlaceCd');
    var sectionPlaceName = getObj('order.appManagement.appList.appUserName.section.sectionPlace.sectionPlaceName');
    var mail = getObj('order.appManagement.appList.appUserName.mailAddr.mail');
    var extensionNo = getObj('order.appManagement.appList.appUserName.extNo.extensionNo');
    var externalNo = getObj('order.appManagement.appList.appUserName.externalNo.externalNo');
    userPopup.setObject(userId, userName, sectionCd, sectionName, officialName, sectionPlaceCd, sectionPlaceName, mail, extensionNo, externalNo);
    masterSearch('../../src/userPopup/search?pageid=userPopupSearch&popupPageid=PSAPR032','UserSearch','750','500');
}
function downloadExt(filename, file) {
    iframeChange("${flowExecutionUrl}&_eventId=downloadext", 'filename', filename, 'file', file);
}

// 予算表示（部門）
function sectionDetail(companyCd, sectionPlaceCd, sectionCd, purReqDate, subjectCd) {
    poppage("../../budget/sectionDetail/list?companyCode=" + encodeURIComponent(companyCd) + "&sectionPlaceCode=" + encodeURIComponent(sectionPlaceCd) + "&sectionCode=" + encodeURIComponent(sectionCd) + "&perReqDate=" + purReqDate + "&subjectCds=" + encodeURIComponent(subjectCd), 'sectionBudgetDetail', 700, 500);
}

// 予算表示（稟議）
function ringiDetail(companyCd, sectionPlaceCd, budgetNumber) {
    poppage("../../budget/ringiDetail?companyCode=" + encodeURIComponent(companyCd) + "&sectionPlaceCode=" + encodeURIComponent(sectionPlaceCd) + "&budgetDetailNo=" + encodeURIComponent(budgetNumber), "ringiBudgetDetail", 700, 500);
}
//-->
</script>
</head>
<body topmargin="0" leftmargin="0" marginwidth="0" marginheight="0" align="center" onload="onLoad()" style="overflow:hidden">
<form id="Body" name="Body"  method="post">
#customFormHiddenInput("order.historyNo.historyNo" "$!domain.order.historyNo.historyNo")
#customFormHiddenInput("order.accounting.orderAmount.unitPrice.amount.amount" "$!domain.order.accounting.orderAmount.unitPrice.amount.amount")
#customFormHiddenInput("order.status.priceManagement.unitPriceInd" "$!domain.order.status.priceManagement.unitPriceInd")
#customFormHiddenInput("order.accounting.orderAmount.orderVolume.orderVol.vol" "$!domain.order.accounting.orderAmount.orderVolume.orderVol.vol")
#customFormHiddenInput("order.accounting.orderAmount.orderAmount.amount" "$!domain.order.accounting.orderAmount.orderAmount.amount")
#customFormHiddenInput("order.accounting.orderAmount.amountMng.taxCalculationInd.taxInd.taxInd" "$!domain.order.accounting.orderAmount.amountMng.taxCalculationInd.taxInd.taxInd")
<table class="SearchBody">
    <tr>
        <td id="SEARCH_AREA" class="SearchArea"><!-- onLoadで変更 -->
                #parse("./common/common_title_tran_with_individual_approval.vm")
        </td>
    </tr>
    <tr>
        <td class="NoBorder" style="height:auto; background-color:#CCC;">
            <div id="Area" style="OVERFLOW-Y: scroll;HEIGHT: 100%;display:none;">
                 <table class="HomeBox" align = "center">
                    <tr>
                         <td style="padding:60px,15px,0px,15px">
                            <table>
                                <tr>
                                    <td style="text-align:left;">
                                        <!-- ＊＊＊＊＊＊＊＊＊＊左サイド＊＊＊＊＊＊＊＊＊＊ -->
                                            <table class="NoBorder" width="100%">
                                                <tr>
                                                    <td>
                                                          <u><img src="../../image/mrkCircle.gif"><span id="StepTitle" class="FontStepTitle"> #customSpringMessage('ORDER_APP')<!--注文承認--></span></u><br><br>
                                                          <span id="ReqNo" class="FontSmallBold DarkBlue">#customSpringMessage('PSAPR032_HEADER_COMMENT')</span>
                                                    </td>
                                                    <td align="right" valign="middle">
                                                        <input type="button" class="LargeButton Red" value="#customSpringMessage('RETURN')" onclick="sendBack('#jsEscapeInHTML($!domain.order.orderIdentify.orderSeq)','#jsEscapeInHTML($!domain.order.orderIdentify.lastUpdDate)');">&nbsp;&nbsp;
                                                        <input id="button" type="button" class="LargeButton" value="#customSpringMessage('APPROVAL')" onclick="approval('#jsEscapeInHTML($!domain.order.orderIdentify.orderSeq)','#jsEscapeInHTML($!domain.order.orderIdentify.lastUpdDate)');">
                                                        #if($customMacroRequestContext.isActiveProfile('budget'))
                                                        <br><br>
	                                                        #if($domain.order.complement.budgetNumber.budgetNumber == '')
	                                                        <input type="button" class="LargeButton" value="#customSpringMessage('SHOW_BUDGET')" onclick="sectionDetail('#jsEscapeInHTML($!domain.order.user.loadSection.loadSection.company.companyCd)', '#jsEscapeInHTML($!domain.order.user.loadSection.loadSection.sectionPlace.sectionPlaceCd)', '#jsEscapeInHTML($!domain.order.user.loadSection.loadSection.sectionCd)', '#jsEscapeInHTML($!domain.order.schedule.reqDate.reqDate.dateOfymd)', '#jsEscapeInHTML($!domain.order.accounting.subject.subjectCd)', 'sectionBudgetDetail', 700, 500);">
	                                                        #else
	                                                        <input type="button" class="LargeButton" value="#customSpringMessage('SHOW_BUDGET')" onclick="ringiDetail('#jsEscapeInHTML($!domain.order.user.loadSection.loadSection.company.companyCd)', '#jsEscapeInHTML($!domain.order.user.loadSection.loadSection.sectionPlace.sectionPlaceCd)', '#jsEscapeInHTML($!domain.order.complement.budgetNumber.budgetNumber)', 'ringiBudgetDetail', 700, 500);">
	                                                        #end
                                                        #end
                                                    </td>
                                                </tr>
                                 <tr id ="TR_ERROR" style="display:none;"><td class="error" style="height:0px;">
                                    $!errorMessage
                                </td></tr>
                                            </table>

                                                <table class="Box1G" width="100%">
                                                    <tbody class="Box1H FontBoxHeader ListBorderWidth">
                                                    $!PSAPR032PageCreater.build('upd','_td_style_right', 'class="Box1D FontSmall"', '_td_style_left','class="Box1H FontBoxHeader"')
                                                    #foreach($!item in $!PSAPR032PageCreater.getItemListForBody())
                                                        #if($!item.getColumnName()=="T_ORDER.ORDER_NO")
                                                            $!PSAPR032PageCreater.printDefaultForCancel($!item, '_td_style_right', 'class="Box1D FontSlipNo"' , '_item_style' , 'class="FontSlipNo"')
                                                        #elseif($!item.getColumnName()=="T_ORDER.ORDER_VERSION")
                                                            #if($!preOrderApproval.order.historyNo.historyNo!=$!domain.order.historyNo.historyNo)
                                                                $!PSAPR032PageCreater.printDefaultForCancel($!item, '_td_style_left', 'id="changedOrder" name="changedOrder" class="Box1H FontBoxHeader"')
                                                            #else
                                                                $!PSAPR032PageCreater.printDefaultForCancel($!item)
                                                            #end
                                                        #elseif($!item.getColumnName()=="T_ORDER.INFO_CD")
                                                            $!PSAPR032PageCreater.printDefaultForCancel($!item, '_td_style_right', 'class="Box1D  FontSmallBold"')
                                                        #elseif($!item.getColumnName()=="T_SLIP_MNG.RECEIVE_STATUS_IND")
                                                            $!PSAPR032PageCreater.printDefaultForCancel($!item, '_page_value', true)
                                                        #elseif($!item.getColumnName()=="T_ORDER.TITLE_NAME")
                                                            $!PSAPR032PageCreater.printDefaultForCancel($!item)
                                                        #elseif($!item.getColumnName()=="T_ORDER.ORDER_DATE")
                                                            $!PSAPR032PageCreater.printDefaultForCancel($!item)
                                                        #elseif($!item.getColumnName()=="T_ORDER.LOAD_SECTION_CD")
                                                            #if($!preOrderApproval.order.user.loadSection.loadSection.sectionCd!=$!domain.order.user.loadSection.loadSection.sectionCd)
                                                                $!PSAPR032PageCreater.printDefaultForCancel($!item, '_td_style_left', 'id="changedOrder" name="changedOrder" class="Box1H FontBoxHeader"')
                                                            #else
                                                                $!PSAPR032PageCreater.printDefaultForCancel($!item)
                                                            #end
                                                        #elseif($!item.getColumnName()=="T_ORDER.DELIV_PLACE_CD")
                                                            #if($!preOrderApproval.order.complement.delivPlace.delivPlaceCd!=$!domain.order.complement.delivPlace.delivPlaceCd)
                                                                $!PSAPR032PageCreater.printSpecial("DELIVERY_PLACE",'m17_showDelivery', $!item, '_td_style_left', 'id="changedOrder" name="changedOrder" class="Box1H FontBoxHeader"')
                                                            #else
                                                                $!PSAPR032PageCreater.printSpecial("DELIVERY_PLACE",'m17_showDelivery', $!item)
                                                            #end
                                                        #elseif($!item.getColumnName()=="T_ORDER.SUP_CD")
                                                            $!PSAPR032PageCreater.printSpecial("SUPPLIER", "m31_showSupplierSimple", $!item)
                                                        #elseif($!item.getColumnName()=="T_ORDER.SUBJECT_CD")
                                                            #if($!preOrderApproval.order.accounting.subject.subjectCd!=$!domain.order.accounting.subject.subjectCd)
                                                                $!PSAPR032PageCreater.printSpecial("SUBJECT","m19_showSubject", $!item, '_td_style_left', 'id="changedOrder" name="changedOrder" class="Box1H FontBoxHeader"')
                                                            #else
                                                                $!PSAPR032PageCreater.printSpecial("SUBJECT","m19_showSubject", $!item)
                                                            #end
                                                        #elseif($!item.getColumnName()=="T_ORDER.ITEM_CLASS_S")
                                                            #if(!$!domain.order.reqInd.isCatalog())
                                                                $!PSAPR032PageCreater.printSpecial('m10_showItemKind', $!item)
                                                            #end
                                                        #elseif($!item.getColumnName()=="T_ORDER.PRODUCT_CLASS")
                                                            #if($!domain.order.reqInd.isCatalog())
                                                                $!PSAPR032PageCreater.printSpecial('m30_showItemProductClass', $!item)
                                                            #end
                                                        #elseif($!item.getColumnName()=="T_ORDER.ITEM_CD")
                                                            $!PSAPR032PageCreater.printDefaultForCancel($!item)
                                                        #elseif($!item.getColumnName()=="T_ORDER.ITEM_NAME")
                                                            #if($!preOrderApproval.order.accounting.orderItem.item.itemName!=$!domain.order.accounting.orderItem.item.itemName)
                                                                $!PSAPR032PageCreater.printDefaultForCancel($!item, '_td_style_left', 'id="changedOrder" name="changedOrder" class="Box1H FontBoxHeader"')
                                                            #else
                                                                $!PSAPR032PageCreater.printDefaultForCancel($!item)
                                                            #end
                                                        #elseif($!item.getColumnName()=="T_ORDER.KATASHIKI")
                                                            #if($!preOrderApproval.order.accounting.orderItem.item.katashiki!=$!domain.order.accounting.orderItem.item.katashiki)
                                                                $!PSAPR032PageCreater.printDefaultForCancel($!item, '_td_style_left', 'id="changedOrder" name="changedOrder" class="Box1H FontBoxHeader"')
                                                            #else
                                                                $!PSAPR032PageCreater.printDefaultForCancel($!item)
                                                            #end
                                                        #elseif($!item.getColumnName()=="T_ORDER.MANUFACT_CD")
                                                            #if($!preOrderApproval.order.accounting.orderItem.item.manufact.manufactName!=$!domain.order.accounting.orderItem.item.manufact.manufactName)
                                                                $!PSAPR032PageCreater.printDefaultForCancel($!item, '_td_style_left', 'id="changedOrder" name="changedOrder" class="Box1H FontBoxHeader"')
                                                            #else
                                                                $!PSAPR032PageCreater.printDefaultForCancel($!item)
                                                            #end
                                                        #elseif($!item.getColumnName()=="T_ORDER.INSPECT_IND")
                                                            $!PSAPR032PageCreater.printDefaultForCancel($!item)
                                                        #elseif($!item.getColumnName()=="T_ORDER.ORDER_DELIV_DATE")
                                                            #if($!preOrderApproval.order.schedule.dlvEst.dlvEst.dateOfymd!=$!domain.order.schedule.dlvEst.dlvEst.dateOfymd)
                                                                $!PSAPR032PageCreater.printDefaultForCancel($!item, '_td_style_left', 'id="changedOrder" name="changedOrder" class="Box1H FontBoxHeader"')
                                                            #else
                                                                $!PSAPR032PageCreater.printDefaultForCancel($!item)
                                                            #end
                                                        #elseif($!item.getColumnName()=="T_PUR_REQUEST.CURRENCY_CD")
                                                            $!PSAPR032PageCreater.printDefaultForCancel($!item)
                                                        #elseif($!item.getColumnName()=="T_PUR_REQUEST.UNIT_PRICE")
                                                            $!PSAPR032PageCreater.printSpecial("s24_currency", $!item,"_item_style",'class="FontCurrSmall"')
                                                        #elseif($!item.getColumnName()=="T_PUR_REQUEST.REQ_VOL")
                                                            $!PSAPR032PageCreater.printSpecial('s16_showVol', $!item)
                                                        #elseif($!item.getColumnName()=="T_PUR_REQUEST.REQ_AMOUNT")
                                                            $!PSAPR032PageCreater.printSpecial("s24_currency", $!item,"_item_style",'class="FontCurrSmall"')
                                                        #elseif($!item.getColumnName()=="T_ORDER.CURRENCY_CD")
                                                            $!PSAPR032PageCreater.printDefaultForCancel($!item)
                                                        #elseif($!item.getColumnName()=="T_ORDER.UNIT_PRICE")
                                                            #if($!preOrderApproval.order.accounting.orderAmount.unitPrice.amount.amount!=$!domain.order.accounting.orderAmount.unitPrice.amount.amount)
                                                                $!PSAPR032PageCreater.printSpecial("s24_currency", $!item,"_item_style",'class="FontCurrSmall"', '_td_style_left', 'id="changedOrder" name="changedOrder" class="Box1H FontBoxHeader"')
                                                            #else
                                                                $!PSAPR032PageCreater.printSpecial("s24_currency", $!item,"_item_style",'class="FontCurrSmall"')
                                                            #end
                                                        #elseif($!item.getColumnName()=="T_ORDER.UNIT_PRICE_IND")
                                                            #if($!preOrderApproval.order.status.priceManagement.unitPriceInd!=$!domain.order.status.priceManagement.unitPriceInd)
                                                                #if($!domain.order.status.priceManagement.unitPriceInd == '0')
                                                                    $!PSAPR032PageCreater.printDefaultForCancel($!item, '_td_style_left', 'id="changedOrder" name="changedOrder" class="Box1H FontBoxHeader"', '_td_style_right', 'class="Box1D  FontSmall Red"')
                                                                #else
                                                                    $!PSAPR032PageCreater.printDefaultForCancel($!item, '_td_style_left', 'id="changedOrder" name="changedOrder" class="Box1H FontBoxHeader"')
                                                                #end
                                                            #else
                                                                #if($!domain.order.status.priceManagement.unitPriceInd == '0')
                                                                    $!PSAPR032PageCreater.printDefaultForCancel($!item, '_td_style_right', 'class="Box1D  FontSmall Red"')
                                                                #else
                                                                    $!PSAPR032PageCreater.printDefaultForCancel($!item)
                                                                #end
                                                            #end
                                                        #elseif($!item.getColumnName()=="T_ORDER.PRICE_UNDEC_REASON")
                                                            #if($!preOrderApproval.order.status.priceManagement.priceUndecReason.comment != $!domain.order.status.priceManagement.priceUndecReason.comment)
                                                                $!PSAPR032PageCreater.printDefaultForCancel($!item, '_td_style_left', 'id="changedOrder" name="changedOrder" class="Box1H FontBoxHeader"')
                                                            #else
                                                                $!PSAPR032PageCreater.printDefaultForCancel($!item)
                                                            #end
                                                        #elseif($!item.getColumnName()=="T_ORDER.PRICE_DEC_DATE")
                                                            #if($!preOrderApproval.order.status.priceManagement.priceDecDate.dateOfymd != $!domain.order.status.priceManagement.priceDecDate.dateOfymd)
                                                                $!PSAPR032PageCreater.printDefaultForCancel($!item, '_td_style_left', 'id="changedOrder" name="changedOrder" class="Box1H FontBoxHeader"')
                                                            #else
                                                                $!PSAPR032PageCreater.printDefaultForCancel($!item)
                                                            #end
                                                        #elseif($!item.getColumnName()=="T_ORDER.ORDER_VOL")
                                                            #if($!preOrderApproval.order.accounting.orderAmount.orderVolume.orderVol.vol!=$!domain.order.accounting.orderAmount.orderVolume.orderVol.vol)
                                                                $!PSAPR032PageCreater.printSpecial("s27_volForOriginAndCancel",$!item, '_item_style', 'class="FontSmall"', '_td_style_left', 'id="changedOrder" name="changedOrder" class="Box1H FontBoxHeader"')
                                                            #else
                                                                $!PSAPR032PageCreater.printSpecial("s27_volForOriginAndCancel",$!item, '_item_style', 'class="FontSmall"')
                                                            #end
                                                        #elseif($!item.getColumnName()=="T_ORDER.ORDER_AMOUNT")
                                                            #if($!preOrderApproval.order.accounting.orderAmount.orderAmount.amount!=$!domain.order.accounting.orderAmount.orderAmount.amount)
                                                                $!PSAPR032PageCreater.printSpecial("s26_amountForOriginAndCancel",$!item,"_item_style",'class="FontCurrSmall"', '_td_style_left', 'id="changedOrder" name="changedOrder" class="Box1H FontBoxHeader"')
                                                            #else
                                                                $!PSAPR032PageCreater.printSpecial("s26_amountForOriginAndCancel",$!item,"_item_style",'class="FontCurrSmall"')
                                                            #end
                                                        #elseif($!item.getColumnName()=="T_ORDER.TAX_IND")
                                                            #if($!preOrderApproval.order.accounting.orderAmount.amountMng.taxCalculationInd.taxInd.taxInd!=$!domain.order.accounting.orderAmount.amountMng.taxCalculationInd.taxInd.taxInd)
                                                                $!PSAPR032PageCreater.printDefaultForCancel($!item, '_td_style_left', 'id="changedOrder" name="changedOrder" class="Box1H FontBoxHeader"')
                                                            #else
                                                                $!PSAPR032PageCreater.printDefaultForCancel($!item)
                                                            #end
                                                        #elseif($!item.getColumnName()=="T_ORDER.CONSUMPT_IND")
                                                            $!PSAPR032PageCreater.printDefaultForCancel($!item)
                                                        #elseif($!item.getColumnName()=="T_ORDER.PAY_CONDITION_CD")
                                                            #if($!preOrderApproval.order.payConditionItem.payConditionName != $!domain.order.payConditionItem.payConditionName)
                                                                $!PSAPR032PageCreater.printSpecial("PAY_CONDITION_NAME", "s00_label", $!item, '_td_style_left', 'id="changedOrder" name="changedOrder" class="Box1H FontBoxHeader"')
                                                            #else
                                                                $!PSAPR032PageCreater.printSpecial("PAY_CONDITION_NAME", "s00_label", $!item)
                                                            #end
                                                        #elseif($!item.getColumnName()=="T_ORDER.BUDGET_NO")
                                                            #if($isActiveProfileBudget=="true")
                                                                #if($!preOrderApproval.order.complement.budgetNumber.budgetNumber != $!domain.order.complement.budgetNumber.budgetNumber)
                                                                    $!PSAPR032PageCreater.printSpecial("BG03_budget_no_without_button", $!item, '_td_style_left', 'id="changedOrder" name="changedOrder" class="Box1H FontBoxHeader"')
                                                                #else
                                                                    $!PSAPR032PageCreater.printSpecial('BG03_budget_no_without_button', $!item)
                                                                #end
                                                            #else
                                                                #if($!preOrderApproval.order.complement.budgetNumber.budgetNumber != $!domain.order.complement.budgetNumber.budgetNumber)
                                                                    $!PSAPR032PageCreater.printDefaultForCancel($!item, '_td_style_left', 'id="changedOrder" name="changedOrder" class="Box1H FontBoxHeader"')
                                                                #else
                                                                    $!PSAPR032PageCreater.printDefaultForCancel($!item)
                                                                #end
                                                            #end
                                                        #elseif($!item.getColumnName()=="T_ORDER.ATTACH_FILE_SEQ1")
                                                            #if(($!preOrderApproval.order.complement.rangeByAttachFile1.attachFile.seqNo!=$!domain.order.complement.rangeByAttachFile1.attachFile.seqNo)
                                                             || ($!preOrderApproval.order.complement.rangeByAttachFile2.attachFile.seqNo!=$!domain.order.complement.rangeByAttachFile2.attachFile.seqNo)
                                                             || ($!preOrderApproval.order.complement.rangeByAttachFile3.attachFile.seqNo!=$!domain.order.complement.rangeByAttachFile3.attachFile.seqNo))
                                                                $!PSAPR032PageCreater.printSpecial("s14_showFile3",$!item,'_event','onclick = "downloadFile(id);"','_event2','onclick = "downloadFile(id);"','_event3','onclick = "downloadFile(id);"', '_td_style_left', 'id="changedOrder" name="changedOrder" class="Box1H FontBoxHeader"')
                                                            #else
                                                                $!PSAPR032PageCreater.printSpecial("s14_showFile3",$!item,'_event','onclick = "downloadFile(id);"','_event2','onclick = "downloadFile(id);"','_event3','onclick = "downloadFile(id);"')
                                                            #end
                                                        #elseif($!item.getColumnName()=="T_ORDER.BUYER_COMMENT")
                                                            #if($!preOrderApproval.order.orderComment.buyerComment.comment.comment!=$!domain.order.orderComment.buyerComment.comment.comment)
                                                                $!PSAPR032PageCreater.printDefaultForCancel($!item, '_td_style_left', 'id="changedOrder" name="changedOrder" class="Box1H FontBoxHeader"')
                                                            #else
                                                                $!PSAPR032PageCreater.printDefaultForCancel($!item)
                                                            #end
                                                        #elseif($!item.getColumnName()=="T_ORDER.FOR_SUPPRIER_COMMENT")
                                                            #if($!preOrderApproval.order.orderComment.forSupplierComment.forSupplierComment.comment!=$!domain.order.orderComment.forSupplierComment.forSupplierComment.comment)
                                                                $!PSAPR032PageCreater.printDefaultForCancel($!item, '_td_style_left', 'id="changedOrder" name="changedOrder" class="Box1H FontBoxHeader"')
                                                            #else
                                                                $!PSAPR032PageCreater.printDefaultForCancel($!item)
                                                            #end
                                                        #elseif($!item.getColumnName()=="T_PUR_APL.FOR_BUYER_COMMENT")
                                                            $!PSAPR032PageCreater.printDefaultForCancel($!item)
                                                        #elseif($!item.getColumnName()=="DUMMY.DISPLAY1")
                                                            #if("$!domain.order.externalCatalogDataList.display1" != "")
                                                                $!PSAPR032PageCreater.printDefaultForCancel($!item)
                                                            #end
                                                        #elseif($!item.getColumnName()=="DUMMY.DISPLAY2")
                                                            #if("$!domain.order.externalCatalogDataList.display2" != "")
                                                                $!PSAPR032PageCreater.printDefaultForCancel($!item)
                                                            #end
                                                        #elseif($!item.getColumnName()=="DUMMY.DISPLAY3")
                                                            #if("$!domain.order.externalCatalogDataList.display3" != "")
                                                                $!PSAPR032PageCreater.printDefaultForCancel($!item)
                                                            #end
                                                        #elseif($!item.getColumnName()=="DUMMY.DISPLAY4")
                                                            #if("$!domain.order.externalCatalogDataList.display4" != "")
                                                                $!PSAPR032PageCreater.printDefaultForCancel($!item)
                                                            #end
                                                        #elseif($!item.getColumnName()=="DUMMY.DISPLAY5")
                                                            #if("$!domain.order.externalCatalogDataList.display5" != "")
                                                                $!PSAPR032PageCreater.printDefaultForCancel($!item)
                                                            #end
                                                        #else
                                                            $!PSAPR032PageCreater.printDefaultForCancel($!item)
                                                        #end
                                                    #end
                                                    </tbody>
                                                </table>
                                                <br>
                                                <table class="Box1G" width="100%">
                                                    <tbody class="Box1H FontBoxHeader ListBorderWidth">
                                                    <tr>
                                                        <td nowrap class="Box1H FontBoxHeader">#customSpringMessage('ORD_APP_ROUTE_NAME')<!---注文承認ルート--></td>
                                                        <td nowrap class="Box1D FontSmallAnk">#out($!domain.order.approute.appRouteName)</td>
                                                    </tr>
                                                    <tr>
                                                        <td nowrap class="Box1H FontBoxHeader">#customSpringMessage('APP_USER')<!--承認者--></td>
                                                        <td class="Box1D">
                                                         <table id="authorizer" class="AppSheet" width="98%" style="-webkit-box-shadow:2px 2px 0px #000000">
                                                               #if($!domain.order.appManagement.appList.appItemList.size()!=0)
                                                                 #foreach($!appItem in $!domain.order.appManagement.appList.appItemList)
                                                                  <tr id = "row_$velocityCount" name = "row_$velocityCount">
                                                                      <td class="AppNoArea FontNumber">#out($!domain.order.appManagement.appList.appItemList[$velocityCount].appSeq)</td>
                                                                           <td class="AppPersonArea" nowrap>
                                                                               #if($!appItem.subAppFlg == '1')
                                                                               <span class="FontSmall">
                                                                                   #out($!domain.order.appManagement.appList.appItemList[$velocityCount].subAppUserName.section.sectionCd)
                                                                                   #out($!domain.order.appManagement.appList.appItemList[$velocityCount].subAppUserName.section.sectionName)
                                                                               </span>
                                                                               <br>
                                                                               <span class="FontSmall">#out($!domain.order.appManagement.appList.appItemList[$velocityCount].subAppUserName.userID) </span>&nbsp;
                                                                               <span class="FontUserName"><b class="FontUserName">#out($!domain.order.appManagement.appList.appItemList[$velocityCount].subAppUserName.userName)</b></span>
                                                                               &nbsp;
                                                                               <span class="FontMini">#out($!domain.order.appManagement.appList.appItemList[$velocityCount].subAppUserName.official.officialName)</span>
                                                                               #else
                                                                               <span class="FontSmall">
                                                                                   #out($!domain.order.appManagement.appList.appItemList[$velocityCount].appUserName.section.sectionCd)
                                                                                   #out($!domain.order.appManagement.appList.appItemList[$velocityCount].appUserName.section.sectionName)
                                                                               </span>
                                                                               <br>
                                                                               <span class="FontSmall">#out($!domain.order.appManagement.appList.appItemList[$velocityCount].appUserName.userID) </span>&nbsp;
                                                                               <span class="FontUserName"><b class="FontUserName">#out($!domain.order.appManagement.appList.appItemList[$velocityCount].appUserName.userName)</b></span>
                                                                               &nbsp;
                                                                               <span class="FontMini">#out($!domain.order.appManagement.appList.appItemList[$velocityCount].appUserName.official.officialName)</span>
                                                                               #end
                                                                               <span>&nbsp;</span>
                                                                           </td>
                                                                           <td class="AppPersonArea">
                                                                               <table class="NoBorder">
                                                                                     <tr>
                                                                                       <td><img src="../../image/mrkTel.gif" ></td>
                                                                                       <td class="FontMini" nowrap>
                                                                                          #customSpringMessage('EXTENSION_NO')：<!-- 内線番号-->
                                                                                          #if($!appItem.subAppFlg == '1')
                                                                                          <span class="FontSmallAnk">#out($!domain.order.appManagement.appList.appItemList[$velocityCount].subAppUserName.extNo.extensionNo)</span>&nbsp;&nbsp;
                                                                                          #customSpringMessage('EXTERNAL_NO')：<!-- 外線番号-->
                                                                                          <span class="FontSmallAnk">#out($!domain.order.appManagement.appList.appItemList[$velocityCount].subAppUserName.externalNo.externalNo)</span>
                                                                                          #else
                                                                                          <span class="FontSmallAnk">#out($!domain.order.appManagement.appList.appItemList[$velocityCount].appUserName.extNo.extensionNo)</span>&nbsp;&nbsp;
                                                                                          #customSpringMessage('EXTERNAL_NO')：<!-- 外線番号-->
                                                                                          <span class="FontSmallAnk">#out($!domain.order.appManagement.appList.appItemList[$velocityCount].appUserName.externalNo.externalNo)</span>
                                                                                          #end
                                                                                       </td>
                                                                                     </tr>
                                                                                     <tr>
                                                                                       <td><img src="../../image/mrkMail.gif" "#customSpringMessage('MAIL_ADDR')"></td><!-- メールアドレス-->
                                                                                       <td class="FontMiniAnkBold" nowrap>
                                                                                           <span class="FontMiniAnk">
                                                                                           #if($!appItem.subAppFlg == '1')
                                                                                                #if("$!domain.order.appManagement.appList.appItemList[$velocityCount].subAppUserName.mailAddr.mail" != "")
                                                                                                <A HREF='mailto:#out($!domain.order.appManagement.appList.appItemList[$velocityCount].subAppUserName.userName)<#out($!domain.order.appManagement.appList.appItemList[$velocityCount].subAppUserName.mailAddr.mail)>'>

                                                                                                      #out($!domain.order.appManagement.appList.appItemList[$velocityCount].subAppUserName.mailAddr.mail)
                                                                                                 </A>
                                                                                                 #end
                                                                                            #else
                                                                                                #if("$!domain.order.appManagement.appList.appItemList[$velocityCount].appUserName.mailAddr.mail" != "")
                                                                                                <A HREF='mailto:#out($!domain.order.appManagement.appList.appItemList[$velocityCount].appUserName.userName)<#out($!domain.order.appManagement.appList.appItemList[$velocityCount].appUserName.mailAddr.mail)>'>
                                                                                                      #out($!domain.order.appManagement.appList.appItemList[$velocityCount].appUserName.mailAddr.mail)

                                                                                                 </A>
                                                                                                 #end
                                                                                             #end
                                                                                           </span>
                                                                                         </td>
                                                                                         <td align="right" valign="bottom"></td>
                                                                                       </tr>
                                                                                   </table>
                                                                                </td>
                                                                                #if("$!domain.order.appManagement.appList.appItemList[$velocityCount].appItemStatus.appItemStatus"=="2" || "$!domain.order.appManagement.appList.appItemList[$velocityCount].appItemStatus.appItemStatus"=="3")
                                                                                     <td nowrap class="AppStampArea">
                                                                                         <span class="ScreenName">$!domain.order.appManagement.appList.appItemList[$velocityCount].appItemStatus.appItemStatus_PageValue</span><!--承認-->
                                                                                         <span class="FontMiniAnkBold"><br>#out($!domain.order.appManagement.appList.appItemList[$velocityCount].appDate.appDate.dateOfymdDispYMD)</span>
                                                                                     </td>
                                                                                #elseif("$!domain.order.appManagement.appList.appItemList[$velocityCount].appItemStatus.appItemStatus"=="4")
                                                                                    <td nowrap class="AppStampArea">
                                                                                        <span class="FontBigBold Red">$!domain.order.appManagement.appList.appItemList[$velocityCount].appItemStatus.appItemStatus_PageValue</span><!--差戻し-->
                                                                                        <span class="FontMiniAnkBold"><br>#out($!domain.order.appManagement.appList.appItemList[$velocityCount].appDate.appDate.dateOfymdDispYMD)</span>
                                                                                    </td>
                                                                                 #elseif($!domain.order.appManagement.appList.appItemList[$velocityCount].appSeq!=$!domain.order.appManagement.appList.appSeq && $!domain.order.appManagement.appList.appItemList[$velocityCount].canDelete())
                                                                                    <td class="AppStampArea">
                                                                                        <input type='button' class='MiniButton' onclick='removeAuthorizer(this);' value="#customSpringMessage('ACTION_DELETE')">
                                                                                   </td>
                                                                                 #else
                                                                                    <td class="AppStampArea"><span>&nbsp;</span></td>
                                                                                #end
                                                                            </tr>
                                                                             #if($velocityCount+1 <$!domain.order.appManagement.appList.appItemList.size())
                                                                             <tr id = "row_$velocityCount" name = "row_$velocityCount"><td colspan="4" class="AppBorder">&nbsp;</td></tr>
                                                                             #end
                                                                      #end
                                                                   #end
                                                                </table>
                                                                <br>
                                                                <table>
                                                                 <tr>
                                                                       <td valign="top"><img src="../../image/mrkGuide.gif">&nbsp;</td>
                                                                       <td class="FontMini">#customSpringMessage('APP_ADD_BUTTON_COMMENT')<br></td>
                                                                 </tr>
                                                                 <tr>
                                                                       <td nowrap colspan="2" align="center">
                                                                             <table>
                                                                                   <tr>
                                                                                         <td class="FontMini" align="left" valign="middle" nowrap>#customSpringMessage('ADD_APP_USER')<!--追加する承認者-->:</td>
                                                                                         <td>
                                                                                               #springFormInput("domain.order.appManagement.appList.appUserName.userID" "class='SmallDsp' maxlength='12' type='text' size='14' readonly tabIndex='-1' ondblclick='searchAuthorizer();'")
                                                                                               #springFormInput("domain.order.appManagement.appList.appUserName.userName" "class='SmallDsp' type='text' size='20' readonly tabIndex='-1' ondblclick='searchAuthorizer();'")
                                                                                               <img class="Icon" name="UserSearch" src="../../image/btnLupe.gif" onclick="searchAuthorizer();" />

                                                                                               #springFormHiddenInput("domain.order.appManagement.appList.appUserName.section.sectionCd" "")
                                                                                               #springFormHiddenInput("domain.order.appManagement.appList.appUserName.section.sectionName" "")
                                                                                               #springFormHiddenInput("domain.order.appManagement.appList.appUserName.official.officialName" "")
                                                                                               #springFormHiddenInput("domain.order.appManagement.appList.appUserName.section.sectionPlace.sectionPlaceCd" "")
                                                                                               #springFormHiddenInput("domain.order.appManagement.appList.appUserName.section.sectionPlace.sectionPlaceName" "")
                                                                                               #springFormHiddenInput("domain.order.appManagement.appList.appUserName.mailAddr.mail" "")
                                                                                               #springFormHiddenInput("domain.order.appManagement.appList.appUserName.extNo.extensionNo" "")
                                                                                               #springFormHiddenInput("domain.order.appManagement.appList.appUserName.externalNo.externalNo" "")
                                                                                        </td>
                                                                                        <td class="FontMini" align="left" valign="middle" nowrap>#customSpringMessage('ORDER'):</td>
                                                                                        <td class="FontMini" align="left" valign="middle" nowrap>
                                                                                            #customFormSingleSelectForApproval("domain.order.appManagement.appList.appSeqByAdd" $!approvalList "class='Small'")
                                                                                        </td>
                                                                                        <td>
                                                                                           <input type="button" class="MiniButton" value="#customSpringMessage('ACTION_ADD_APP_USER')" onclick="addAuthorizer();"><!--承認者の追加-->
                                                                                        </td>
                                                                                    </tr>
                                                                              </table>
                                                                            </td>
                                                                           </tr>
                                                                       </table>
                                                                  </td>
                                                            </tr>
                                                            <tr>
                                                             <td nowrap class="Box1H FontBoxHeader">#customSpringMessage('CLIENT')<!--依頼者--></td>
                                                            <td class="Box1D">
                                                             <table class="NoBorder">
                                                                  <tr>
                                                                    <td valign="top" rowspan="2"><img class="Mark" src="../../image/mrkHuman.gif"></td>
                                                                    <td rowspan="2" nowrap>
                                                                          <span class="FontSmall">
                                                                                     #out($!domain.order.user.reqUser.reqUser.section.sectionCd) &nbsp;
                                                                                     #out($!domain.order.user.reqUser.reqUser.section.sectionName)
                                                                               </span><br>
                                                                               <span class="FontSmall">#out($!domain.order.user.reqUser.reqUser.userID)</span>&nbsp;
                                                                               <span class="FontUserName"><b class="FontUserName">#out($!domain.order.user.reqUser.reqUser.userName)</b></span>
                                                                    </td>
                                                                    <td><img class="Mark" src="../../image/mrkTel.gif"></td>
                                                                    <td class="FontMini" nowrap>
                                                                               #customSpringMessage('EXTENSION_NO')：<!--内線番号--><span class="FontSmallAnk">#out($!domain.order.user.reqUser.reqUser.extNo.extensionNo)</span>&nbsp;&nbsp;
                                                                               #customSpringMessage('EXTERNAL_NO')：<!--外線番号--><span class="FontSmallAnk">#out($!domain.order.user.reqUser.reqUser.externalNo.externalNo)</span>
                                                                    </td>
                                                                </tr>
                                                                <tr>
                                                                    <td><img class="Mark" src="../../image/mrkMail.gif" ></td>
                                                                     <td class="FontMiniAnkBold" nowrap>
                                                                         <span class="FontMiniAnk">
                                                                              #if("$!domain.order.user.reqUser.reqUser.mailAddr.mail" != "")
                                                                              <A HREF='mailto:#out($!domain.order.user.reqUser.reqUser.userName)<#out($!domain.order.user.reqUser.reqUser.mailAddr.mail)>'>#out($!domain.order.user.reqUser.reqUser.mailAddr.mail)</A>
                                                                              #end
                                                                              </span>
                                                                      </td>
                                                                      <td align="right" valign="bottom"></td>
                                                                </tr>
                                                             </table>
                                                            </td>
                                                         </tr>
                                                         <tr>
                                                            #if($!preOrderApproval.order.user.buyUser.buyUser.userID != $!domain.order.user.buyUser.buyUser.userID)
                                                            <td id="changedOrder" name="changedOrder" nowrap class="Box1H FontBoxHeader">
                                                            #else
                                                            <td nowrap class="Box1H FontBoxHeader">
                                                            #end
                                                            #customSpringMessage('BUYER_USER')<!--購買担当者--></td>
                                                            <td class="Box1D">
                                                                  <table class="NoBorder">
                                                                      <tr>
                                                                         <td valign="top" rowspan="2"><img class="Mark" src="../../image/mrkHuman.gif"></td>
                                                                         <td rowspan="2" nowrap>
                                                                               <span class="FontSmall">
                                                                                #out($!domain.order.user.buyUser.buyUser.section.sectionCd) &nbsp;
                                                                                #out($!domain.order.user.buyUser.buyUser.section.sectionName)
                                                                          </span>
                                                                          <br>
                                                                          <span class="FontSmall">#out($!domain.order.user.buyUser.buyUser.userID)</span>&nbsp;
                                                                          <span class="FontUserName"><b class="FontUserName">#out($!domain.order.user.buyUser.buyUser.userName)</b></span>
                                                                         </td>
                                                                         <td><img class="Mark" src="../../image/mrkTel.gif" ></td>
                                                                         <td class="FontMini" nowrap>
                                                                          #customSpringMessage('EXTENSION_NO')：<!--内線番号--><span class="FontSmallAnk">#out($!domain.order.user.buyUser.buyUser.extNo.extensionNo)</span>&nbsp;&nbsp;
                                                                          #customSpringMessage('EXTERNAL_NO')：<!--外線番号--><span class="FontSmallAnk">#out($!domain.order.user.buyUser.buyUser.externalNo.externalNo)</span>
                                                                         </td>
                                                                      </tr>
                                                                      <tr>
                                                                         <td><img class="Mark" src="../../image/mrkMail.gif" ></td>
                                                                         <td class="FontMiniAnkBold" nowrap>
                                                                          <span class="FontMiniAnk">
                                                                            #if("$!domain.order.user.buyUser.buyUser.mailAddr.mail" != "")
                                                                            <A HREF='mailto:#out($!domain.order.user.buyUser.buyUser.userName)<#out($!domain.order.user.buyUser.buyUser.mailAddr.mail)>'>#out($!domain.order.user.buyUser.buyUser.mailAddr.mail)</A>
                                                                            #end
                                                                          </span>
                                                                          </td>
                                                                         <td align="right" valign="bottom"></td>
                                                                   </tr>
                                                             </table>
                                                            </td>
                                                       </tr>
                                                  </tbody>
                                                   </table>
                                                    <br>
                                                              #if($!existsBackAppUser)
                                                                  #customFormHiddenInput("order.appManagement.backApp.backAppFirstUser.userID" "$!domain.order.user.buyUser.buyUser.userID")
                                                              #end
                                                              #set($backUserName = $!domain.order.user.buyUser.buyUser.userName)
                                                              #set($domainPath = "domain.order.appManagement")
                                                              #set($delComment = "USER_DEL_COMMENT")
                                                                <table class="Box1G" width="100%">
                                                              #parse("./common/common_back.vm")
                                                                </table>
                                                           <table class="NoBorder" width="100%">

                                                                  <tr>
                                                                       <br>
                                                                        <td>#customSpringMessage('PSAPR032_FOOTER_COMMENT')</td>
                                                                        <td align="right" valign="middle">
                                                                           <input type="button" class="LargeButton Red" value="#customSpringMessage('RETURN')" onclick="sendBack('#jsEscapeInHTML($!domain.order.orderIdentify.orderSeq)','#jsEscapeInHTML($!domain.order.orderIdentify.lastUpdDate)');">&nbsp;&nbsp;
                                                                           <input id="button" type="button" class="LargeButton" value="#customSpringMessage('APPROVAL')" onclick="approval('#jsEscapeInHTML($!domain.order.orderIdentify.orderSeq)','#jsEscapeInHTML($!domain.order.orderIdentify.lastUpdDate)');">
                                                                          </td>
                                                                    </tr>
                                                            </table>
                                                     </td>
                                                 </tr>
                                            </table>
                                    </td>
                           </tr>
                    </table>
                </div></td>
            </tr>
</table>
</form>
</body>
</html>
<script>
    getObj("Area").style.display = "block";
</script>

